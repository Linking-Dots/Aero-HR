import{V as j,j as i,a as t,F as g}from"./app-DCLWQn_D.js";import{r as I,u as q,t as B}from"./vendor-B2Sl_-DV.js";import{B as H}from"./App-DAnkX68T.js";import{E as U,D as V}from"./Edit-ChakzkM4.js";import{l as z,s as R}from"./chunk-QEQ4EHOG-BcfTp6MH.js";import{t as W,b as Y,a as G,d as J,e as K,c as O}from"./chunk-YRZGWF2W-DhGdAiIJ.js";import{p as Q}from"./chunk-MRXO6UUP-Cy-vrBil.js";import{t as y}from"./chunk-KQ7OR4H5-B5EhgHmu.js";import{u as X}from"./chunk-TLBGAR4N-Bmka2otv.js";var Z={name:"inyrtd",styles:"width:110px"};const pe=({leaves:f,allUsers:_,handleClickOpen:v,setCurrentLeave:b,openModal:x,setLeaves:C,setCurrentPage:w,currentPage:S,totalRows:L,lastPage:D,perPage:$,selectedMonth:ee,employee:te})=>{const{auth:h}=j().props,[re,E]=I.useState(null),l=q(),c=h.roles.includes("Administrator");h.roles.includes("Supervision Engineer");const P=e=>w(e),A=()=>E(null),k=async(e,s)=>{console.error(e),A(),await N(e,"status",s)},N=async(e,s,n)=>{console.log(e);const r=new Promise(async(a,u)=>{try{const o=await axios.post(route("leave-update-status"),{id:e.id,[s]:n});o.status===200&&(C(p=>p.map(m=>m.id===e.id?{...m,[s]:n}:m)),a([o.data.message||"Leave status updated successfully"]))}catch(o){const p=o.response?o.response.status===422?o.response.statusText||"Failed to update leave status":"An unexpected error occurred. Please try again later.":o.request?"No response received from the server. Please check your internet connection.":"An error occurred while setting up the request.";u(p),console.error(o)}});H.promise(r,{pending:{render:()=>i("div",{style:{display:"flex",alignItems:"center"},children:[t(B,{}),t("span",{style:{marginLeft:"8px"},children:"Updating leave status..."})]}),icon:!1,style:d(l)},success:{render:({data:a})=>t(g,{children:a.map((u,o)=>t("div",{children:u},o))}),icon:"ðŸŸ¢",style:d(l)},error:{render:({data:a})=>t(g,{children:a}),icon:"ðŸ”´",style:d(l)}})},d=e=>({backdropFilter:"blur(16px) saturate(200%)",backgroundColor:e.glassCard.backgroundColor,border:e.glassCard.border,color:e.palette.text.primary}),T=e=>({New:"primary",Pending:"secondary",Approved:"success",Declined:"danger"})[e]||"primary",F=(e,s)=>{const n=e[s];switch(s){case"employee":const r=_.find(a=>String(a.id)===String(e.user_id));return t(X,{avatarProps:{radius:"lg",src:r==null?void 0:r.profile_image},description:r==null?void 0:r.phone,name:r==null?void 0:r.name,children:r==null?void 0:r.email});case"from_date":case"to_date":return new Date(n).toLocaleDateString("en-US",{day:"numeric",month:"short",year:"numeric"});case"status":return t(R,{isDisabled:!c&&route().current()!=="leaves","aria-label":"Leave Status",color:T(e.status),placeholder:"Select status",size:"sm",selectedKeys:[e.status],onChange:a=>k(e,a.target.value),css:Z,children:["New","Pending","Approved","Declined"].map(a=>t(z,{value:a,children:a},a))});case"actions":return i("div",{className:"relative flex items-center gap-2",children:[t(y,{content:"Edit Leave",children:t("span",{className:"text-lg text-default-400 cursor-pointer active:opacity-50",onClick:()=>{b(e),x("edit_leave")},children:t(U,{})})}),t(y,{content:"Delete Leave",color:"danger",children:t("span",{className:"text-lg text-danger cursor-pointer active:opacity-50",onClick:()=>v(e.id,"delete_leave"),children:t(V,{})})})]});default:return n}},M=[...c?[{name:"Employee",uid:"employee"}]:[],{name:"Leave Type",uid:"leave_type"},{name:"From Date",uid:"from_date"},{name:"To Date",uid:"to_date"},{name:"Status",uid:"status"},{name:"Reason",uid:"reason"},...c?[{name:"Actions",uid:"actions"}]:[]];return i("div",{style:{maxHeight:"84vh",overflowY:"auto"},children:[i(W,{isStriped:!0,selectionMode:"multiple",selectionBehavior:"toggle",isCompact:!0,isHeaderSticky:!0,removeWrapper:!0,"aria-label":"Leave Employee Table",children:[t(G,{columns:M,children:e=>t(Y,{align:e.uid==="actions"?"center":"start",children:e.name},e.uid)}),t(O,{items:f,children:e=>t(J,{children:s=>t(K,{style:{whiteSpace:"nowrap"},children:F(e,s)})},e.id)})]}),L>30&&t("div",{className:"py-2 px-2 flex justify-center items-end",style:{height:"100%"},children:t(Q,{initialPage:1,isCompact:!0,showControls:!0,showShadow:!0,color:"primary",variant:"bordered",page:S,total:D,onChange:P})})]})};export{pe as L};
