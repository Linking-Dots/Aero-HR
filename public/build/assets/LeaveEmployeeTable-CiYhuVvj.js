import{V as j,j as i,a as t,F as g}from"./app-COej-qut.js";import{r as I,u as q,h as B}from"./vendor-jz9Knmfr.js";import{B as H}from"./App-Bh__gnbe.js";import{E as U,D as V}from"./Edit-BHaH8ya7.js";import{t as z,b as R,a as W,d as Y,e as G,c as J}from"./chunk-F3UDT23P-B9Bbk0MH.js";import{p as K}from"./chunk-YHY32LNM-BVFuFTPV.js";import{t as y}from"./chunk-CSXHODZI-B_ju90Id.js";import{l as O,s as Q}from"./chunk-7JXO3E7I-BmHL33O5.js";import{u as X}from"./chunk-R6AK6OQ4-srYMT2VM.js";var Z={name:"inyrtd",styles:"width:110px"};const pe=({leaves:f,allUsers:_,handleClickOpen:v,setCurrentLeave:b,openModal:x,setLeaves:w,setCurrentPage:C,currentPage:S,totalRows:L,lastPage:D,perPage:$,selectedMonth:ee,employee:te})=>{const{auth:h}=j().props,[ae,E]=I.useState(null),l=q(),c=h.roles.includes("Administrator");h.roles.includes("Supervision Engineer");const P=e=>C(e),A=()=>E(null),k=async(e,s)=>{console.error(e),A(),await N(e,"status",s)},N=async(e,s,o)=>{const a=new Promise(async(r,u)=>{try{const n=await axios.post(route("leave-update-status"),{id:e.id,[s]:o});n.status===200&&(w(p=>p.map(m=>m.id===e.id?{...m,[s]:o}:m)),r([n.data.message||"Leave status updated successfully"]))}catch(n){const p=n.response?n.response.status===422?n.response.statusText||"Failed to update leave status":"An unexpected error occurred. Please try again later.":n.request?"No response received from the server. Please check your internet connection.":"An error occurred while setting up the request.";u(p),console.error(n)}});H.promise(a,{pending:{render:()=>i("div",{style:{display:"flex",alignItems:"center"},children:[t(B,{}),t("span",{style:{marginLeft:"8px"},children:"Updating leave status..."})]}),icon:!1,style:d(l)},success:{render:({data:r})=>t(g,{children:r.map((u,n)=>t("div",{children:u},n))}),icon:"ðŸŸ¢",style:d(l)},error:{render:({data:r})=>t(g,{children:r}),icon:"ðŸ”´",style:d(l)}})},d=e=>({backdropFilter:"blur(16px) saturate(200%)",background:e.glassCard.background,border:e.glassCard.border,color:e.palette.text.primary}),T=e=>({New:"primary",Pending:"secondary",Approved:"success",Declined:"danger"})[e]||"primary",F=(e,s)=>{const o=e[s];switch(s){case"employee":const a=_.find(r=>String(r.id)===String(e.user_id));return t(X,{avatarProps:{radius:"lg",src:a==null?void 0:a.profile_image},description:a==null?void 0:a.phone,name:a==null?void 0:a.name,children:a==null?void 0:a.email});case"from_date":case"to_date":return new Date(o).toLocaleDateString("en-US",{day:"numeric",month:"short",year:"numeric"});case"status":return t(Q,{isDisabled:!c&&route().current()!=="leaves","aria-label":"Leave Status",color:T(e.status),placeholder:"Select status",size:"sm",selectedKeys:[e.status],onChange:r=>k(e,r.target.value),css:Z,children:["New","Pending","Approved","Declined"].map(r=>t(O,{value:r,children:r},r))});case"actions":return i("div",{className:"relative flex items-center gap-2",children:[t(y,{content:"Edit Leave",children:t("span",{className:"text-lg text-default-400 cursor-pointer active:opacity-50",onClick:()=>{b(e),x("edit_leave")},children:t(U,{})})}),t(y,{content:"Delete Leave",color:"danger",children:t("span",{className:"text-lg text-danger cursor-pointer active:opacity-50",onClick:()=>v(e.id,"delete_leave"),children:t(V,{})})})]});default:return o}},M=[...c?[{name:"Employee",uid:"employee"}]:[],{name:"Leave Type",uid:"leave_type"},{name:"From Date",uid:"from_date"},{name:"To Date",uid:"to_date"},{name:"Status",uid:"status"},{name:"Reason",uid:"reason"},...c?[{name:"Actions",uid:"actions"}]:[]];return i("div",{style:{maxHeight:"84vh",overflowY:"auto"},children:[i(z,{isStriped:!0,selectionMode:"multiple",selectionBehavior:"toggle",isCompact:!0,isHeaderSticky:!0,removeWrapper:!0,"aria-label":"Leave Employee Table",children:[t(W,{columns:M,children:e=>t(R,{align:e.uid==="actions"?"center":"start",children:e.name},e.uid)}),t(J,{items:f,children:e=>t(Y,{children:s=>t(G,{style:{whiteSpace:"nowrap"},children:F(e,s)})},e.id)})]}),L>30&&t("div",{className:"py-2 px-2 flex justify-center items-end",style:{height:"100%"},children:t(K,{initialPage:1,isCompact:!0,showControls:!0,showShadow:!0,color:"primary",variant:"bordered",page:S,total:D,onChange:P})})]})};export{pe as L};
