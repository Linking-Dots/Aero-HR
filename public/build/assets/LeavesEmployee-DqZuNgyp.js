import{V as I,j as s,a as e,M as Q,F as J}from"./app-BZCEtsTA.js";import{j,u as V,t as R,r as o,e as W,T as n,h as X,B as Z}from"./vendor-Dz0S-B-S.js";import{p as M,q as T,t as B,G as K,o as ee,a as ae,v as _,j as se,w as D,A as re,d as te}from"./App-DC-ZgINO.js";import{L as le}from"./LeaveEmployeeTable-DBT_1Sio.js";import{F as ne}from"./UserIcon-eOL2cvBT.js";import{s as oe}from"./chunk-F3UDT23P-DeTl2FO5.js";import{u as Y,c as S}from"./chunk-MW56SEHC-C_vttlAv.js";import{s as ie,l as ce}from"./chunk-7JXO3E7I-GGq-axbL.js";import"./XCircleIcon-DOglxla7.js";import"./TrashIcon-ruk4TL6p.js";import"./EllipsisVerticalIcon-Q8NWE5V_.js";import"./chunk-CSXHODZI-D_mzbbQW.js";import"./chunk-R6AK6OQ4-QieAj_Uz.js";import"./chunk-YHY32LNM-CFkxuyBu.js";import"./chunk-MZRCPRP2-aDeFXsnk.js";import"./chunk-SLABUSGS-CcvCt12y.js";import"./chunk-7F3ZLNJ6-BWkLKS2d.js";import"./chunk-2BFF5KFD-Ckbf7p12.js";var E=M((h,b)=>{var c;const{as:p,className:l,children:y,...u}=h,v=p||"div",g=T(b),{slots:d,classNames:i}=Y(),f=B(i==null?void 0:i.body,l);return j.jsx(v,{ref:g,className:(c=d.body)==null?void 0:c.call(d,{class:f}),...u,children:y})});E.displayName="HeroUI.CardBody";var k=E,U=M((h,b)=>{var c;const{as:p,className:l,children:y,...u}=h,v=p||"div",g=T(b),{slots:d,classNames:i}=Y(),f=B(i==null?void 0:i.header,l);return j.jsx(v,{ref:g,className:(c=d.header)==null?void 0:c.call(d,{class:f}),...u,children:y})});U.displayName="HeroUI.CardHeader";var de=U;const me=({title:h,allUsers:b})=>{const{auth:c}=I().props,p=V(),l=R(p.breakpoints.down("sm")),y=R(p.breakpoints.down("md")),[u,v]=o.useState(!1),[g,d]=o.useState([]),[i,f]=o.useState({leaveTypes:[],leaveCountsByUser:{}}),[C,L]=o.useState({page:1,perPage:30,total:0,lastPage:0}),[N,$]=o.useState({employee:"",year:new Date().getFullYear()}),H=o.useMemo(()=>{const a=new Date().getFullYear();return Array.from({length:a-1900+1},(r,t)=>{const m=1900+t;return{key:m.toString(),label:m.toString(),value:m}}).reverse()},[]),z=o.useCallback((a,r)=>{if(a==="year"){const t=Number(r);if(t<1900||t>new Date().getFullYear()){console.warn("Invalid year selected. Must be between 1900 and current year.");return}}$(t=>({...t,[a]:r})),a==="year"&&L(t=>({...t,page:1}))},[]),P=o.useCallback((a,r=null)=>{console.log(`Opening ${a} modal for item:`,r)},[]);o.useCallback(()=>{console.log("Closing modal")},[]);const F=o.useCallback(async()=>{v(!0);try{const{page:a,perPage:r}=C,{employee:t,year:m}=N,w=await axios.get(route("leaves.paginate"),{params:{page:a,perPage:r,employee:t,year:m},timeout:1e4});if(w.status===200){const{leaves:x,leavesData:q}=w.data;d(x.data||[]),f(q||{leaveTypes:[],leaveCountsByUser:{}}),L(G=>({...G,total:x.total||0,lastPage:x.last_page||0}))}}catch(a){console.error("Error fetching leaves:",a)}finally{v(!1)}},[C.page,C.perPage,N]);o.useEffect(()=>{F()},[F]);const A=o.useMemo(()=>i.leaveCountsByUser[c.user.id]||[],[i.leaveCountsByUser,c.user.id]),O=()=>i.leaveTypes.length?e("div",{className:`grid gap-4 ${l?"grid-cols-1":y?"grid-cols-2":"grid-cols-4"}`,children:i.leaveTypes.map(({type:a})=>{const r=A.find(x=>x.leave_type===a)||{},t=r.days_used||0,m=r.remaining_days||0,w=t+m;return s(S,{className:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15 transition-all duration-200",children:[e(de,{className:"pb-2",children:s("div",{className:"flex items-center gap-2",children:[e(_,{className:"w-5 h-5"}),e(n,{variant:l?"subtitle1":"h6",className:"font-semibold truncate",children:a})]})}),e(k,{className:"pt-0",children:s("div",{className:"space-y-3",children:[s("div",{className:"flex justify-between items-center",children:[s("div",{className:"text-center",children:[e(n,{variant:"caption",color:"textSecondary",children:"Used"}),e(n,{variant:l?"h6":"h5",className:"font-bold text-red-400",children:t})]}),e(te,{orientation:"vertical",className:"h-8"}),s("div",{className:"text-center",children:[e(n,{variant:"caption",color:"textSecondary",children:"Remaining"}),e(n,{variant:l?"h6":"h5",className:"font-bold text-green-400",children:m})]})]}),w>0&&e("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e("div",{className:"bg-gradient-to-r from-red-400 to-orange-400 h-2 rounded-full transition-all duration-300",style:{width:`${t/w*100}%`}})})]})})]},a)})}):e(S,{className:"bg-white/10 backdrop-blur-md border-white/20",children:s(k,{className:"text-center py-8",children:[e(D,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),e(n,{variant:"body1",color:"textSecondary",children:"No leave types available"})]})});return s(J,{children:[e(Q,{title:h}),e(Z,{className:"min-h-screen p-2 sm:p-4 md:p-6",sx:{background:"linear-gradient(135deg, rgba(67, 56, 202, 0.1) 0%, rgba(139, 92, 246, 0.1) 100%)"},children:e(W,{in:!0,timeout:800,children:e("div",{className:"mx-auto",children:e(K,{children:s("div",{className:"p-4 sm:p-6",children:[s("div",{className:"flex items-center justify-between mb-6",children:[s("div",{className:"flex items-center gap-3",children:[e(ne,{className:"w-8 h-8 text-blue-400"}),s("div",{children:[e(n,{variant:l?"h5":"h4",className:"font-bold bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent",children:"My Leaves"}),e(n,{variant:"body2",color:"textSecondary",children:"Your leave requests and balances"})]})]}),e(ee,{startContent:e(ae,{className:"w-4 h-4"}),variant:"flat",color:"primary",size:l?"sm":"md",children:N.year})]}),e("div",{className:"mb-6",children:s("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-end",children:[e("div",{className:"w-full sm:w-auto sm:min-w-[200px]",children:e(ie,{label:"Select Year",variant:"bordered",selectedKeys:[String(N.year)],onSelectionChange:a=>{const r=Array.from(a)[0];r&&z("year",Number(r))},startContent:e(_,{className:"w-4 h-4"}),classNames:{trigger:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15",popoverContent:"bg-white/10 backdrop-blur-lg border-white/20"},size:l?"sm":"md",children:H.map(a=>e(ce,{value:a.value,children:a.label},a.key))})}),e(oe,{}),e("div",{className:"flex gap-2",children:e(se,{variant:"flat",color:"primary",size:l?"sm":"md",onPress:F,isLoading:u,startContent:!u&&e(D,{className:"w-4 h-4"}),children:"Refresh"})})]})}),s("div",{className:"mb-6",children:[s(n,{variant:"h6",className:"mb-4 flex items-center gap-2",children:[e(D,{className:"w-5 h-5"}),"Leave Balance Summary"]}),O()]}),s("div",{children:[s(n,{variant:"h6",className:"mb-4 flex items-center gap-2",children:[e(_,{className:"w-5 h-5"}),"Leave History"]}),u?e(S,{className:"bg-white/10 backdrop-blur-md border-white/20",children:s(k,{className:"text-center py-12",children:[e(X,{size:40}),e(n,{className:"mt-4",color:"textSecondary",children:"Loading leave data..."})]})}):g.length>0?e("div",{className:"overflow-hidden rounded-lg",children:e(le,{leaves:g,allUsers:b,onDelete:a=>P("delete",a),onEdit:a=>P("edit",a.id),pagination:C,onPageChange:a=>L(r=>({...r,page:a})),isMobile:l,setLeaves:d})}):e(S,{className:"bg-white/10 backdrop-blur-md border-white/20",children:s(k,{className:"text-center py-12",children:[e(_,{className:"w-16 h-16 mx-auto mb-4 text-gray-400"}),e(n,{variant:"h6",className:"mb-2",children:"No Leave Records Found"}),s(n,{color:"textSecondary",children:["You haven't submitted any leave requests for ",N.year,"."]})]})})]})]})})})})})]})};me.layout=h=>e(re,{children:h});export{me as default};
