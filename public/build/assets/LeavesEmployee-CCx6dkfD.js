import{V as T,j as n,a as e,M as z,F as j}from"./app-DCLWQn_D.js";import{r as a,e as J,h as Q,a as S,G as p,B as i,t as W,T as c,D as X}from"./vendor-B2Sl_-DV.js";import{G as I,A as Z}from"./App-DAnkX68T.js";import{L as $}from"./LeaveEmployeeTable-B7wF7bjf.js";import"./GlassDialog-BH9YN82j.js";import{d as ee}from"./dayjs.min-CXVojvhV.js";import{s as te,l as ae}from"./chunk-QEQ4EHOG-BcfTp6MH.js";import"./Edit-ChakzkM4.js";import"./chunk-YRZGWF2W-DhGdAiIJ.js";import"./DOMLayoutDelegate-BIyuJV5z.js";import"./chunk-KBN3H6OQ-_3SID9MP.js";import"./useFormValidationState-2qANdTs3.js";import"./chunk-MRXO6UUP-Cy-vrBil.js";import"./chunk-KQ7OR4H5-B5EhgHmu.js";import"./chunk-TLBGAR4N-Bmka2otv.js";import"./useLabel-CFh2F0KZ.js";import"./chunk-NCVCYSZZ-qFGDq4Yr.js";const re=({title:u,allUsers:w})=>{var E;const{auth:b}=T().props;T();const[B,m]=a.useState(!1),[g,G]=a.useState([]),[se,h]=a.useState(null),[l,C]=a.useState({leaveTypes:[],leaveCountsByUser:{}}),[M,Y]=a.useState(0),[k,A]=a.useState(0),[ne,L]=a.useState(null),[D,le]=a.useState(""),[v,U]=a.useState(ee().year()),[y,F]=a.useState(30),[f,N]=a.useState(1),[oe,R]=a.useState(),[_,P]=a.useState(""),O=new Date().getFullYear(),H=Array.from({length:O-1900+1},(t,r)=>1900+r).reverse(),K=t=>h(t),V=a.useCallback((t,r)=>{L(t),h(r)},[]);a.useCallback(()=>{h(null),L(null)},[]);const q=async()=>{var t,r;try{const s=await axios.get(route("leaves.paginate"),{params:{page:f,perPage:y,employee:D,year:v}});if(console.log(s),s.status===200){const{leaves:o,leavesData:d}=s.data;G(o.data),C(d),Y(o.total),A(o.last_page),P(!1),m(!1)}}catch(s){console.error("Error fetching leaves data:",s),P(((r=(t=s.response)==null?void 0:t.data)==null?void 0:r.message)||"Error retrieving data."),m(!1)}};return a.useEffect(()=>{m(!0),q()},[v,f,y,D]),console.log(l),n(j,{children:[e(z,{title:u}),e(i,{sx:{display:"flex",justifyContent:"center",p:2},children:e(J,{in:!0,children:n(I,{children:[e(Q,{title:"Leaves",sx:{padding:"24px"}}),e(S,{children:e(p,{container:!0,spacing:2,children:e(p,{item:!0,xs:12,sm:6,md:4,children:e(te,{label:"Select Year",variant:"bordered",selectedKeys:[String(v)],onChange:t=>U(Number(t.target.value)),popoverProps:{classNames:{content:"bg-transparent backdrop-blur-lg border-inherit"}},children:H.map(t=>e(ae,{value:String(t),children:String(t)},String(t)))})})})}),e(S,{children:B?n(i,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%",py:4},children:[e(W,{sx:{mb:2}}),e(c,{variant:"body1",align:"center",children:"Loading leaves data..."})]}):n(j,{children:[((E=l==null?void 0:l.leaveTypes)==null?void 0:E.length)>0&&e(p,{container:!0,spacing:2,sx:{mb:3},children:l.leaveTypes.map(t=>{var r,s,o,d;return e(p,{item:!0,xs:6,sm:6,md:3,children:e(I,{children:e(S,{children:n(i,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%",textAlign:"center",children:[e(c,{variant:"h6",sx:{mb:2},children:t.type}),n(i,{display:"flex",alignItems:"center",children:[n(i,{children:["Used:",e(c,{variant:"h4",children:((s=(r=l.leaveCountsByUser[b.user.id])==null?void 0:r.find(x=>x.leave_type===t.type))==null?void 0:s.days_used)||0})]}),e(X,{orientation:"vertical",flexItem:!0,sx:{mx:2}}),n(i,{children:["Remaining:",e(c,{variant:"h4",children:((d=(o=l.leaveCountsByUser[b.user.id])==null?void 0:o.find(x=>x.leave_type===t.type))==null?void 0:d.remaining_days)||0})]})]})]})})})},t.type)})}),g&&g.length>0?e($,{totalRows:M,lastPage:k,setCurrentPage:N,setPerPage:F,perPage:y,currentPage:f,setLeavesData:C,handleClickOpen:V,setCurrentLeave:R,openModal:K,leaves:g,allUsers:w}):_?e(c,{variant:"body1",align:"center",children:_}):e(c,{variant:"body1",align:"center",children:"No leaves data found."})]})})]})})})]})};re.layout=u=>e(Z,{children:u});export{re as default};
