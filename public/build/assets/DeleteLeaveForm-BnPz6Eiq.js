import{r as l,R as De,J as Ge,a as Xe,j as e,b as s,h as Se,d as ke,F as se}from"./app-BcmgNF0y.js";import{u as xe,a as fe,n as we,I as pe,B as u,ao as Ve,T as b,as as Te,ap as Fe,aq as Ie,ar as ge,F as te,d as ye,al as Re,W as ce,c as be,m as $e,aG as Ke,at as ea,an as aa,e as ta,f as M,Q as Ee}from"./App-n7nN2ISI.js";import{a as Be,F as Pe}from"./PencilIcon-DtevNsBb.js";import{F as Me}from"./TrashIcon-gsQmfKYX.js";import{F as ra,b as sa,a as oa}from"./XCircleIcon-GGzMW-0B.js";import{C as na}from"./CardContent-DW-4atRp.js";import{a as W}from"./colorManipulator-DXbtGljQ.js";import{e as q,t as la,a as ia,b as da,c as ca,d as ma}from"./chunk-F3UDT23P-B95P-WTm.js";import{t as We}from"./chunk-7ZZXWEXF-Dxx-g6qx.js";import{u as je}from"./chunk-R6AK6OQ4-DjVKCF-C.js";import{p as Ae}from"./chunk-O5I3QTYU-D4iSu0fv.js";import{C as pa}from"./Clear-Dt9ziiz3.js";import{G as He}from"./GlassDialog-Cyqucp6s.js";import{D as Le}from"./DialogTitle-O1kA4poy.js";import{I as Ue}from"./InputLabel-CBH9I2AA.js";import{S as ze}from"./Select-Ctbfs3z7.js";import{M as me}from"./MenuItem-Dfzpa8iu.js";import{F as Oe,T as re}from"./TextField-D6XLYh9C.js";import{A as ua}from"./Avatar-DaRPXre4.js";import{b as Ze,c as Qe}from"./DialogContent-DKiN3tZb.js";import{L as ha}from"./LoadingButton-Df1lRplx.js";import{C as Ye}from"./CircularProgress-CbI9q9-Q.js";import{D as fa}from"./DialogContentText-CCpfaH9U.js";import{B as qe}from"./Button-CSU9JmaR.js";function ga({title:v,titleId:f,...h},C){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:C,"aria-labelledby":f},h),v?l.createElement("title",{id:f},v):null,l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12Z"}))}const ya=l.forwardRef(ga);function ba({title:v,titleId:f,...h},C){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:C,"aria-labelledby":f},h),v?l.createElement("title",{id:f},v):null,l.createElement("path",{fillRule:"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25ZM12.75 6a.75.75 0 0 0-1.5 0v6c0 .414.336.75.75.75h4.5a.75.75 0 0 0 0-1.5h-3.75V6Z",clipRule:"evenodd"}))}const xa=l.forwardRef(ba),wa=De.forwardRef(({leaves:v,allUsers:f,handleClickOpen:h,setCurrentLeave:C,openModal:o,setLeaves:j,setCurrentPage:k,currentPage:D,totalRows:T,lastPage:A,perPage:x,selectedMonth:G,employee:E,isAdminView:B=!1,onBulkApprove:J,onBulkReject:P,canApproveLeaves:p=!1,canEditLeaves:F=!1,canDeleteLeaves:H=!1,fetchLeavesStats:m},L)=>{var i,c;const{auth:I}=Ge().props,y=xe(),N=fe("(min-width: 1025px)"),X=fe("(min-width: 641px) and (max-width: 1024px)"),oe=fe("(max-width: 640px)"),[Z,ve]=l.useState(!1),[U,Ce]=l.useState(null),[S,V]=l.useState(null),[ue,Ne]=l.useState(new Set);(i=I.permissions)!=null&&i.includes("leaves.view"),(c=I.permissions)!=null&&c.includes("leave.own.view");const _={New:{color:"primary",icon:oa,bgColor:W(y.palette.primary.main,.1),textColor:y.palette.primary.main},Pending:{color:"warning",icon:xa,bgColor:W(y.palette.warning.main,.1),textColor:y.palette.warning.main},Approved:{color:"success",icon:sa,bgColor:W(y.palette.success.main,.1),textColor:y.palette.success.main},Declined:{color:"danger",icon:ra,bgColor:W(y.palette.error.main,.1),textColor:y.palette.error.main}},he=a=>{switch(a==null?void 0:a.toLowerCase()){case"casual":return e(ea,{className:"w-3 h-3 text-blue-500"});case"weekend":return e(Ke,{className:"w-3 h-3 text-yellow-500"});case"sick":return e(ya,{className:"w-3 h-3 text-red-500"});case"earned":return e(be,{className:"w-3 h-3 text-green-500"});default:return e(ce,{className:"w-3 h-3 text-primary"})}},g=l.useCallback(a=>{k&&k(a)},[k]),ne=l.useCallback(async(a,r)=>{if(S===a.id)return;V(a.id);const d=new Promise(async(n,R)=>{var $,ee,ae;try{const z=await Xe.post(route("leave-update-status"),{id:a.id,status:r});z.status===200&&(j(Y=>Y.map(w=>w.id===a.id?{...w,status:r}:w)),m(),n(z.data.message||"Leave status updated successfully"))}catch(z){const Y=((ee=($=z.response)==null?void 0:$.data)==null?void 0:ee.message)||((ae=z.response)==null?void 0:ae.statusText)||"Failed to update leave status";R(Y)}finally{V(null)}});we.promise(d,{pending:"Updating leave status...",success:"Leave status updated successfully!",error:"Failed to update leave status"})},[j,Z]),K=a=>{const r=_[a]||_.New,d=r.icon;return e($e,{size:"sm",variant:"flat",color:r.color,startContent:e(d,{className:"w-3 h-3"}),classNames:{base:"h-6",content:"text-xs font-medium"},children:a})},Q=(a,r)=>{const d=new Date(a),n=new Date(r),R=Math.abs(n-d),$=Math.ceil(R/(1e3*60*60*24))+1;return $===1?"1 day":`${$} days`},le=a=>new Date(a).toLocaleDateString("en-US",{day:"numeric",month:"short",year:"numeric"}),ie=a=>(f==null?void 0:f.find(r=>String(r.id)===String(a)))||{name:"Unknown User",phone:""},_e=({leave:a,updatingLeaveId:r,setCurrentLeave:d,openModal:n,handleClickOpen:R,updateLeaveStatus:$,canEditLeaves:ee,canDeleteLeaves:ae,canApproveLeaves:z,isAdminView:Y})=>{const w=ie(a.user_id),Je=Q(a.from_date,a.to_date);return _[a.status]||_.New,e(ta,{className:"mb-2",shadow:"sm",children:s(na,{className:"p-3",children:[s(u,{className:"flex items-start justify-between mb-3",children:[e(u,{className:"flex items-center gap-3 flex-1",children:Y&&e(je,{avatarProps:{radius:"lg",size:"sm",src:w==null?void 0:w.profile_image,fallback:e(ye,{className:"w-4 h-4"})},name:e(b,{variant:"body2",fontWeight:"medium",children:w==null?void 0:w.name}),description:e(b,{variant:"caption",color:"textSecondary",children:w==null?void 0:w.phone})})}),s(u,{className:"flex items-center gap-2",children:[K(a.status),(ee||ae)&&s(Te,{children:[e(Fe,{children:e(pe,{size:"small",children:e(Pe,{className:"w-4 h-4"})})}),s(Ie,{"aria-label":"Leave actions",children:[ee&&e(ge,{startContent:e(Be,{className:"w-4 h-4"}),onPress:()=>{d(a),n("edit_leave")},children:"Edit Leave"},"edit"),ae&&e(ge,{className:"text-danger",color:"danger",startContent:e(Me,{className:"w-4 h-4"}),onPress:()=>R(a.id,"delete_leave"),children:"Delete Leave"},"delete")]})]})]})]}),e(ke,{className:"my-3"}),s(aa,{spacing:2,children:[s(u,{className:"flex items-center gap-2",children:[e(ce,{className:"w-4 h-4 text-primary"}),e(b,{variant:"body2",fontWeight:"medium",children:a.leave_type})]}),s(u,{className:"flex items-center gap-2",children:[e(te,{className:"w-4 h-4 text-default-500"}),s(b,{variant:"body2",color:"textSecondary",children:[le(a.from_date)," - ",le(a.to_date)]}),e($e,{size:"sm",variant:"bordered",color:"default",children:Je})]}),a.reason&&s(u,{className:"flex items-start gap-2",children:[e(be,{className:"w-4 h-4 text-default-500 mt-0.5"}),e(b,{variant:"body2",color:"textSecondary",className:"flex-1",children:a.reason})]})]}),Y&&z&&s(se,{children:[e(ke,{className:"my-3"}),e(u,{className:"flex gap-2",children:["Approved","Declined"].map(O=>e(Se,{size:"sm",variant:a.status===O?"solid":"bordered",color:_[O].color,isLoading:r===a.id,onPress:()=>$(a,O),startContent:!U||U!==`${a.id}-${O}`?De.createElement(_[O].icon,{className:"w-3 h-3"}):null,classNames:{base:"flex-1"},children:O},O))})]})]})})},de=l.useCallback((a,r)=>{const d=ie(a.user_id);switch(r){case"employee":return e(q,{className:"whitespace-nowrap",children:e(je,{avatarProps:{radius:"lg",size:"sm",src:d==null?void 0:d.profile_image,fallback:e(ye,{className:"w-4 h-4"})},description:e(b,{variant:"caption",className:"text-xs",children:d==null?void 0:d.phone}),name:e(b,{variant:"body2",className:"text-sm font-medium",children:d==null?void 0:d.name})})});case"leave_type":return e(q,{children:s(u,{className:"flex items-center gap-1",children:[he(a.leave_type),e(b,{variant:"body2",className:"text-sm font-medium capitalize",children:a.leave_type})]})});case"from_date":case"to_date":return e(q,{children:s(u,{className:"flex items-center gap-1",children:[e(te,{className:"w-3 h-3 text-default-500"}),s(u,{children:[e(b,{variant:"body2",className:"text-sm",children:le(a[r])}),r==="from_date"&&e(b,{variant:"caption",className:"text-xs",color:"textSecondary",children:Q(a.from_date,a.to_date)})]})]})});case"status":return e(q,{children:s(u,{className:"flex items-center gap-2",children:[K(a.status),B&&p&&s(Te,{children:[e(Fe,{children:e(Se,{isIconOnly:!0,size:"sm",variant:"light",isDisabled:S===a.id,children:e(Pe,{className:"w-4 h-4"})})}),e(Ie,{"aria-label":"Status actions",onAction:n=>ne(a,n),children:Object.keys(_).map(n=>{const R=_[n],$=R.icon;return e(ge,{startContent:e($,{className:"w-4 h-4"}),color:R.color,children:n},n)})})]})]})});case"reason":return e(q,{children:e(Ve,{title:a.reason||"No reason provided",children:e(b,{variant:"caption",className:"max-w-xs truncate cursor-help text-xs",color:"textSecondary",children:a.reason||"No reason provided"})})});case"actions":return e(q,{children:s(u,{className:"flex items-center gap-1",children:[F&&e(We,{content:"Edit Leave",children:e(pe,{size:"small",onClick:()=>{S!==a.id&&(C(a),o("edit_leave"))},sx:{background:W(y.palette.primary.main,.1),"&:hover":{background:W(y.palette.primary.main,.2)}},children:e(Be,{className:"w-4 h-4"})})}),H&&e(We,{content:"Delete Leave",color:"danger",children:e(pe,{size:"small",onClick:()=>{S!==a.id&&(C(a),h(a.id,"delete_leave"))},sx:{background:W(y.palette.error.main,.1),"&:hover":{background:W(y.palette.error.main,.2)}},children:e(Me,{className:"w-4 h-4"})})})]})});default:return e(q,{children:a[r]})}},[B,p,N,S,y,C,o,h,ne]),t=[...B?[{name:"Employee",uid:"employee",icon:ye}]:[],{name:"Leave Type",uid:"leave_type",icon:ce},{name:"From Date",uid:"from_date",icon:te},{name:"To Date",uid:"to_date",icon:te},{name:"Status",uid:"status",icon:be},{name:"Reason",uid:"reason",icon:ce},...B?[{name:"Actions",uid:"actions"}]:[]];return oe?s(u,{className:"space-y-4",children:[e(Re,{className:"max-h-[70vh]",children:v.map(a=>e(_e,{leave:a},a.id))}),T>x&&e(u,{className:"flex justify-center pt-4",children:e(Ae,{showControls:!0,showShadow:!0,color:"primary",variant:"bordered",page:D,total:A,onChange:g,size:"sm"})})]}):s(u,{sx:{maxHeight:"84vh",overflowY:"auto"},children:[e(Re,{className:"max-h-[70vh]",children:s(la,{isStriped:!0,selectionMode:"none",isCompact:!0,isHeaderSticky:!0,removeWrapper:!0,"aria-label":"Leave Management Table",classNames:{wrapper:"min-h-[200px]",table:"min-h-[300px]",thead:"[&>tr]:first:shadow-small bg-default-100/80",tbody:"divide-y divide-default-200/50",tr:"group hover:bg-default-50/50 transition-colors h-12",td:"py-2 px-3 text-sm",th:"py-2 px-3 text-xs font-semibold"},children:[e(ia,{columns:t,children:a=>e(da,{align:a.uid==="actions"?"center":"start",className:"bg-default-100/80 backdrop-blur-md",children:s(u,{className:"flex items-center gap-1",children:[a.icon&&e(a.icon,{className:"w-3 h-3"}),e("span",{className:"text-xs font-semibold",children:a.name})]})},a.uid)}),e(ca,{items:v,emptyContent:s(u,{className:"flex flex-col items-center justify-center py-8 text-center",children:[e(te,{className:"w-12 h-12 text-default-300 mb-4"}),e(b,{variant:"h6",color:"textSecondary",children:"No leaves found"}),e(b,{variant:"body2",color:"textSecondary",children:E?`No leaves found for "${E}"`:"No leave requests for the selected period"})]}),children:a=>e(ma,{children:r=>de(a,r)},a.id)})]})}),T>x&&s(u,{className:"py-4 flex justify-center",children:[e(Ae,{showControls:!0,showShadow:!0,color:"primary",variant:"bordered",page:D,total:A,onChange:g,size:X?"sm":"md"}),s("div",{className:"ml-4 text-xs text-gray-500",children:["Page ",D," of ",A," (Total: ",T," records)"]})]})]})});wa.displayName="LeaveEmployeeTable";const Ha=({open:v,closeModal:f,leavesData:h,setLeavesData:C,currentLeave:o,allUsers:j,setTotalRows:k,setLastPage:D,setLeaves:T,handleMonthChange:A,employee:x,selectedMonth:G,addLeaveOptimized:E,updateLeaveOptimized:B,fetchLeavesStats:J})=>{var de;const{auth:P}=Ge().props,p=xe(),[F,H]=l.useState((o==null?void 0:o.user_id)||P.user.id),[m,L]=l.useState((h==null?void 0:h.leaveTypes)||[]),[I,y]=l.useState([]),[N,X]=l.useState((o==null?void 0:o.leave_type)||""),oe=t=>{if(!t)return new Date().toISOString().split("T")[0];if(typeof t=="string"&&t.match(/^\d{4}-\d{2}-\d{2}$/))return t;if(typeof t=="string"&&t.includes("T")){if(t.includes("T18:00:00")){const c=t.split("T")[0].split("-"),a=parseInt(c[0]),r=parseInt(c[1]),d=parseInt(c[2])+1;return new Date(a,r-1,d).toISOString().split("T")[0]}return t.split("T")[0]}try{const i=new Date(t);if(isNaN(i.getTime()))return new Date().toISOString().split("T")[0];const c=i.getFullYear(),a=String(i.getMonth()+1).padStart(2,"0"),r=String(i.getDate()).padStart(2,"0");return`${c}-${a}-${r}`}catch(i){return console.error("Error formatting date:",i),new Date().toISOString().split("T")[0]}},[Z,ve]=l.useState(o!=null&&o.from_date?oe(o.from_date):""),[U,Ce]=l.useState(o!=null&&o.to_date?oe(o.to_date):""),[S,V]=l.useState((o==null?void 0:o.no_of_days)||""),[ue,Ne]=l.useState(""),[_,he]=l.useState((o==null?void 0:o.reason)||""),[g,ne]=l.useState({}),[K,Q]=l.useState(!1),[le,ie]=l.useState("");return l.useEffect(()=>{var t,i;if(h){L(h.leaveTypes||[]);const c=((t=h.leaveCountsByUser)==null?void 0:t[F])||[];if(y(c),m.length>0&&!N&&!o&&X(m[0].type),o&&!N){const a=(i=h.leaveTypes)==null?void 0:i.find(r=>r.id===o.leave_type);a&&X(a.type)}}},[h,F,o]),l.useEffect(()=>{if(!N||!I||!m)return;const t=I.find(a=>a.leave_type===N),i=(t==null?void 0:t.days_used)||0;ie(i);const c=m.find(a=>a.type===N);if(c){const a=c.days-i;Ne(a),o&&S>a&&V(a)}},[N,I,m,o,S]),l.useEffect(()=>{V(((i,c)=>{if(!i||!c)return"";const a=new Date(i),r=new Date(c);if(a>r)return"";const d=r.getTime()-a.getTime();return Math.ceil(d/(1e3*3600*24))+1})(Z,U))},[Z,U]),s(He,{open:v,onClose:f,fullWidth:!0,maxWidth:"sm",children:[s(Le,{sx:{display:"flex",alignItems:"center"},children:[e(b,{variant:"h6",children:o?"Edit Leave":"Add Leave"}),e(pe,{onClick:f,sx:{position:"absolute",top:8,right:16},children:e(pa,{})})]}),s("form",{onSubmit:async t=>{t.preventDefault(),Q(!0);const i=new Promise(async(c,a)=>{try{const r={route:route().current(),user_id:F,leaveType:N,fromDate:Z,toDate:U,daysCount:S,leaveReason:_,employee:x,month:G},d=o?route("leave-update"):route("leave-add");o&&(r.id=o.id);const n=await axios.post(d,r);n.status===200&&(C(n.data.leavesData),o&&B&&n.data.leave?(B(n.data.leave),J()):E&&n.data.leave?(E(n.data.leave),J(),n.data.leaves&&n.data.leaves.total&&(k(n.data.leaves.total),D(n.data.leaves.last_page||1))):(console.log("Using fallback data update mode"),n.data.leaves&&(n.data.leaves.data?(T(n.data.leaves.data),k(n.data.leaves.total||n.data.leaves.data.length),D(n.data.leaves.last_page||1)):Array.isArray(n.data.leaves)&&(T(n.data.leaves),k(n.data.leaves.length),D(1)))),f(),c([n.data.message||"Leave application submitted successfully"]))}catch(r){console.error(r),Q(!1),r.response?(r.response.status===422?(ne(r.response.data.errors||{}),a(r.response.data.message||"Failed to submit leave application")):a("An unexpected error occurred. Please try again later."),console.error(r.response.data.error)):r.request?(a("No response received from the server. Please check your internet connection."),console.error(r.request)):(a("An error occurred while setting up the request."),console.error("Error",r.message))}finally{Q(!1)}});we.promise(i,{pending:{render(){return s("div",{style:{display:"flex",alignItems:"center"},children:[e(Ye,{}),e("span",{style:{marginLeft:"8px"},children:"Submitting leave application..."})]})},icon:!1,style:{backdropFilter:"blur(16px) saturate(200%)",background:p.glassCard.background,border:p.glassCard.border,color:p.palette.text.primary}},success:{render({data:c}){return e(se,{children:c.map((a,r)=>e("div",{children:a},r))})},icon:"ðŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",background:p.glassCard.background,border:p.glassCard.border,color:p.palette.text.primary}},error:{render({data:c}){return e(se,{children:c})},icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:p.glassCard.background,border:p.glassCard.border,color:p.palette.text.primary}}})},children:[e(Ze,{children:s(M,{container:!0,spacing:2,children:[e(M,{item:!0,xs:12,md:6,children:s(Ee,{fullWidth:!0,children:[e(Ue,{id:"leave-type-label",children:"Leave Type"}),s(ze,{labelId:"leave-type-label",value:N||"",onChange:t=>X(t.target.value),label:"Leave Type",error:!!g.leaveType,disabled:!1,MenuProps:{PaperProps:{sx:{backdropFilter:"blur(16px) saturate(200%)",background:p.glassCard.background,border:p.glassCard.border,borderRadius:2,boxShadow:p.glassCard.boxShadow,maxHeight:300}}},children:[e(me,{value:"",disabled:!0,children:"Select Leave Type"}),m.map(t=>{const i=I==null?void 0:I.find(r=>r.leave_type===t.type),a=(i?t.days-i.days_used:t.days)<=0;return e(me,{value:t.type,disabled:a,title:a?"No remaining leaves available":"",children:s(u,{display:"flex",justifyContent:"space-between",width:"100%",children:[e("span",{children:t.type}),e("span",{children:i?`${i.days_used} / ${t.days} days`:`${t.days} days`})]})},t.id)})]}),e(Oe,{children:g.leaveType})]})}),e(M,{item:!0,xs:12,md:6,children:e(re,{label:"From",type:"date",fullWidth:!0,value:Z,onChange:t=>ve(t.target.value),InputLabelProps:{shrink:!0},error:!!g.fromDate,helperText:g.fromDate})}),e(M,{item:!0,xs:12,md:6,children:e(re,{label:"To",type:"date",fullWidth:!0,value:U,onChange:t=>Ce(t.target.value),InputLabelProps:{shrink:!0},error:!!g.toDate,helperText:g.toDate})}),e(M,{item:!0,xs:12,md:6,children:e(re,{label:"Number of days",type:"text",fullWidth:!0,value:S,InputProps:{readOnly:!0},error:!!g.daysCount,helperText:g.daysCount})}),e(M,{item:!0,xs:12,md:6,children:e(re,{label:"Remaining Leaves",type:"text",fullWidth:!0,value:`${ue} day${ue!==1?"s":""}`,InputProps:{readOnly:!0,endAdornment:s(b,{variant:"caption",color:"textSecondary",sx:{ml:1},children:["of ",((de=m.find(t=>t.type===N))==null?void 0:de.days)||0," total"]})},error:!!g.remainingLeaves,helperText:g.remainingLeaves})}),route().current()==="leaves"&&e(M,{item:!0,xs:12,md:6,children:s(Ee,{fullWidth:!0,children:[e(Ue,{id:"leave-employee-label",children:"Employee"}),s(ze,{variant:"outlined",fullWidth:!0,labelId:"leave-employee-label",value:F||"na",error:!!g.user_id,onChange:t=>H(t.target.value),label:"Employee",MenuProps:{PaperProps:{sx:{backdropFilter:"blur(16px) saturate(200%)",background:p.glassCard.background,border:p.glassCard.border,borderRadius:2,boxShadow:p.glassCard.boxShadow}}},children:[e(me,{value:"na",disabled:!0,children:"Please select"}),j.map(t=>e(me,{value:t.id,children:s(u,{sx:{display:"flex"},children:[e(ua,{src:t.profile_image,alt:t.name||"Not assigned",sx:{borderRadius:"50%",width:23,height:23,display:"flex",mr:1}}),t.name]})},t.id))]}),e(Oe,{children:g.user_id})]})}),e(M,{item:!0,xs:12,children:e(re,{label:"Leave Reason",multiline:!0,rows:4,fullWidth:!0,value:_,onChange:t=>he(t.target.value),error:!!g.leaveReason,helperText:g.leaveReason})})]})}),e(Qe,{sx:{padding:"16px",justifyContent:"center"},children:e(ha,{type:"submit",variant:"outlined",color:"primary",loading:K,disabled:K,sx:{borderRadius:"50px"},children:"Submit"})})]})]})},La=({open:v,closeModal:f,leaveId:h,setLeavesData:C,setLeaves:o,setTotalRows:j,setLastPage:k,setError:D,deleteLeaveOptimized:T,fetchLeavesStats:A})=>{const x=xe(),[G,E]=l.useState(!1);return s(He,{open:v,onClose:f,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e(Le,{id:"alert-dialog-title",children:"Confirm Deletion"}),e(Ze,{children:e(fa,{id:"alert-dialog-description",children:"Are you sure you want to delete this leave? This action cannot be undone."})}),s(Qe,{children:[e(qe,{onClick:f,color:"primary",disabled:G,children:"Cancel"}),e(qe,{loading:G,disabled:G,onClick:()=>{E(!0);const J=new Promise(async(P,p)=>{var F,H;try{const m=await axios.delete(route("leave-delete",{id:h,route:route().current()}));m.status===200&&(T?(T(h),j(L=>L-1),A()):(C(m.data.leavesData),j(m.data.leaves.total),k(m.data.leaves.last_page),o(m.data.leaves.data),D(!1),A()),P("Leave application deleted successfully"))}catch(m){if(console.error("Error deleting task:",m),m.response.status===404){const{leavesData:L}=m.response.data;C(L),D(((H=(F=m.response)==null?void 0:F.data)==null?void 0:H.message)||"Error retrieving data.")}p(m.response.data.error||"Failed to delete leave application")}finally{E(!1),f()}});we.promise(J,{pending:{render(){return s("div",{style:{display:"flex",alignItems:"center"},children:[e(Ye,{}),e("span",{style:{marginLeft:"8px"},children:"Deleting leave application..."})]})},icon:!1,style:{backdropFilter:"blur(16px) saturate(200%)",background:x.glassCard.background,border:x.glassCard.border,color:x.palette.text.primary}},success:{render({data:P}){return e(se,{children:P})},icon:"ðŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",background:x.glassCard.background,border:x.glassCard.border,color:x.palette.text.primary}},error:{render({data:P}){return e(se,{children:P})},icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:x.glassCard.background,border:x.glassCard.border,color:x.palette.text.primary}}})},color:"error",autoFocus:!0,children:"Delete"})]})]})};export{La as D,Ha as L,wa as a};
