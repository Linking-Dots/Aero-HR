import{r as ee,a as e,j as l,B as $,F as T,q as ae,Y as te,G as O}from"./app-CEZ29YgL.js";import{s as re,q as le,u as q,k as oe,l as H,m as d,n as se,f as A,T as _,V as ne,W as ie,c as j,j as de,i as ce,r as s,N as z,G as f,F as pe,h as ue,S as he,M as N,X as me,b as S,O as V,P as X,o as J,Y as ye,e as ge,g as xe,B as R,a as W}from"./vendor-D_oqeI5X.js";import{A as fe}from"./App-CbnBZlZY.js";import{d as be}from"./Edit-D6LLiBt6.js";import{d as ve}from"./Delete-CKCD0Ymv.js";import{d as Ce,G as K}from"./GlassDialog-D0ahOeI9.js";import{L as we}from"./LoadingButton-CnBA2oze.js";import{A as De}from"./Add-rxg4HwTr.js";var G={},Se=re;Object.defineProperty(G,"__esModule",{value:!0});var Q=G.default=void 0,Te=Se(ee()),_e=le;Q=G.default=(0,Te.default)((0,_e.jsx)("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5m0-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"}),"RadioButtonChecked");const ke=({allLeaves:y,allUsers:p,handleClickOpen:c,setCurrentLeave:m,openModal:r})=>{const t=q();return e(ce,{style:{maxHeight:"84vh",overflowY:"auto"},children:l(de,{children:[e(oe,{children:l(H,{children:[e(d,{sx:{whiteSpace:"nowrap"},children:"Leave Type"}),e(d,{sx:{whiteSpace:"nowrap"},children:"From"}),e(d,{sx:{whiteSpace:"nowrap"},children:"To"}),e(d,{sx:{whiteSpace:"nowrap"},children:"No of Days"}),e(d,{sx:{whiteSpace:"nowrap"},children:"Reason"}),e(d,{sx:{whiteSpace:"nowrap"},children:"Status"}),e(d,{sx:{whiteSpace:"nowrap"},children:"Approved by"}),e(d,{sx:{whiteSpace:"nowrap"},align:"center",children:"Actions"})]})}),e(se,{children:y.map(a=>l(H,{children:[e(d,{sx:{whiteSpace:"nowrap"},children:a.leave_type}),e(d,{sx:{whiteSpace:"nowrap"},children:new Date(a.from_date).toLocaleDateString("en-US",{day:"numeric",month:"short",year:"numeric"})}),e(d,{sx:{whiteSpace:"nowrap"},children:new Date(a.to_date).toLocaleDateString("en-US",{day:"numeric",month:"short",year:"numeric"})}),e(d,{sx:{whiteSpace:"nowrap"},children:a.no_of_days}),e(d,{sx:{whiteSpace:"nowrap"},children:a.reason}),e(d,{sx:{whiteSpace:"nowrap"},children:l(A,{variant:"outlined",color:"primary",sx:{borderRadius:"50px"},children:[e(Q,{})," ",a.status]})}),e(d,{sx:{whiteSpace:"nowrap"},children:a.approved_by?l(_,{sx:{display:"flex",alignItems:"center",whiteSpace:"nowrap"},children:[e(ne,{src:p.find(o=>o.id===a.approved_by).avatar,alt:p.find(o=>o.id===a.approved_by).name}),e(_,{sx:{marginLeft:"10px"},children:e(ie,{href:"#",sx:{textDecoration:"none",color:t.palette.text.primary,fontWeight:"bold"},children:p.find(o=>o.id===a.approved_by).name})})]}):null}),l(d,{sx:{whiteSpace:"nowrap"},align:"center",children:[e(j,{sx:{m:1},variant:"outlined",color:"success",size:"small",onClick:()=>{m(a),r("edit_leave")},children:e(be,{})}),e(j,{sx:{m:1},variant:"outlined",color:"error",size:"small",onClick:()=>c(a.id,"delete_leave"),children:e(ve,{})})]})]},a.id))})]})})},Y=({open:y,closeModal:p,leaveTypes:c,leaveCounts:m,setLeavesData:r,currentLeave:t})=>{const a=q(),[o,w]=s.useState((t==null?void 0:t.leave_type)||(c.length>0?c[0].type:"")),[u,L]=s.useState((t==null?void 0:t.from_date)||""),[v,k]=s.useState((t==null?void 0:t.to_date)||""),[F,P]=s.useState((t==null?void 0:t.no_of_days)||""),[I,g]=s.useState(""),[B,U]=s.useState((t==null?void 0:t.reason)||""),[h,Z]=s.useState({}),[M,E]=s.useState(!1);return s.useEffect(()=>{const n=m.find(C=>C.leave_type===o);g(n.remaining_days)},[o]),s.useEffect(()=>{P(((C,b)=>{if(!C||!b)return"";const x=new Date(C),i=new Date(b);if(x>i)return"";const D=i.getTime()-x.getTime();return Math.ceil(D/(1e3*3600*24))+1})(u,v))},[u,v]),l(K,{open:y,onClose:p,fullWidth:!0,maxWidth:"sm",children:[l(z,{sx:{display:"flex",alignItems:"center"},children:[e(_,{variant:"h6",children:"Add Leave"}),e(j,{onClick:p,sx:{position:"absolute",top:8,right:16},children:e(Ce,{})})]}),l("form",{onSubmit:async n=>{n.preventDefault(),E(!0);const C=new Promise(async(b,x)=>{try{const i={leaveType:o,fromDate:u,toDate:v,daysCount:F,leaveReason:B};t&&(i.id=t.id);const D=await axios.post(route("leave-add"),i);D.status===200&&(r(D.data.leavesData),b([D.data.messages||"Leave application submitted successfully"]),p())}catch(i){E(!1),i.response?(i.response.status===422?(Z(i.response.data.errors||{}),x(i.response.statusText||"Failed to submit leave application")):x("An unexpected error occurred. Please try again later."),console.error(i.response)):i.request?(x("No response received from the server. Please check your internet connection."),console.error(i.request)):(x("An error occurred while setting up the request."),console.error("Error",i.message))}finally{E(!1)}});$.promise(C,{pending:{render(){return l("div",{style:{display:"flex",alignItems:"center"},children:[e(J,{}),e("span",{style:{marginLeft:"8px"},children:"Submitting leave application..."})]})},icon:!1,style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}},success:{render({data:b}){return e(T,{children:b.map((x,i)=>e("div",{children:x},i))})},icon:"ðŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}},error:{render({data:b}){return e(T,{children:b})},icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}}})},children:[e(V,{children:l(f,{container:!0,spacing:2,children:[e(f,{item:!0,xs:12,md:6,children:l(pe,{fullWidth:!0,children:[e(ue,{id:"leave-type-label",children:"Leave Type"}),l(he,{labelId:"leave-type-label",value:o,onChange:n=>w(n.target.value),label:"Leave Type",error:!!h.leaveType,children:[e(N,{value:"",disabled:!0,children:"Select Leave Type"}),c.map(n=>l(N,{value:n.type,children:[n.type," ",n.days," Days"]},n.id))]}),e(me,{children:h.leaveType})]})}),e(f,{item:!0,xs:12,md:6,children:e(S,{label:"From",type:"date",fullWidth:!0,value:u,onChange:n=>L(n.target.value),InputLabelProps:{shrink:!0},error:!!h.fromDate,helperText:h.fromDate})}),e(f,{item:!0,xs:12,md:6,children:e(S,{label:"To",type:"date",fullWidth:!0,value:v,onChange:n=>k(n.target.value),InputLabelProps:{shrink:!0},error:!!h.toDate,helperText:h.toDate})}),e(f,{item:!0,xs:12,md:6,children:e(S,{label:"Number of days",type:"text",fullWidth:!0,value:F,InputProps:{readOnly:!0},error:!!h.daysCount,helperText:h.daysCount})}),e(f,{item:!0,xs:12,md:6,children:e(S,{label:"Remaining Leaves",type:"text",fullWidth:!0,value:I,InputProps:{readOnly:!0},error:!!h.remainingLeaves,helperText:h.remainingLeaves})}),e(f,{item:!0,xs:12,children:e(S,{label:"Leave Reason",multiline:!0,rows:4,fullWidth:!0,value:B,onChange:n=>U(n.target.value),error:!!h.leaveReason,helperText:h.leaveReason})})]})}),e(X,{sx:{padding:"16px",justifyContent:"center"},children:e(we,{type:"submit",variant:"outlined",color:"primary",loading:M,disabled:M,sx:{borderRadius:"50px"},children:"Submit"})})]})]})},Fe=({open:y,handleClose:p,leaveIdToDelete:c,setLeavesData:m})=>{const r=q();return l(K,{open:y,onClose:p,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e(z,{id:"alert-dialog-title",children:"Confirm Deletion"}),e(V,{children:e(ye,{id:"alert-dialog-description",children:"Are you sure you want to delete this leave? This action cannot be undone."})}),l(X,{children:[e(A,{onClick:p,color:"primary",children:"Cancel"}),e(A,{onClick:()=>{const a=new Promise(async(o,w)=>{try{const u=await axios.delete(route("leave-delete",{id:c}));u.status===200&&(m(u.data.leavesData),o("Leave application deleted successfully"))}catch(u){console.error("Error deleting task:",u),w(u.response.data.error||"Failed to delete leave application")}finally{p()}});$.promise(a,{pending:{render(){return l("div",{style:{display:"flex",alignItems:"center"},children:[e(J,{}),e("span",{style:{marginLeft:"8px"},children:"Deleting leave application..."})]})},icon:!1,style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:r.glassCard.backgroundColor,border:r.glassCard.border,color:r.palette.text.primary}},success:{render({data:o}){return e(T,{children:o})},icon:"ðŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:r.glassCard.backgroundColor,border:r.glassCard.border,color:r.palette.text.primary}},error:{render({data:o}){return e(T,{children:o})},icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:r.glassCard.backgroundColor,border:r.glassCard.border,color:r.palette.text.primary}}})},color:"error",autoFocus:!0,children:"Delete"})]})]})},Ie=({title:y,allUsers:p})=>{const[c,m]=s.useState(null),[r,t]=s.useState(ae().props.leavesData),[a,o]=s.useState(r.allLeaves),[w,u]=s.useState(null),[L,v]=s.useState();s.useEffect(()=>{o(r.allLeaves)},[r]);const k=g=>{m(g)},F=s.useCallback((g,B)=>{u(g),m(B)},[]),P=s.useCallback(()=>{m(null),u(null)},[]),I=()=>{m(null)};return l(T,{children:[e(te,{title:y}),c==="add_leave"&&e(Y,{open:c==="add_leave",setLeavesData:t,closeModal:I,leaveTypes:r.leaveTypes,leaveCounts:r.leaveCounts}),c==="edit_leave"&&e(Y,{open:c==="edit_leave",setLeavesData:t,closeModal:I,leaveTypes:r.leaveTypes,leaveCounts:r.leaveCounts,currentLeave:L}),c==="delete_leave"&&e(Fe,{open:c==="delete_leave",handleClose:P,leaveIdToDelete:w,setLeavesData:t}),e(R,{sx:{display:"flex",justifyContent:"center",p:2},children:e(ge,{in:!0,children:l(O,{children:[e(xe,{title:"Leaves",sx:{padding:"24px"},action:e(R,{display:"flex",gap:2,children:e(A,{title:"Add Leave",variant:"outlined",color:"success",startIcon:e(De,{}),onClick:()=>k("add_leave"),children:"Add Leave"})})}),e(W,{children:e(f,{container:!0,spacing:2,children:r.leaveCounts.map(g=>e(f,{item:!0,xs:6,sm:6,md:3,children:e(O,{children:e(W,{children:e(R,{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",textAlign:"center",children:l(R,{children:[e(_,{variant:"h6",children:g.leave_type}),e(_,{variant:"h4",children:g.days_used})]})})})})},g.leave_type))})}),e(W,{children:e(ke,{handleClickOpen:F,setCurrentLeave:v,openModal:k,allLeaves:a,allUsers:p})})]})})})]})};Ie.layout=y=>e(fe,{children:y});export{Ie as default};
