import{a as e,j as l,b as y,A as O,B as S,F as p,Y as R,G as V}from"./app-DA9r234x.js";import{p as I,q as M,r as w,u as W,c as v,h as F,S as A,M as g,F as P,o as j,e as q,g as G,B as N,f as J,a as U}from"./vendor-Bn9RdaZk.js";import{A as X}from"./App-BBivqqJh.js";import{t as k}from"./chunk-KQ7OR4H5-C90_NEDA.js";import{t as Y,a as $,b as K,c as Q,d as Z,e as ee,u as re}from"./chunk-YRZGWF2W-DGoqhEFZ.js";import{A as ae}from"./Add-B3ULKcZx.js";const te=I(M.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete"),ne=I(M.jsx("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"Edit"),oe=({allUsers:c,departments:h,designations:b})=>{const[u,E]=w.useState(c),a=W(),[ie,T]=w.useState({});async function _(r,i,o){const t=new Promise(async(n,s)=>{try{const d=o,x=r==="department"?"user.updateDepartment":"user.updateDesignation",D=await fetch(route(x,{id:i}),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.head.querySelector('meta[name="csrf-token"]').content},body:JSON.stringify({[r]:d})}),f=await D.json();D.ok?(E(H=>H.map(m=>{if(m.id===i){const C={...m};return r==="department"&&m.department!==d&&(C.designation=null),C[r]=d,C}return m})),n(f.messages)):(s(f.messages||"Failed to update profile information."),console.error(f.errors))}catch(d){console.log(d),s(["An unexpected error occurred."])}});S.promise(t,{pending:{render(){return l("div",{style:{display:"flex",alignItems:"center"},children:[e(j,{}),l("span",{style:{marginLeft:"8px"},children:["Updating employee ",r,"..."]})]})},icon:!1,style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}},success:{render({data:n}){return e(p,{children:n.map((s,d)=>e("div",{children:s},d))})},icon:"ðŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}},error:{render({data:n}){return e(p,{children:n.map((s,d)=>e("div",{children:s},d))})},icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}}})}const L=async r=>{const i=new Promise(async(o,t)=>{try{const n=await fetch(route("profile.delete"),{method:"DELETE",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.head.querySelector('meta[name="csrf-token"]').content},body:JSON.stringify({user_id:r})}),s=await n.json();n.ok?(E(d=>d.filter(x=>x.id!==r)),o([s.message])):t([s.message])}catch(n){console.error("Error deleting user:",n),t(["An error occurred while deleting user. Please try again."])}});S.promise(i,{pending:{render(){return l("div",{style:{display:"flex",alignItems:"center"},children:[e(j,{}),e("span",{style:{marginLeft:"8px"},children:"Deleting user..."})]})},icon:!1,style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}},success:{render({data:o}){return e(p,{children:o.map((t,n)=>e("div",{children:t},n))})},icon:"ðŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}},error:{render({data:o}){return e(p,{children:o.map((t,n)=>e("div",{children:t},n))})},icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}}})},z=r=>{T(i=>({...i,[r]:null}))},B=(r,i)=>{const o=r[i];switch(i){case"employee_id":return o;case"name":return e(re,{avatarProps:{radius:"lg",src:r==null?void 0:r.profile_image},name:r==null?void 0:r.name,children:r==null?void 0:r.email});case"phone":return o;case"email":return o;case"date_of_joining":return o;case"department":return l(P,{size:"small",fullWidth:!0,children:[e(F,{id:"department",children:"Department"}),l(A,{labelId:"department",id:`department-select-${r.id}`,value:r.department||"na",onChange:t=>_("department",r.id,t),label:"Department",variant:"outlined",MenuProps:{PaperProps:{sx:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,borderRadius:2,boxShadow:"rgb(255, 255, 255) 0px 0px 0px 0px, rgba(0, 0, 0, 0.05) 0px 0px 0px 1px, rgba(0, 0, 0, 0.1) 0px 10px 15px -3px, rgba(0, 0, 0, 0.05) 0px 4px 6px -2px"}}},children:[e(g,{value:"na",disabled:!0,children:"Select Department"}),h.map(t=>e(g,{value:t.id,children:t.name},t.id))]})]});case"designation":return l(P,{size:"small",fullWidth:!0,sx:{zIndex:0},children:[e(F,{id:"designation",children:"Designation"}),l(A,{variant:"outlined",labelId:"designation",id:`designation-select-${r.id}`,value:r.designation||"na",onChange:t=>_("designation",r.id,t),disabled:!r.department,label:"Designation",MenuProps:{PaperProps:{sx:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,borderRadius:2,boxShadow:"rgb(255, 255, 255) 0px 0px 0px 0px, rgba(0, 0, 0, 0.05) 0px 0px 0px 1px, rgba(0, 0, 0, 0.1) 0px 10px 15px -3px, rgba(0, 0, 0, 0.05) 0px 4px 6px -2px"}}},children:[e(g,{value:"na",disabled:!0,children:"Select Designation"}),b.filter(t=>t.department_id===r.department).map(t=>e(g,{value:t.id,children:t.title},t.id))]})]});case"actions":return l("div",{className:"relative flex items-center gap-2",children:[e(k,{content:"View Profile",children:e(v,{className:"text-lg text-default-400 cursor-pointer active:opacity-50",component:y,href:route("profile",{user:r.id}),children:e(O,{})})}),e(k,{content:"Edit Leave",children:e(v,{className:"text-lg text-default-400 cursor-pointer active:opacity-50",component:y,href:route("profile",{user:r.id}),onClick:()=>{z(r.id)},children:e(ne,{})})}),e(k,{content:"Delete Leave",color:"danger",children:l(v,{className:"text-lg text-danger cursor-pointer active:opacity-50",component:y,href:route("profile",{user:r.id}),onClick:()=>{L(r.id)},children:[e(te,{})," "]})})]});default:return"N/A"}};return e("div",{style:{maxHeight:"84vh",overflowY:"auto"},children:l(ee,{selectionMode:"multiple",selectionBehavior:"toggle",fullWidth:!0,isCompact:!0,isHeaderSticky:!0,removeWrapper:!0,"aria-label":"Employees Table",children:[e(Y,{columns:[{name:"Employee ID",uid:"employee_id"},{name:"Name",uid:"name"},{name:"Mobile",uid:"phone"},{name:"Email",uid:"email"},{name:"Join Date",uid:"date_of_joining"},{name:"Department",uid:"department"},{name:"Designation",uid:"designation"},{name:"Action",uid:"actions"}],children:r=>e($,{align:r.uid==="actions"?"center":"start",children:r.name},r.uid)}),e(K,{items:u,children:r=>e(Q,{children:i=>e(Z,{style:{whiteSpace:"nowrap"},children:B(r,i)})},r.id)})]},u)})},le=({title:c,allUsers:h,departments:b,designations:u})=>l(p,{children:[e(R,{title:c}),e(N,{sx:{display:"flex",justifyContent:"center",p:2},children:e(q,{in:!0,children:l(V,{children:[e(G,{title:"Employees",sx:{padding:"24px"},action:e(N,{display:"flex",gap:2,children:e(J,{title:"Add Employee",variant:"outlined",color:"success",startIcon:e(ae,{}),children:"Add Employee"})})}),e(U,{children:e(oe,{allUsers:h,departments:b,designations:u})})]})})})]});le.layout=c=>e(X,{children:c});export{le as default};
