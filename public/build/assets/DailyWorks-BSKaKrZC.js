import{r as ye,q as at,j as f,a as n,F as M,c as zr,B as ne,Y as ot,G as it}from"./app-BRB7VxQz.js";import{p as ve,q as Z,s as xe,y as lt,u as pe,V as st,B,M as P,S as le,a4 as Cr,a8 as Oe,b as G,c as J,r as d,W as ze,T as he,G as K,F as Te,h as Pe,Q as ct,X as Me,Y as Le,o as He,ag as ut,f as Ie,j as dt,k as pt,l as kr,m as Ae,n as ft,O as mt,ah as _,Z as gt,$ as ht,e as bt,g as yt,a as Dr,I as vt}from"./vendor-DCms5gaY.js";import{d as xt,A as Ct}from"./App-DCfbDYrf.js";import{X as kt,D as Ze,u as Qe,w as Dt,m as wt,a as _t,A as St,L as Ft,b as At}from"./xlsx-CN9B77zd.js";import{d as Et}from"./Delete-BUDfXSNT.js";import{d as oe}from"./dayjs.min-Bv6TEH8N.js";import{d as ir,G as $e}from"./GlassDialog-QJrLjND-.js";import{L as lr}from"./LoadingButton-BRQemRHT.js";import{C as Tt}from"./Clear-Be-2hCqq.js";const Pt=ve(Z.jsx("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96M14 13v4h-4v-4H7l5-5 5 5z"}),"CloudUpload"),Ot=ve(Z.jsx("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8zm2 16H8v-2h8zm0-4H8v-2h8zm-3-5V3.5L18.5 9z"}),"Description"),It=ve(Z.jsx("path",{d:"M6 2c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm7 7V3.5L18.5 9z"}),"InsertDriveFile"),Rt=ve(Z.jsx("path",{d:"M20 2H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2m-8.5 7.5c0 .83-.67 1.5-1.5 1.5H9v2H7.5V7H10c.83 0 1.5.67 1.5 1.5zm5 2c0 .83-.67 1.5-1.5 1.5h-2.5V7H15c.83 0 1.5.67 1.5 1.5zm4-3H19v1h1.5V11H19v2h-1.5V7h3zM9 9.5h1v-1H9zM4 6H2v14c0 1.1.9 2 2 2h14v-2H4zm10 5.5h1v-3h-1z"}),"PictureAsPdf"),er=ve(Z.jsx("path",{d:"M5 20h14v-2H5zm0-10h4v6h6v-6h4l-7-7z"}),"Upload");function fe(e,r,t,i){function a(o){return o instanceof t?o:new t(function(u){u(o)})}return new(t||(t=Promise))(function(o,u){function s(h){try{p(i.next(h))}catch(x){u(x)}}function m(h){try{p(i.throw(h))}catch(x){u(x)}}function p(h){h.done?o(h.value):a(h.value).then(s,m)}p((i=i.apply(e,r||[])).next())})}function me(e,r){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},i,a,o,u;return u={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function s(p){return function(h){return m([p,h])}}function m(p){if(i)throw new TypeError("Generator is already executing.");for(;u&&(u=0,p[0]&&(t=0)),t;)try{if(i=1,a&&(o=p[0]&2?a.return:p[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,p[1])).done)return o;switch(a=0,o&&(p=[p[0]&2,o.value]),p[0]){case 0:case 1:o=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,a=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!o||p[1]>o[0]&&p[1]<o[3])){t.label=p[1];break}if(p[0]===6&&t.label<o[1]){t.label=o[1],o=p;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(p);break}o[2]&&t.ops.pop(),t.trys.pop();continue}p=r.call(e,t)}catch(h){p=[6,h],a=0}finally{i=o=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function wr(e,r){var t=typeof Symbol=="function"&&e[Symbol.iterator];if(!t)return e;var i=t.call(e),a,o=[],u;try{for(;(r===void 0||r-- >0)&&!(a=i.next()).done;)o.push(a.value)}catch(s){u={error:s}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(u)throw u.error}}return o}function _r(e,r,t){if(t||arguments.length===2)for(var i=0,a=r.length,o;i<a;i++)(o||!(i in r))&&(o||(o=Array.prototype.slice.call(r,0,i)),o[i]=r[i]);return e.concat(o||Array.prototype.slice.call(r))}var sr={},jt=xe;Object.defineProperty(sr,"__esModule",{value:!0});var Mr=sr.default=void 0,Wt=jt(ye()),zt=Z;Mr=sr.default=(0,Wt.default)((0,zt.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z"}),"CheckCircle");var cr={},Mt=xe;Object.defineProperty(cr,"__esModule",{value:!0});var Lr=cr.default=void 0,Lt=Mt(ye()),Ht=Z;Lr=cr.default=(0,Lt.default)((0,Ht.jsx)("path",{d:"M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2M8.5 15H7.3l-2.55-3.5V15H3.5V9h1.25l2.5 3.5V9H8.5zm5-4.74H11v1.12h2.5v1.26H11v1.11h2.5V15h-4V9h4zm7 3.74c0 .55-.45 1-1 1h-4c-.55 0-1-.45-1-1V9h1.25v4.51h1.13V9.99h1.25v3.51h1.12V9h1.25z"}),"FiberNew");var ur={},$t=xe;Object.defineProperty(ur,"__esModule",{value:!0});var Hr=ur.default=void 0,Bt=$t(ye()),Kt=Z;Hr=ur.default=(0,Bt.default)((0,Kt.jsx)("path",{d:"M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8"}),"Replay");var dr={},Nt=xe;Object.defineProperty(dr,"__esModule",{value:!0});var $r=dr.default=void 0,Vt=Nt(ye()),qt=Z;$r=dr.default=(0,Vt.default)((0,qt.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-2h2zm0-4h-2V7h2z"}),"Error");var pr={},Ut=xe;Object.defineProperty(pr,"__esModule",{value:!0});var Br=pr.default=void 0,Gt=Ut(ye()),Yt=Z;Br=pr.default=(0,Gt.default)((0,Yt.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"Search");const Xt=lt(kt)(({theme:e})=>({"& .rdt_Table":{backgroundColor:"transparent","& .rdt_TableHead":{"& .rdt_TableHeadRow":{backgroundColor:"transparent",color:e.palette.text.primary},top:0,zIndex:1},"& .rdt_TableBody":{overflowY:"auto",maxHeight:"52vh","& .rdt_TableRow":{minHeight:"auto",backgroundColor:"transparent",color:e.palette.text.primary,"& .rdt_TableCol":{backgroundColor:"transparent",borderBottom:`1px solid ${e.palette.divider}`,width:"auto",whiteSpace:"nowrap"}},"& .rdt_TableRow:hover":{backgroundColor:e.palette.action.hover}}}})),Qt=({data:e,loading:r,handleClickOpen:t,allInCharges:i,setCurrentPage:a,setPerPage:o,totalRows:u,reports:s,juniors:m,reports_with_daily_works:p,openModal:h,setCurrentRow:x,filteredData:O,setFilteredData:A})=>{const{auth:j}=at().props,b=pe(),w=j.roles.includes("Administrator"),S=j.roles.includes("Supervision Engineer"),I=[{name:"Date",selector:l=>l.date,sortable:"true",center:"true",width:"100px"},{name:"RFI NO",selector:l=>l.number,sortable:"true",center:"true",width:"140px",cell:l=>f(M,{children:[l.number,l.reports&&l.reports.map(v=>n("div",{children:f("span",{children:[n("i",{className:"mdi mdi-circle-medium"})," ",v.ref_no]})},v.ref_no))]})},{name:"Status",selector:l=>l.status,sortable:"true",center:"true",width:"220px",cell:l=>f(le,{variant:"outlined",size:"small",fullWidth:!0,value:l.status,onChange:v=>k(l.id,"status",v.target.value),MenuProps:{PaperProps:{sx:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:b.glassCard.backgroundColor,border:b.glassCard.border,borderRadius:2,boxShadow:b.glassCard.boxShadow}}},children:[n(P,{value:"new",children:f(B,{sx:{display:"flex"},children:[n(Lr,{style:{marginRight:8,color:y("new")}})," New"]})}),n(P,{value:"resubmission",children:f(B,{sx:{display:"flex"},children:[n(Hr,{style:{marginRight:8,color:y("resubmission")}})," Resubmission"]})}),n(P,{value:"completed",children:f(B,{sx:{display:"flex"},children:[n(Mr,{style:{marginRight:8,color:y("completed")}})," Completed"]})}),n(P,{value:"emergency",children:f(B,{sx:{display:"flex"},children:[n($r,{style:{marginRight:8,color:y("emergency")}})," Emergency"]})})]})},...S?[{name:"Assigned",selector:l=>l.assigned,sortable:"true",center:"true",cell:l=>f(le,{variant:"outlined",fullWidth:!0,size:"small",value:l.assigned||"na",onChange:v=>k(l.id,"assigned",v.target.value),MenuProps:{PaperProps:{sx:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:b.glassCard.backgroundColor,border:b.glassCard.border,borderRadius:2,boxShadow:b.glassCard.boxShadow}}},children:[n(P,{value:"na",disabled:!0,children:"Please select"}),m.map(v=>n(P,{value:v.id,children:f(B,{sx:{display:"flex"},children:[n(Cr,{src:`/assets/images/users/${v.user_name||"user-dummy-img"}.jpg`,alt:v.name||"Not assigned",sx:{borderRadius:"50%",width:23,height:23,display:"flex",mr:1}}),v.name]})},v.id))]})}]:[],{name:"Type",selector:l=>l.type,sortable:"true",center:"true",width:"140px"},{name:"Description",selector:l=>l.description,sortable:"true",left:"true",width:"260px",cell:l=>n(B,{sx:{whiteSpace:"normal",wordWrap:"break-word",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},children:l.description})},{name:"Location",selector:l=>l.location,sortable:"true",center:"true",width:"200px",cell:l=>n(B,{sx:{whiteSpace:"normal",wordWrap:"break-word",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},children:l.location})},{name:"Results",selector:l=>l.inspection_details,sortable:"true",width:"200px",center:"true",cell:l=>{const[v,N]=Oe.useState(!1),[V,ee]=Oe.useState(l.inspection_details||"");return n(B,{sx:{whiteSpace:"normal",wordWrap:"break-word",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%",cursor:"pointer"},onClick:v?void 0:()=>{N(!0)},children:v?n(G,{fullWidth:!0,value:V,onChange:L=>{ee(L.target.value)},onBlur:()=>{N(!1),k(l.id,"inspection_details",V)},autoFocus:!0,variant:"standard",InputProps:{style:{marginBottom:0,border:"none",outline:"none",backgroundColor:"transparent",textAlign:"center"}}}):n(M,{children:l.inspection_details||"N/A"})})}},{name:"Road Type",selector:l=>l.side,sortable:"true",center:"true",width:"120px"},{name:"Quantity/Layer No.",selector:l=>l.qty_layer,sortable:"true",center:"true",width:"150px"},...w?[{name:"In charge",selector:l=>l.incharge,sortable:"true",center:"true",cell:l=>f(le,{variant:"outlined",fullWidth:!0,size:"small",value:l.incharge||"na",onChange:v=>k(l.id,"incharge",v.target.value),MenuProps:{PaperProps:{sx:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:b.glassCard.backgroundColor,border:b.glassCard.border,borderRadius:2,boxShadow:b.glassCard.boxShadow}}},children:[n(P,{value:"na",disabled:!0,children:"Please select"}),i.map(v=>n(P,{value:v.id,children:f(B,{sx:{display:"flex"},children:[n(Cr,{src:v.profile_image,alt:v.name||"Not assigned",sx:{borderRadius:"50%",width:23,height:23,display:"flex",mr:1}}),v.name]})},v.id))]})}]:[],{name:"Planned Time",selector:l=>l.planned_time,sortable:"true",center:"true",width:"130px"},{name:"Completion Time",selector:l=>l.completion_time,sortable:"true",center:"true",width:"250px",cell:l=>n(G,{fullWidth:!0,size:"small",type:"datetime-local",value:l.completion_time?new Date(l.completion_time).toISOString().slice(0,16):"",onChange:v=>k(l.id,"completion_time",v.target.value),style:{border:"none",outline:"none",backgroundColor:"transparent"},inputProps:{placeholder:"YYYY-MM-DDTHH:MM"}})},{name:"Resubmission Count",selector:l=>l.resubmission_count,sortable:"true",center:"true",width:"160px",cell:l=>n(M,{children:l.resubmission_count?`${l.resubmission_count} ${l.resubmission_count>1?"times":"time"}`:""})},...w?[{name:"RFI Submission Date",selector:l=>l.rfi_submission_date,sortable:"true",center:"true",width:"180px",cell:l=>n(G,{fullWidth:!0,size:"small",type:"date",onChange:v=>k(l.id,"rfi_submission_date",v.target.value),value:l.rfi_submission_date?new Date(l.rfi_submission_date).toISOString().slice(0,10):"",style:{border:"none",outline:"none",backgroundColor:"transparent"},inputProps:{placeholder:"yyyy-MM-dd"}})}]:[],...w?[{name:"Actions",center:"true",width:"150px",cell:l=>f(B,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[n(J,{sx:{m:1},variant:"outlined",color:"success",size:"small",onClick:()=>{x(l),h("editDailyWork")},children:n(xt,{})}),n(J,{sx:{m:1},variant:"outlined",color:"error",size:"small",onClick:()=>t(l.id,"deleteDailyWork"),children:n(Et,{})})]})}]:[]],y=l=>{switch(l){case"new":return"blue";case"resubmission":return"orange";case"completed":return"green";case"emergency":return"red";default:return""}},k=async(l,v,N)=>{var V,ee;try{const q=await zr.post(route("dailyWorks.update"),{id:l,[v]:N});console.log(q),q.status===200?(setDailyWorks(Y=>Y.map(F=>F.id===l?{...F,[v]:N}:F)),A(Y=>Y.map(F=>F.id===l?{...F,[v]:N}:F)),ne.success(...q.data.messages||"Task updated successfully",{icon:"游릭",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:b.glassCard.backgroundColor,border:b.glassCard.border,color:b.palette.text.primary}})):ne.error(q.data.error||`Failed to update task ${[v]}.`,{icon:"游댮",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:b.glassCard.backgroundColor,border:b.glassCard.border,color:b.palette.text.primary}})}catch(q){ne.error(((ee=(V=q.response)==null?void 0:V.data)==null?void 0:ee.message)||"An unexpected error occurred.",{icon:"游댮",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:b.glassCard.backgroundColor,border:b.glassCard.border,color:b.palette.text.primary}})}},E=l=>{a(l)},W=l=>{o(l),a(1)};return f(M,{children:[n(st,{styles:{"& .cgTKyH":{backgroundColor:"transparent !important",color:b.palette.text.primary}}}),n(Xt,{columns:I,data:e,progressPending:r,pagination:!0,paginationServer:!0,paginationTotalRows:u,onChangePage:E,onChangeRowsPerPage:W,defaultSortField:"date",highlightOnHover:!0,responsive:!0,dense:!0})]})},Jt=({open:e,closeModal:r,currentRow:t,setDailyWorks:i})=>{const a=pe(),[o,u]=d.useState({id:t.id||"",date:t.date||"",number:t.number||"",planned_time:t.planned_time||"",type:t.type||"Structure",location:t.location||"",description:t.description||"",side:t.side||"SR-R",qty_layer:t.qty_layer||""});console.log(o);const[s,m]=d.useState({}),[p,h]=d.useState(!1),[x,O]=d.useState(!1);d.useEffect(()=>{const b=Object.values(o).some(w=>w!=="");O(b)},[o]);const A=b=>{const{name:w,value:S}=b.target;u(I=>({...I,[w]:S}))};async function j(b){b.preventDefault(),h(!0);const w=new Promise(async(S,I)=>{try{const y=await fetch(route("dailyWorks.update"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.head.querySelector('meta[name="csrf-token"]').content},body:JSON.stringify({ruleSet:"details",...o})}),k=await y.json();y.ok?(i(E=>E.map(W=>W.id===o.id?{...W,...o}:W)),r(),S(k.message?[k.message]:k.messages),h(!1),r(),console.log(k.message?[k.message]:k.messages)):(h(!1),m(k.errors),I(k.errors),console.error(k.errors))}catch(y){h(!1),r(),console.log(y),I(["An unexpected error occurred."])}});ne.promise(w,{pending:{render(){return f("div",{style:{display:"flex",alignItems:"center"},children:[n(He,{}),n("span",{style:{marginLeft:"8px"},children:"Updating daily work ..."})]})},icon:!1,style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}},success:{render({data:S}){return n(M,{children:S.map((I,y)=>n("div",{children:I},y))})},icon:"游릭",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}},error:{render({data:S}){return n(M,{children:S.map((I,y)=>n("div",{children:I},y))})},icon:"游댮",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}}})}return f($e,{open:e,onClose:r,children:[f(ze,{style:{cursor:"move"},id:"draggable-dialog-title",children:[n(he,{children:"Add Task"}),n(J,{variant:"outlined",color:"primary",onClick:r,sx:{position:"absolute",top:8,right:16},children:n(ir,{})})]}),f("form",{onSubmit:j,children:[n(Me,{children:f(K,{container:!0,spacing:2,children:[n(K,{item:!0,xs:12,md:6,children:n(G,{label:"RFI Date",type:"date",name:"date",fullWidth:!0,InputLabelProps:{shrink:!0},value:o.date,onChange:A,error:!!s.date,helperText:s.date})}),n(K,{item:!0,xs:12,md:6,children:n(G,{label:"RFI Number",name:"number",fullWidth:!0,value:o.number,onChange:A,error:!!s.number,helperText:s.number})}),n(K,{item:!0,xs:12,md:6,children:n(G,{label:"Planned Time",name:"planned_time",fullWidth:!0,InputLabelProps:{shrink:!0},value:o.planned_time,onChange:A,error:!!s.planned_time,helperText:s.planned_time})}),n(K,{item:!0,xs:12,md:6,children:f(Te,{fullWidth:!0,children:[n(Pe,{id:"type-label",children:"Type"}),f(le,{select:!0,label:"Type",name:"type",fullWidth:!0,value:o.type,onChange:A,error:!!s.type,helperText:s.type,labelId:"type-label",MenuProps:{PaperProps:{sx:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,borderRadius:2,boxShadow:"rgb(255, 255, 255) 0px 0px 0px 0px, rgba(0, 0, 0, 0.05) 0px 0px 0px 1px, rgba(0, 0, 0, 0.1) 0px 10px 15px -3px, rgba(0, 0, 0, 0.05) 0px 4px 6px -2px"}}},children:[n(P,{value:"Structure",children:"Structure"}),n(P,{value:"Embankment",children:"Embankment"}),n(P,{value:"Pavement",children:"Pavement"})]}),n(ct,{children:s.type})]})}),n(K,{item:!0,xs:12,md:6,children:n(G,{label:"Location",name:"location",fullWidth:!0,value:o.location,onChange:A,error:!!s.location,helperText:s.location})}),n(K,{item:!0,xs:12,md:6,children:n(G,{label:"Description",name:"description",fullWidth:!0,value:o.description,onChange:A,error:!!s.description,helperText:s.description})}),n(K,{item:!0,xs:12,md:6,children:f(G,{select:!0,label:"Road Type",name:"side",fullWidth:!0,value:o.side,onChange:A,error:!!s.side,helperText:s.side,children:[n(P,{value:"SR-R",children:"SR-R"}),n(P,{value:"SR-L",children:"SR-L"}),n(P,{value:"TR-R",children:"TR-R"}),n(P,{value:"TR-L",children:"TR-L"})]})}),n(K,{item:!0,xs:12,md:6,children:n(G,{label:"Quantity/Layer No.",name:"qty_layer",fullWidth:!0,value:o.qty_layer,onChange:A,error:!!s.qty_layer,helperText:s.qty_layer})})]})}),n(Le,{sx:{display:"flex",alignItems:"center",justifyContent:"flex-end",padding:"16px"},children:n(lr,{disabled:!x,sx:{borderRadius:"50px",padding:"6px 16px"},variant:"outlined",color:"primary",type:"submit",loading:p,children:"Submit"})})]})]})},Zt=({open:e,handleClose:r,taskIdToDelete:t,setDailyWorks:i,setFilteredData:a})=>{const o=pe();return f($e,{open:e,onClose:r,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[n(ze,{id:"alert-dialog-title",children:"Confirm Deletion"}),n(Me,{children:n(ut,{id:"alert-dialog-description",children:"Are you sure you want to delete this task? This action cannot be undone."})}),f(Le,{children:[n(Ie,{onClick:r,color:"primary",children:"Cancel"}),n(Ie,{onClick:()=>{const s=new Promise(async(m,p)=>{try{const h=await fetch("/delete-daily-work",{method:"DELETE",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.head.querySelector('meta[name="csrf-token"]').content},body:JSON.stringify({id:t})}),x=await h.json();h.ok?(i(O=>O.filter(A=>A.id!==t)),a(O=>O.filter(A=>A.id!==t)),m("Task deleted successfully")):p(x.error||"Failed to delete task")}catch(h){console.error("Error deleting task:",h),p("An error occurred while deleting the task")}finally{r()}});ne.promise(s,{pending:{render(){return f("div",{style:{display:"flex",alignItems:"center"},children:[n(He,{}),n("span",{style:{marginLeft:"8px"},children:"Deleting task..."})]})},icon:!1,style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:o.glassCard.backgroundColor,border:o.glassCard.border,color:o.palette.text.primary}},success:{render({data:m}){return n(M,{children:m})},icon:"游릭",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:o.glassCard.backgroundColor,border:o.glassCard.border,color:o.palette.text.primary}},error:{render({data:m}){return n(M,{children:m})},icon:"游댮",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:o.glassCard.backgroundColor,border:o.glassCard.border,color:o.palette.text.primary}}})},color:"error",autoFocus:!0,children:"Delete"})]})]})},en=({open:e,closeModal:r,filteredData:t,users:i})=>{console.log(i),d.useState(!1);const a=pe(),o=[{label:"Date",key:"date"},{label:"RFI No.",key:"number"},{label:"Status",key:"status"},{label:"Assigned",key:"assigned"},{label:"In charge",key:"incharge"},{label:"Type",key:"type"},{label:"Description",key:"description"},{label:"Location",key:"location"},{label:"Side",key:"side"},{label:"Quantity/Layer",key:"qty_layer"},{label:"Planned Time",key:"planned_time"},{label:"Completion Time",key:"completion_time"},{label:"Results",key:"inspection_details"},{label:"Resubmission Count",key:"resubmission_count"},{label:"RFI Submission Date",key:"rfi_submission_date"}],[u,s]=d.useState(o.map(h=>({...h,checked:!0}))),m=h=>{const x=[...u];x[h].checked=!x[h].checked,s(x)},p=async h=>{const x=new Promise((O,A)=>{try{const j=t.map(S=>{const I={};return h.forEach(y=>{if(y.checked)if(y.key==="incharge"||y.key==="assigned"){const k=i.find(E=>E.id===S[y.key]);I[y.label]=k?k.name:"N/A"}else if(y.key==="status"){const k=S[y.key];I[y.label]=k.charAt(0).toUpperCase()+k.slice(1)}else I[y.label]=S[y.key]}),I}),b=Qe.json_to_sheet(j),w=Qe.book_new();Qe.book_append_sheet(w,b,"Daily Works"),Dt(w,"DailyWorks.xlsx"),O("Export successful!"),r()}catch(j){A("Failed to export data. Please try again."),console.error("Error exporting data to Excel:",j)}});ne.promise(x,{pending:{render(){return f("div",{style:{display:"flex",alignItems:"center"},children:[n(He,{}),n("span",{style:{marginLeft:"8px"},children:"Exporting data to Excel ..."})]})},icon:!1,style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}},success:{render({data:O}){return n(M,{children:O})},icon:"游릭",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}},error:{render({data:O}){return n(M,{children:O})},icon:"游댮",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}}})};return f($e,{open:e,onClose:r,children:[f(ze,{style:{cursor:"move"},id:"draggable-dialog-title",children:[n(he,{children:"Export Daily Works"}),n(J,{variant:"outlined",color:"primary",onClick:r,sx:{position:"absolute",top:8,right:16},children:n(ir,{})})]}),n(Me,{children:f(dt,{size:"small",sx:{"& .MuiTableCell-root":{padding:"4px 8px"},"& .MuiCheckbox-root":{padding:"0px"}},children:[n(pt,{children:f(kr,{children:[n(Ae,{children:"Column Label"}),n(Ae,{align:"center",children:"Include in Export"})]})}),n(ft,{children:u.map((h,x)=>f(kr,{children:[n(Ae,{children:h.label}),n(Ae,{align:"center",children:n(mt,{checked:h.checked,onChange:()=>m(x)})})]},h.key))})]})}),n(Le,{sx:{display:"flex",alignItems:"center",justifyContent:"center",padding:"16px"},children:n(lr,{sx:{borderRadius:"50px",padding:"6px 16px"},variant:"outlined",color:"primary",type:"submit",onClick:()=>p(u),startIcon:n(Ze,{}),children:"Download"})})]})};var rn=new Map([["aac","audio/aac"],["abw","application/x-abiword"],["arc","application/x-freearc"],["avif","image/avif"],["avi","video/x-msvideo"],["azw","application/vnd.amazon.ebook"],["bin","application/octet-stream"],["bmp","image/bmp"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["cda","application/x-cdf"],["csh","application/x-csh"],["css","text/css"],["csv","text/csv"],["doc","application/msword"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["eot","application/vnd.ms-fontobject"],["epub","application/epub+zip"],["gz","application/gzip"],["gif","image/gif"],["heic","image/heic"],["heif","image/heif"],["htm","text/html"],["html","text/html"],["ico","image/vnd.microsoft.icon"],["ics","text/calendar"],["jar","application/java-archive"],["jpeg","image/jpeg"],["jpg","image/jpeg"],["js","text/javascript"],["json","application/json"],["jsonld","application/ld+json"],["mid","audio/midi"],["midi","audio/midi"],["mjs","text/javascript"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mpeg","video/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["opus","audio/opus"],["otf","font/otf"],["png","image/png"],["pdf","application/pdf"],["php","application/x-httpd-php"],["ppt","application/vnd.ms-powerpoint"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["rar","application/vnd.rar"],["rtf","application/rtf"],["sh","application/x-sh"],["svg","image/svg+xml"],["swf","application/x-shockwave-flash"],["tar","application/x-tar"],["tif","image/tiff"],["tiff","image/tiff"],["ts","video/mp2t"],["ttf","font/ttf"],["txt","text/plain"],["vsd","application/vnd.visio"],["wav","audio/wav"],["weba","audio/webm"],["webm","video/webm"],["webp","image/webp"],["woff","font/woff"],["woff2","font/woff2"],["xhtml","application/xhtml+xml"],["xls","application/vnd.ms-excel"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xml","application/xml"],["xul","application/vnd.mozilla.xul+xml"],["zip","application/zip"],["7z","application/x-7z-compressed"],["mkv","video/x-matroska"],["mov","video/quicktime"],["msg","application/vnd.ms-outlook"]]);function Ce(e,r){var t=tn(e);if(typeof t.path!="string"){var i=e.webkitRelativePath;Object.defineProperty(t,"path",{value:typeof r=="string"?r:typeof i=="string"&&i.length>0?i:e.name,writable:!1,configurable:!1,enumerable:!0})}return t}function tn(e){var r=e.name,t=r&&r.lastIndexOf(".")!==-1;if(t&&!e.type){var i=r.split(".").pop().toLowerCase(),a=rn.get(i);a&&Object.defineProperty(e,"type",{value:a,writable:!1,configurable:!1,enumerable:!0})}return e}var nn=[".DS_Store","Thumbs.db"];function an(e){return fe(this,void 0,void 0,function(){return me(this,function(r){return Re(e)&&on(e.dataTransfer)?[2,un(e.dataTransfer,e.type)]:ln(e)?[2,sn(e)]:Array.isArray(e)&&e.every(function(t){return"getFile"in t&&typeof t.getFile=="function"})?[2,cn(e)]:[2,[]]})})}function on(e){return Re(e)}function ln(e){return Re(e)&&Re(e.target)}function Re(e){return typeof e=="object"&&e!==null}function sn(e){return rr(e.target.files).map(function(r){return Ce(r)})}function cn(e){return fe(this,void 0,void 0,function(){var r;return me(this,function(t){switch(t.label){case 0:return[4,Promise.all(e.map(function(i){return i.getFile()}))];case 1:return r=t.sent(),[2,r.map(function(i){return Ce(i)})]}})})}function un(e,r){return fe(this,void 0,void 0,function(){var t,i;return me(this,function(a){switch(a.label){case 0:return e.items?(t=rr(e.items).filter(function(o){return o.kind==="file"}),r!=="drop"?[2,t]:[4,Promise.all(t.map(dn))]):[3,2];case 1:return i=a.sent(),[2,Sr(Kr(i))];case 2:return[2,Sr(rr(e.files).map(function(o){return Ce(o)}))]}})})}function Sr(e){return e.filter(function(r){return nn.indexOf(r.name)===-1})}function rr(e){if(e===null)return[];for(var r=[],t=0;t<e.length;t++){var i=e[t];r.push(i)}return r}function dn(e){if(typeof e.webkitGetAsEntry!="function")return Fr(e);var r=e.webkitGetAsEntry();return r&&r.isDirectory?Nr(r):Fr(e)}function Kr(e){return e.reduce(function(r,t){return _r(_r([],wr(r),!1),wr(Array.isArray(t)?Kr(t):[t]),!1)},[])}function Fr(e){var r=e.getAsFile();if(!r)return Promise.reject("".concat(e," is not a File"));var t=Ce(r);return Promise.resolve(t)}function pn(e){return fe(this,void 0,void 0,function(){return me(this,function(r){return[2,e.isDirectory?Nr(e):fn(e)]})})}function Nr(e){var r=e.createReader();return new Promise(function(t,i){var a=[];function o(){var u=this;r.readEntries(function(s){return fe(u,void 0,void 0,function(){var m,p,h;return me(this,function(x){switch(x.label){case 0:if(s.length)return[3,5];x.label=1;case 1:return x.trys.push([1,3,,4]),[4,Promise.all(a)];case 2:return m=x.sent(),t(m),[3,4];case 3:return p=x.sent(),i(p),[3,4];case 4:return[3,6];case 5:h=Promise.all(s.map(pn)),a.push(h),o(),x.label=6;case 6:return[2]}})})},function(s){i(s)})}o()})}function fn(e){return fe(this,void 0,void 0,function(){return me(this,function(r){return[2,new Promise(function(t,i){e.file(function(a){var o=Ce(a,e.fullPath);t(o)},function(a){i(a)})})]})})}var mn=function(e,r){if(e&&r){var t=Array.isArray(r)?r:r.split(","),i=e.name||"",a=(e.type||"").toLowerCase(),o=a.replace(/\/.*$/,"");return t.some(function(u){var s=u.trim().toLowerCase();return s.charAt(0)==="."?i.toLowerCase().endsWith(s):s.endsWith("/*")?o===s.replace(/\/.*$/,""):a===s})}return!0};function Ar(e){return bn(e)||hn(e)||qr(e)||gn()}function gn(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hn(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function bn(e){if(Array.isArray(e))return tr(e)}function Er(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);r&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,i)}return t}function Tr(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Er(Object(t),!0).forEach(function(i){Vr(e,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Er(Object(t)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(t,i))})}return e}function Vr(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function be(e,r){return xn(e)||vn(e,r)||qr(e,r)||yn()}function yn(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qr(e,r){if(e){if(typeof e=="string")return tr(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return tr(e,r)}}function tr(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,i=new Array(r);t<r;t++)i[t]=e[t];return i}function vn(e,r){var t=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var i=[],a=!0,o=!1,u,s;try{for(t=t.call(e);!(a=(u=t.next()).done)&&(i.push(u.value),!(r&&i.length===r));a=!0);}catch(m){o=!0,s=m}finally{try{!a&&t.return!=null&&t.return()}finally{if(o)throw s}}return i}}function xn(e){if(Array.isArray(e))return e}var Cn="file-invalid-type",kn="file-too-large",Dn="file-too-small",wn="too-many-files",_n=function(r){r=Array.isArray(r)&&r.length===1?r[0]:r;var t=Array.isArray(r)?"one of ".concat(r.join(", ")):r;return{code:Cn,message:"File type must be ".concat(t)}},Pr=function(r){return{code:kn,message:"File is larger than ".concat(r," ").concat(r===1?"byte":"bytes")}},Or=function(r){return{code:Dn,message:"File is smaller than ".concat(r," ").concat(r===1?"byte":"bytes")}},Sn={code:wn,message:"Too many files"};function Ur(e,r){var t=e.type==="application/x-moz-file"||mn(e,r);return[t,t?null:_n(r)]}function Gr(e,r,t){if(ie(e.size))if(ie(r)&&ie(t)){if(e.size>t)return[!1,Pr(t)];if(e.size<r)return[!1,Or(r)]}else{if(ie(r)&&e.size<r)return[!1,Or(r)];if(ie(t)&&e.size>t)return[!1,Pr(t)]}return[!0,null]}function ie(e){return e!=null}function Fn(e){var r=e.files,t=e.accept,i=e.minSize,a=e.maxSize,o=e.multiple,u=e.maxFiles,s=e.validator;return!o&&r.length>1||o&&u>=1&&r.length>u?!1:r.every(function(m){var p=Ur(m,t),h=be(p,1),x=h[0],O=Gr(m,i,a),A=be(O,1),j=A[0],b=s?s(m):null;return x&&j&&!b})}function je(e){return typeof e.isPropagationStopped=="function"?e.isPropagationStopped():typeof e.cancelBubble<"u"?e.cancelBubble:!1}function Ee(e){return e.dataTransfer?Array.prototype.some.call(e.dataTransfer.types,function(r){return r==="Files"||r==="application/x-moz-file"}):!!e.target&&!!e.target.files}function Ir(e){e.preventDefault()}function An(e){return e.indexOf("MSIE")!==-1||e.indexOf("Trident/")!==-1}function En(e){return e.indexOf("Edge/")!==-1}function Tn(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.navigator.userAgent;return An(e)||En(e)}function Q(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];return function(i){for(var a=arguments.length,o=new Array(a>1?a-1:0),u=1;u<a;u++)o[u-1]=arguments[u];return r.some(function(s){return!je(i)&&s&&s.apply(void 0,[i].concat(o)),je(i)})}}function Pn(){return"showOpenFilePicker"in window}function On(e){if(ie(e)){var r=Object.entries(e).filter(function(t){var i=be(t,2),a=i[0],o=i[1],u=!0;return Yr(a)||(console.warn('Skipped "'.concat(a,'" because it is not a valid MIME type. Check https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types for a list of valid MIME types.')),u=!1),(!Array.isArray(o)||!o.every(Xr))&&(console.warn('Skipped "'.concat(a,'" because an invalid file extension was provided.')),u=!1),u}).reduce(function(t,i){var a=be(i,2),o=a[0],u=a[1];return Tr(Tr({},t),{},Vr({},o,u))},{});return[{description:"Files",accept:r}]}return e}function In(e){if(ie(e))return Object.entries(e).reduce(function(r,t){var i=be(t,2),a=i[0],o=i[1];return[].concat(Ar(r),[a],Ar(o))},[]).filter(function(r){return Yr(r)||Xr(r)}).join(",")}function Rn(e){return e instanceof DOMException&&(e.name==="AbortError"||e.code===e.ABORT_ERR)}function jn(e){return e instanceof DOMException&&(e.name==="SecurityError"||e.code===e.SECURITY_ERR)}function Yr(e){return e==="audio/*"||e==="video/*"||e==="image/*"||e==="text/*"||/\w+\/[-+.\w]+/g.test(e)}function Xr(e){return/^.*\.[\w]+$/.test(e)}var Wn=["children"],zn=["open"],Mn=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],Ln=["refKey","onChange","onClick"];function Hn(e){return Kn(e)||Bn(e)||Qr(e)||$n()}function $n(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Bn(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Kn(e){if(Array.isArray(e))return nr(e)}function Je(e,r){return qn(e)||Vn(e,r)||Qr(e,r)||Nn()}function Nn(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Qr(e,r){if(e){if(typeof e=="string")return nr(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return nr(e,r)}}function nr(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,i=new Array(r);t<r;t++)i[t]=e[t];return i}function Vn(e,r){var t=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var i=[],a=!0,o=!1,u,s;try{for(t=t.call(e);!(a=(u=t.next()).done)&&(i.push(u.value),!(r&&i.length===r));a=!0);}catch(m){o=!0,s=m}finally{try{!a&&t.return!=null&&t.return()}finally{if(o)throw s}}return i}}function qn(e){if(Array.isArray(e))return e}function Rr(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);r&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,i)}return t}function T(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Rr(Object(t),!0).forEach(function(i){ar(e,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Rr(Object(t)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(t,i))})}return e}function ar(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function We(e,r){if(e==null)return{};var t=Un(e,r),i,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)i=o[a],!(r.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(t[i]=e[i])}return t}function Un(e,r){if(e==null)return{};var t={},i=Object.keys(e),a,o;for(o=0;o<i.length;o++)a=i[o],!(r.indexOf(a)>=0)&&(t[a]=e[a]);return t}var fr=d.forwardRef(function(e,r){var t=e.children,i=We(e,Wn),a=Zr(i),o=a.open,u=We(a,zn);return d.useImperativeHandle(r,function(){return{open:o}},[o]),Oe.createElement(d.Fragment,null,t(T(T({},u),{},{open:o})))});fr.displayName="Dropzone";var Jr={disabled:!1,getFilesFromEvent:an,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!0,autoFocus:!1};fr.defaultProps=Jr;fr.propTypes={children:_.func,accept:_.objectOf(_.arrayOf(_.string)),multiple:_.bool,preventDropOnDocument:_.bool,noClick:_.bool,noKeyboard:_.bool,noDrag:_.bool,noDragEventsBubbling:_.bool,minSize:_.number,maxSize:_.number,maxFiles:_.number,disabled:_.bool,getFilesFromEvent:_.func,onFileDialogCancel:_.func,onFileDialogOpen:_.func,useFsAccessApi:_.bool,autoFocus:_.bool,onDragEnter:_.func,onDragLeave:_.func,onDragOver:_.func,onDrop:_.func,onDropAccepted:_.func,onDropRejected:_.func,onError:_.func,validator:_.func};var or={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,acceptedFiles:[],fileRejections:[]};function Zr(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=T(T({},Jr),e),t=r.accept,i=r.disabled,a=r.getFilesFromEvent,o=r.maxSize,u=r.minSize,s=r.multiple,m=r.maxFiles,p=r.onDragEnter,h=r.onDragLeave,x=r.onDragOver,O=r.onDrop,A=r.onDropAccepted,j=r.onDropRejected,b=r.onFileDialogCancel,w=r.onFileDialogOpen,S=r.useFsAccessApi,I=r.autoFocus,y=r.preventDropOnDocument,k=r.noClick,E=r.noKeyboard,W=r.noDrag,l=r.noDragEventsBubbling,v=r.onError,N=r.validator,V=d.useMemo(function(){return In(t)},[t]),ee=d.useMemo(function(){return On(t)},[t]),q=d.useMemo(function(){return typeof w=="function"?w:jr},[w]),Y=d.useMemo(function(){return typeof b=="function"?b:jr},[b]),F=d.useRef(null),L=d.useRef(null),Be=d.useReducer(Gn,or),re=Je(Be,2),ae=re[0],D=re[1],ke=ae.isFocused,te=ae.isFileDialogActive,se=d.useRef(typeof window<"u"&&window.isSecureContext&&S&&Pn()),C=function(){!se.current&&te&&setTimeout(function(){if(L.current){var g=L.current.files;g.length||(D({type:"closeDialog"}),Y())}},300)};d.useEffect(function(){return window.addEventListener("focus",C,!1),function(){window.removeEventListener("focus",C,!1)}},[L,te,Y,se]);var H=d.useRef([]),$=function(g){F.current&&F.current.contains(g.target)||(g.preventDefault(),H.current=[])};d.useEffect(function(){return y&&(document.addEventListener("dragover",Ir,!1),document.addEventListener("drop",$,!1)),function(){y&&(document.removeEventListener("dragover",Ir),document.removeEventListener("drop",$))}},[F,y]),d.useEffect(function(){return!i&&I&&F.current&&F.current.focus(),function(){}},[F,I,i]);var X=d.useCallback(function(c){v?v(c):console.error(c)},[v]),mr=d.useCallback(function(c){c.preventDefault(),c.persist(),Se(c),H.current=[].concat(Hn(H.current),[c.target]),Ee(c)&&Promise.resolve(a(c)).then(function(g){if(!(je(c)&&!l)){var R=g.length,z=R>0&&Fn({files:g,accept:V,minSize:u,maxSize:o,multiple:s,maxFiles:m,validator:N}),U=R>0&&!z;D({isDragAccept:z,isDragReject:U,isDragActive:!0,type:"setDraggedFiles"}),p&&p(c)}}).catch(function(g){return X(g)})},[a,p,X,l,V,u,o,s,m,N]),gr=d.useCallback(function(c){c.preventDefault(),c.persist(),Se(c);var g=Ee(c);if(g&&c.dataTransfer)try{c.dataTransfer.dropEffect="copy"}catch{}return g&&x&&x(c),!1},[x,l]),hr=d.useCallback(function(c){c.preventDefault(),c.persist(),Se(c);var g=H.current.filter(function(z){return F.current&&F.current.contains(z)}),R=g.indexOf(c.target);R!==-1&&g.splice(R,1),H.current=g,!(g.length>0)&&(D({type:"setDraggedFiles",isDragActive:!1,isDragAccept:!1,isDragReject:!1}),Ee(c)&&h&&h(c))},[F,h,l]),De=d.useCallback(function(c,g){var R=[],z=[];c.forEach(function(U){var ge=Ur(U,V),de=Je(ge,2),Ne=de[0],Ve=de[1],qe=Gr(U,u,o),Fe=Je(qe,2),Ue=Fe[0],Ge=Fe[1],Ye=N?N(U):null;if(Ne&&Ue&&!Ye)R.push(U);else{var Xe=[Ve,Ge];Ye&&(Xe=Xe.concat(Ye)),z.push({file:U,errors:Xe.filter(function(nt){return nt})})}}),(!s&&R.length>1||s&&m>=1&&R.length>m)&&(R.forEach(function(U){z.push({file:U,errors:[Sn]})}),R.splice(0)),D({acceptedFiles:R,fileRejections:z,type:"setFiles"}),O&&O(R,z,g),z.length>0&&j&&j(z,g),R.length>0&&A&&A(R,g)},[D,s,V,u,o,m,O,A,j,N]),we=d.useCallback(function(c){c.preventDefault(),c.persist(),Se(c),H.current=[],Ee(c)&&Promise.resolve(a(c)).then(function(g){je(c)&&!l||De(g,c)}).catch(function(g){return X(g)}),D({type:"reset"})},[a,De,X,l]),ce=d.useCallback(function(){if(se.current){D({type:"openDialog"}),q();var c={multiple:s,types:ee};window.showOpenFilePicker(c).then(function(g){return a(g)}).then(function(g){De(g,null),D({type:"closeDialog"})}).catch(function(g){Rn(g)?(Y(g),D({type:"closeDialog"})):jn(g)?(se.current=!1,L.current?(L.current.value=null,L.current.click()):X(new Error("Cannot open the file picker because the https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API is not supported and no <input> was provided."))):X(g)});return}L.current&&(D({type:"openDialog"}),q(),L.current.value=null,L.current.click())},[D,q,Y,S,De,X,ee,s]),br=d.useCallback(function(c){!F.current||!F.current.isEqualNode(c.target)||(c.key===" "||c.key==="Enter"||c.keyCode===32||c.keyCode===13)&&(c.preventDefault(),ce())},[F,ce]),yr=d.useCallback(function(){D({type:"focus"})},[]),vr=d.useCallback(function(){D({type:"blur"})},[]),xr=d.useCallback(function(){k||(Tn()?setTimeout(ce,0):ce())},[k,ce]),ue=function(g){return i?null:g},Ke=function(g){return E?null:ue(g)},_e=function(g){return W?null:ue(g)},Se=function(g){l&&g.stopPropagation()},et=d.useMemo(function(){return function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},g=c.refKey,R=g===void 0?"ref":g,z=c.role,U=c.onKeyDown,ge=c.onFocus,de=c.onBlur,Ne=c.onClick,Ve=c.onDragEnter,qe=c.onDragOver,Fe=c.onDragLeave,Ue=c.onDrop,Ge=We(c,Mn);return T(T(ar({onKeyDown:Ke(Q(U,br)),onFocus:Ke(Q(ge,yr)),onBlur:Ke(Q(de,vr)),onClick:ue(Q(Ne,xr)),onDragEnter:_e(Q(Ve,mr)),onDragOver:_e(Q(qe,gr)),onDragLeave:_e(Q(Fe,hr)),onDrop:_e(Q(Ue,we)),role:typeof z=="string"&&z!==""?z:"presentation"},R,F),!i&&!E?{tabIndex:0}:{}),Ge)}},[F,br,yr,vr,xr,mr,gr,hr,we,E,W,i]),rt=d.useCallback(function(c){c.stopPropagation()},[]),tt=d.useMemo(function(){return function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},g=c.refKey,R=g===void 0?"ref":g,z=c.onChange,U=c.onClick,ge=We(c,Ln),de=ar({accept:V,multiple:s,type:"file",style:{display:"none"},onChange:ue(Q(z,we)),onClick:ue(Q(U,rt)),tabIndex:-1},R,L);return T(T({},de),ge)}},[L,t,s,we,i]);return T(T({},ae),{},{isFocused:ke&&!i,getRootProps:et,getInputProps:tt,rootRef:F,inputRef:L,open:ue(ce)})}function Gn(e,r){switch(r.type){case"focus":return T(T({},e),{},{isFocused:!0});case"blur":return T(T({},e),{},{isFocused:!1});case"openDialog":return T(T({},or),{},{isFileDialogActive:!0});case"closeDialog":return T(T({},e),{},{isFileDialogActive:!1});case"setDraggedFiles":return T(T({},e),{},{isDragActive:r.isDragActive,isDragAccept:r.isDragAccept,isDragReject:r.isDragReject});case"setFiles":return T(T({},e),{},{acceptedFiles:r.acceptedFiles,fileRejections:r.fileRejections});case"reset":return T({},or);default:return e}}function jr(){}const Yn=({open:e,closeModal:r,setFilteredData:t,setDailyWorks:i})=>{const[a,o]=d.useState(null),[u,s]=d.useState(!1),m=pe(),p=w=>{o(w[0])},h=()=>{o(null)},{getRootProps:x,getInputProps:O,isDragActive:A}=Zr({onDrop:p,noClick:!!a,noKeyboard:!!a}),j=w=>{if(!w)return n(Pt,{fontSize:"large"});const S=w.type;return S.startsWith("image/")?n(Image,{fontSize:"large"}):S==="application/pdf"?n(Rt,{fontSize:"large"}):S==="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"?n(Ot,{fontSize:"large"}):n(It,{fontSize:"large"})};return f($e,{open:e,onClose:r,children:[f(ze,{style:{cursor:"move"},id:"draggable-dialog-title",children:[n(he,{children:"Import Daily Works"}),n(J,{variant:"outlined",color:"primary",onClick:r,sx:{position:"absolute",top:8,right:16,zIndex:0},children:n(ir,{})})]}),f("form",{onSubmit:async w=>{console.log(a),w.preventDefault(),s(!0);const S=new FormData;S.append("file",a);for(let[y,k]of S.entries())console.log(`${y}: ${k.name}`);const I=new Promise(async(y,k)=>{try{const E=await fetch(route("dailyWorks.import"),{method:"POST",body:S,headers:{"X-CSRF-TOKEN":document.head.querySelector('meta[name="csrf-token"]').content}}),W=await E.json();E.ok?(t(W.updatedDailyWorks.dailyWorks),i(W.updatedDailyWorks.dailyWorks),y(W.message),r()):(console.error(W.errors||W.error),k("Failed to import data."))}catch(E){k(`Error: ${E.message||"An unexpected error occurred."}`)}finally{s(!1)}});ne.promise(I,{pending:{render(){return f("div",{style:{display:"flex",alignItems:"center"},children:[n(He,{}),n("span",{style:{marginLeft:"8px"},children:"Uploading file ..."})]})},icon:!1,style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:m.glassCard.backgroundColor,border:m.glassCard.border,color:m.palette.text.primary}},success:{render({data:y}){return n(M,{children:y})},icon:"游릭",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:m.glassCard.backgroundColor,border:m.glassCard.border,color:m.palette.text.primary}},error:{render({data:y}){return n(M,{children:y})},icon:"游댮",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:m.glassCard.backgroundColor,border:m.glassCard.border,color:m.palette.text.primary}}})},children:[n(Me,{children:n(K,{container:!0,spacing:2,children:n(K,{item:!0,xs:12,children:f(B,{...x(),sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",border:"2px dashed #ccc",borderRadius:"8px",padding:"20px",cursor:a?"not-allowed":"pointer","&:hover":{borderColor:a?"#ccc":"#aaa"}},children:[n("input",{...O()}),n(J,{sx:{borderRadius:"50%",backgroundColor:"#f0f0f0","&:hover":{backgroundColor:a?"#f0f0f0":"#e0e0e0",cursor:a?"not-allowed":"pointer"}},disabled:!!a,children:j(a)}),a?f(M,{children:[f(he,{variant:"body1",sx:{marginTop:"10px"},children:[a.name," (",(a.size/1024).toFixed(2)," KB)"]}),n(J,{onClick:h,sx:{marginTop:"10px",backgroundColor:"#f0f0f0","&:hover":{backgroundColor:"#e0e0e0"}},children:n(Tt,{})})]}):n(he,{variant:"body1",sx:{marginTop:"10px"},children:"Drag & drop files here, or click to select files"})]})})})}),n(Le,{sx:{display:"flex",alignItems:"center",justifyContent:"center",padding:"16px"},children:n(lr,{disabled:!a,sx:{borderRadius:"50px",padding:"6px 16px"},variant:"outlined",color:"primary",type:"submit",loading:u,startIcon:n(er,{}),children:"Upload"})})]})]})};oe.extend(wt);const Wr=gt(_t)(({theme:e})=>({"& .MuiPaper-root":{backgroundColor:e.glassCard.backgroundColor},"& .MuiInputBase-root":{color:e.palette.text.primary,borderColor:e.palette.divider},"& .MuiOutlinedInput-root":{"& fieldset":{borderColor:e.palette.divider},"&:hover fieldset":{borderColor:e.palette.primary.main},"&.Mui-focused fieldset":{borderColor:e.palette.primary.main}},"& .MuiSvgIcon-root":{color:e.palette.text.secondary},"& .MuiPickersDay-root":{color:e.palette.text.primary,"&.Mui-selected":{backgroundColor:e.palette.primary.main,color:e.palette.primary.contrastText},"&.MuiPickersDay-today":{borderColor:e.palette.primary.main}}})),Xn=Oe.memo(({auth:e,title:r,allData:t,jurisdictions:i,users:a,reports:o,reports_with_daily_works:u})=>{const s=pe(),[m,p]=d.useState([]),[h,x]=d.useState(!1),[O,A]=d.useState(0),[j,b]=d.useState([]),w=d.useMemo(()=>m.map(C=>oe(C.date)),[m]),[S,I]=d.useState(),[y,k]=d.useState(null),[E,W]=d.useState(null),[l,v]=d.useState(""),N=ht(s.breakpoints.down("md")),[V,ee]=d.useState(10),[q,Y]=d.useState(1),F=async(C,H)=>{x(!0);try{const $=await zr.get(route("dailyWorks.paginate"),{params:{page:C,perPage:H}});console.log($.data),p($.data.data),A($.data.total),x(!1)}catch{ne.error("Failed to fetch data.",{icon:"游댮",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:s.glassCard.backgroundColor,border:s.glassCard.border,color:s.palette.text.primary}}),x(!1)}};d.useEffect(()=>{F(q,V)},[q,V]);const L=d.useCallback((C,H)=>{k(C),W(H)},[]),Be=d.useCallback(()=>{W(null),k(null)},[]),re=d.useCallback(C=>{W(C)},[]),ae=d.useCallback(()=>{W(null)},[]),[D,ke]=d.useState({startDate:oe.min(...w),endDate:oe.max(...w),status:"all",incharge:"all",report:""}),te=d.useCallback((C,H)=>{ke($=>({...$,[C]:H}))},[]),se=C=>{const H=C.target.value.toLowerCase();v(H)};return d.useEffect(()=>{ke(C=>({...C,startDate:oe.min(...w),endDate:oe.max(...w)}))},[w]),d.useEffect(()=>{const H=m.filter($=>Object.values($).some(X=>String(X).toLowerCase().includes(l))).filter($=>oe($.date).isBetween(D.startDate,D.endDate,null,"[]")&&(D.status==="all"||!D.status||$.status===D.status)&&(D.incharge==="all"||!D.incharge||$.incharge===D.incharge)&&(D.report?$.report===D.report:!0));b(H)},[D,l,m]),f(M,{children:[n(ot,{title:r}),E==="editDailyWork"&&n(Jt,{open:E==="editDailyWork",currentRow:S,setDailyWorks,closeModal:ae}),E==="deleteDailyWork"&&n(Zt,{open:E==="deleteDailyWork",handleClose:Be,taskIdToDelete:y,setDailyWorks,setFilteredData:b}),E==="importDailyWorks"&&n(Yn,{open:E==="importDailyWorks",closeModal:ae,setDailyWorks,setFilteredData:b}),E==="exportDailyWorks"&&n(en,{open:E==="exportDailyWorks",closeModal:ae,filteredData:j,users:a}),n(B,{sx:{display:"flex",justifyContent:"center",p:2},children:n(bt,{in:!0,children:f(it,{children:[n(yt,{title:r,sx:{padding:"24px"},action:f(B,{display:"flex",gap:2,children:[e.permissions.includes("addTask")&&n(J,{title:"Add Task",color:"primary",id:"showAddModalBtn",children:n(St,{})}),e.roles.includes("Administrator")&&n(M,{children:N?f(M,{children:[n(J,{title:"Import Daily Works",color:"warning",onClick:()=>re("importDailyWorks"),children:n(er,{})}),n(J,{title:"Export Daily Works",color:"success",onClick:()=>re("exportDailyWorks"),children:n(Ze,{})})]}):f(M,{children:[n(Ie,{title:"Import Daily Works",variant:"outlined",color:"warning",startIcon:n(er,{}),onClick:()=>re("importDailyWorks"),children:"Import"}),n(Ie,{title:"Export Daily Works",variant:"outlined",color:"success",startIcon:n(Ze,{}),onClick:()=>re("exportDailyWorks"),children:"Export"})]})})]})}),n(Dr,{children:n(B,{children:f(K,{container:!0,spacing:2,children:[n(K,{item:!0,xs:12,sm:6,md:3,children:n(Ft,{dateAdapter:At,children:f(B,{display:"flex",alignItems:"center",children:[n(Wr,{label:"Start date",value:D.startDate,onChange:C=>te("startDate",C),textField:C=>n(G,{...C,fullWidth:!0,size:"small"})}),n(B,{sx:{mx:1},children:" to "}),n(Wr,{label:"End date",value:D.endDate,onChange:C=>te("endDate",C),textField:C=>n(G,{...C,fullWidth:!0,size:"small"})})]})})}),n(K,{item:!0,xs:6,sm:4,md:3,children:f(Te,{fullWidth:!0,children:[n(Pe,{id:"status-label",children:"Status"}),f(le,{variant:"outlined",labelId:"status-label",label:"Status",name:"status",value:D.status,onChange:C=>te("status",C.target.value),children:[n(P,{value:"all",children:"All"}),n(P,{value:"completed",children:"Completed"}),n(P,{value:"new",children:"New"}),n(P,{value:"resubmission",children:"Resubmission"}),n(P,{value:"emergency",children:"Emergency"})]})]})}),e.roles.includes("Administrator")&&n(K,{item:!0,xs:6,sm:4,md:3,children:f(Te,{fullWidth:!0,children:[n(Pe,{id:"incharge-label",children:"Incharge"}),f(le,{variant:"outlined",labelId:"incharge-label",label:"Incharge",name:"incharge",value:D.incharge,onChange:C=>te("incharge",C.target.value),children:[n(P,{value:"all",children:"All"}),t.allInCharges.map(C=>n(P,{value:C.id,children:C.name},C.id))]})]})}),n(K,{item:!0,xs:6,sm:4,md:3,children:f(Te,{fullWidth:!0,children:[n(Pe,{children:"Select Report"}),n(le,{variant:"outlined",name:"qc_report",value:D.report,onChange:C=>te("report",C.target.value),children:n(P,{value:"",disabled:!0,children:"Select Report"})})]})})]})})}),f(Dr,{children:[n(G,{label:"Search",fullWidth:!0,variant:"outlined",placeholder:"Search...",value:l,onChange:se,InputProps:{startAdornment:n(vt,{position:"start",children:n(Br,{})})}}),n(Qt,{setData:p,filteredData:j,setFilteredData:b,reports:o,setCurrentRow:I,setCurrentPage:Y,setPerPage:ee,handleClickOpen:L,openModal:re,juniors:t.juniors,totalRows:O,loading:h,data:m,allInCharges:t.allInCharges,jurisdictions:i,users:a,reports_with_daily_works:u})]})]})})})]})});Xn.layout=e=>n(Ct,{children:e});export{Xn as default};
