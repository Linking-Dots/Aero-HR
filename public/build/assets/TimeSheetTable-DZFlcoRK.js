import{V as q,a as e,j as s,F as J}from"./app-BgZxPh_T.js";import{r as a,s as X,t as I,G as i,e as Z,g as ee,T as f,a as $,B as g,a0 as te,a1 as ve,f as ye}from"./vendor-aMbn8-Jn.js";import{t as Se,u as _e,m as we,o as Ce,c as F,e as Me,f as Ae,G as re}from"./App-DYsj1FwD.js";import{d as V}from"./dayjs.min-BZ3s2SPr.js";import{d as Pe}from"./Search-DHBRVQbO.js";import{s as ke}from"./chunk-4EXC76WE-B_WN-iZL.js";import{a as Le,u as Ne}from"./chunk-R6AK6OQ4-bmHOZR1c.js";import{i as G}from"./chunk-HJTJQZF3-Car__j_2.js";import{t as Te,a as ze,b as Ue,c as Ee,d as De,e as x}from"./chunk-F3UDT23P-CFfZ8LoV.js";import{p as je}from"./chunk-YHY32LNM-CP9Pzjl6.js";var ae=Se({slots:{base:["group","relative","overflow-hidden","bg-content3 dark:bg-content2","pointer-events-none","before:opacity-100","before:absolute","before:inset-0","before:-translate-x-full","before:animate-[shimmer_2s_infinite]","before:border-t","before:border-content4/30","before:bg-gradient-to-r","before:from-transparent","before:via-content4","dark:before:via-default-700/10","before:to-transparent","after:opacity-100","after:absolute","after:inset-0","after:-z-10","after:bg-content3","dark:after:bg-content2","data-[loaded=true]:pointer-events-auto","data-[loaded=true]:overflow-visible","data-[loaded=true]:!bg-transparent","data-[loaded=true]:before:opacity-0 data-[loaded=true]:before:-z-10 data-[loaded=true]:before:animate-none","data-[loaded=true]:after:opacity-0"],content:["opacity-0","group-data-[loaded=true]:opacity-100"]},variants:{disableAnimation:{true:{base:"before:animate-none before:transition-none after:transition-none",content:"transition-none"},false:{base:"transition-background !duration-300",content:"transition-opacity motion-reduce:transition-none !duration-300"}}},defaultVariants:{}});function He(b){var c,m;const d=_e(),[l,v]=we(b,ae.variantKeys),{as:L,children:M,isLoaded:N=!1,className:T,classNames:u,...y}=l,A=L||"div",w=(m=(c=b.disableAnimation)!=null?c:d==null?void 0:d.disableAnimation)!=null?m:!1,S=a.useMemo(()=>ae({...v,disableAnimation:w}),[Ce(v),w,M]),z=F(u==null?void 0:u.base,T);return{Component:A,children:M,slots:S,classNames:u,getSkeletonProps:(h={})=>({"data-loaded":Me(N),className:S.base({class:F(z,h==null?void 0:h.className)}),...y}),getContentProps:(h={})=>({className:S.content({class:F(u==null?void 0:u.content,h==null?void 0:h.className)})})}}var ne=Ae((b,c)=>{const{Component:m,children:d,getSkeletonProps:l,getContentProps:v}=He({...b});return X.jsx(m,{ref:c,...l(),children:X.jsx("div",{...v(),children:d})})});ne.displayName="HeroUI.Skeleton";var Re=ne;const qe=({handleDateChange:b,selectedDate:c,updateTimeSheet:m})=>{const{auth:d}=q().props,{url:l}=q();I("(max-width: 640px)");const v=I("(min-width: 641px) and (max-width: 1024px)"),L=I("(min-width: 1025px)"),[M,N]=a.useState([]),[T,u]=a.useState([]),[y,A]=a.useState([]),[w,S]=a.useState(""),[z,O]=a.useState(0),[Y,h]=a.useState(0),[se,Ie]=a.useState(10),[B,oe]=a.useState(1),[W,ie]=a.useState(""),[le,ce]=a.useState(!1),[U,de]=a.useState({currentMonth:V().format("YYYY-MM")}),me=t=>{const n=t.target.value.toLowerCase();ie(n)},[E,K]=a.useState(2),D=a.useRef(null),j=a.useRef(null),H=()=>{if(D.current&&j.current){const t=D.current.clientHeight,n=j.current.clientHeight,r=t-150,_=Math.floor(r/n);K(_)}},ue=()=>{K(t=>t+2)},he=t=>T.find(n=>String(n.user_id)===String(t)),pe=async(t,n,r,_,p)=>{var P,R,C,k;const Q=l!=="/attendance-employee"?route("getAllUsersAttendanceForDate"):route("getCurrentUserAttendanceForDate");try{const o=await axios.get(Q,{params:{page:n,perPage:r,employee:_,date:t,currentYear:p.currentMonth?V(p.currentMonth).year():"",currentMonth:p.currentMonth?V(p.currentMonth).format("MM"):""}});o.status===200&&(N(o.data.attendances),u(o.data.leaves),A(o.data.absent_users),O(o.data.total),h(o.data.last_page),S(""),ce(!0))}catch(o){console.error("Error fetching attendance data:",o),S(((R=(P=o.response)==null?void 0:P.data)==null?void 0:R.message)||"An error occurred while retrieving attendance data."),A((k=(C=o.response)==null?void 0:C.data)==null?void 0:k.absent_users)}},fe=(t,n)=>{var r,_,p;switch(n){case"date":return e(x,{className:"text-xs sm:text-sm md:text-base lg:text-lg",children:new Date(t.date).toLocaleString("en-US",{month:"long",day:"numeric",year:"numeric"})});case"employee":return e(x,{className:"whitespace-nowrap text-xs sm:text-sm md:text-base lg:text-lg",children:e(Ne,{avatarProps:{radius:"lg",size:L||v?"md":"sm",src:(r=t.user)==null?void 0:r.profile_image},description:(_=t.user)==null?void 0:_.phone,name:(p=t.user)==null?void 0:p.name})});case"clockin_time":return e(x,{className:"text-xs sm:text-sm md:text-base lg:text-lg",children:t.punchin_time?new Date(`2024-06-04T${t.punchin_time}`).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):"N/A"});case"clockout_time":return e(x,{className:"text-xs sm:text-sm md:text-base lg:text-lg",children:t.punchout_time?new Date(`2024-06-04T${t.punchout_time}`).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):"N/A"});case"production_time":if(t.punchin_time&&t.punchout_time){const P=new Date(`2024-06-04T${t.punchin_time}`),C=new Date(`2024-06-04T${t.punchout_time}`)-P,k=Math.floor(C/(1e3*60*60)),o=Math.floor(C%(1e3*60*60)/(1e3*60));return e(x,{className:"text-xs sm:text-sm md:text-base lg:text-lg",children:`${k}h ${o}m`})}return e(x,{className:"text-xs sm:text-sm md:text-base lg:text-lg",children:"N/A"});default:return e(x,{className:"text-xs sm:text-sm md:text-base lg:text-lg",children:"N/A"})}},ge=[{name:"Date",uid:"date"},...d.roles.includes("Administrator")&&l!=="/attendance-employee"?[{name:"Employee",uid:"employee"}]:[],{name:"Clockin Time",uid:"clockin_time"},{name:"Clockout Time",uid:"clockout_time"},{name:"Production Time",uid:"production_time"}],xe=t=>{oe(t)},be=a.useCallback((t,n)=>{de(r=>({...r,[t]:n}))},[]);return a.useEffect(()=>(setTimeout(()=>{H()},500),window.addEventListener("resize",H),()=>window.removeEventListener("resize",H)),[]),a.useEffect(()=>{pe(c,B,se,W,U)},[m]),e(g,{sx:{display:"flex",justifyContent:"center",p:2},children:s(i,{container:!0,spacing:2,children:[e(i,{item:!0,xs:12,md:l!=="/attendance-employee"?9:12,children:e(Z,{in:!0,children:s(re,{children:[e(ee,{title:e(f,{sx:{fontSize:{xs:"1.0rem",sm:"1.4rem",md:"1.8rem"}},children:l==="/attendance-employee"?"Timesheet for the month of "+new Date(U.currentMonth).toLocaleString("en-US",{month:"long",year:"numeric"}):"Timesheet of "+new Date(c).toLocaleString("en-US",{month:"long",day:"numeric",year:"numeric"})}),sx:{padding:"24px"}}),e($,{children:e(g,{children:s(i,{container:!0,spacing:2,children:[d.roles.includes("Administrator")&&l!=="/attendance-employee"&&s(J,{children:[e(i,{item:!0,xs:12,sm:6,md:4,children:e(G,{label:"Search",type:"text",fullWidth:!0,variant:"bordered",placeholder:"Employee...",value:W,onChange:me,endContent:e(Pe,{})})}),e(i,{item:!0,xs:12,sm:6,md:4,children:e(G,{label:"Select Date",type:"date",variant:"bordered",onChange:b,value:new Date(c).toISOString().slice(0,10)||""})})]}),d.roles.includes("Employee")&&l==="/attendance-employee"&&e(i,{item:!0,xs:12,sm:6,md:4,children:e(G,{label:"Current Month",type:"month",fullWidth:!0,variant:"bordered",placeholder:"Month...",value:U.currentMonth,onChange:t=>be("currentMonth",t.target.value)})})]})})}),e($,{children:w?e(f,{color:"error",children:w}):s("div",{style:{maxHeight:"84vh"},children:[e(ke,{orientation:"horizontal",className:"overflow-y-hidden",children:e(Re,{className:"rounded-lg",isLoaded:le,children:s(Te,{isStriped:!0,selectionMode:"multiple",selectionBehavior:"toggle",isCompact:!0,removeWrapper:!0,"aria-label":"Attendance Table",isHeaderSticky:!0,children:[e(ze,{columns:ge,children:t=>e(Ue,{align:"start",children:t.name},t.uid)}),e(Ee,{items:M,children:t=>e(De,{children:n=>fe(t,n)},t.id)})]},m)})}),z>10&&e("div",{className:"py-2 px-2 flex justify-center items-end",style:{height:"100%"},children:e(je,{initialPage:1,isCompact:!0,showControls:!0,showShadow:!0,color:"primary",variant:"bordered",page:B,total:Y,onChange:xe})})]})})]})})}),d.roles.includes("Administrator")&&l!=="/attendance-employee"&&y.length>0&&e(i,{item:!0,xs:12,md:3,children:e(Z,{in:!0,children:s(re,{ref:D,children:[e(ee,{title:s(g,{sx:{display:"flex",alignItems:"center"},children:[e(f,{sx:{fontSize:{xs:"1.0rem",sm:"1.4rem",md:"1.8rem"}},children:"Absent on "+new Date(c).toLocaleString("en-US",{month:"long",day:"numeric",year:"numeric"})}),e(te,{sx:{ml:1,fontSize:{xs:"0.8rem",sm:"1.1rem",md:"1.4rem"}},label:y.length,variant:"outlined",color:"error",size:"small"})]})}),e($,{children:s(g,{children:[y.slice(0,E).map((t,n)=>{const r=he(t.id);return e(ve,{in:n<E,timeout:"auto",unmountOnExit:!0,children:e(g,{ref:j,sx:{mb:2,p:2,border:"1px solid #e0e0e0",borderRadius:2},children:s(i,{container:!0,alignItems:"center",children:[e(i,{item:!0,xs:12,children:s(g,{sx:{display:"flex",alignItems:"center"},children:[e(Le,{src:t.profile_image,alt:t.name}),e(f,{sx:{m:2,fontSize:{xs:"1.0rem",sm:"1.2rem",md:"1.4rem"}},children:t.name})]})}),r?s(J,{children:[s(i,{item:!0,xs:6,children:[e(f,{sx:{fontSize:{xs:"1.0rem",sm:"1.2rem",md:"1.4rem"}},children:r.from_date===r.to_date?r.from_date:`${r.from_date} to ${r.to_date}`}),e(f,{sx:{fontSize:{xs:"0.8rem",sm:"1.0rem",md:"1.2rem"}},color:"textSecondary",children:"On "+r.leave_type+" Leave"})]}),e(i,{item:!0,xs:6,sx:{textAlign:"right"},children:e(te,{label:r.status,variant:"outlined",color:r.status==="Pending"?"error":"success",size:"small"})})]}):e(i,{item:!0,xs:12,children:e(f,{color:"error",sx:{fontSize:{xs:"1.0rem",sm:"1.2rem",md:"1.4rem"}},children:"Absent without Leave"})})]})})},n)}),E<y.length&&e(g,{textAlign:"center",children:e(ye,{variant:"outlined",onClick:ue,children:"Load More"})})]})})]})})})]})})};export{qe as T,Re as s};
