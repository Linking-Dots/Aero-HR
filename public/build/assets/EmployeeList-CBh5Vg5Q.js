import{j as e,r as k,a as m,Y as _}from"./app-C50wGqcD.js";import{n as B,u as L,t as M,T as O,M as g,I as f,v as H,w as v,A as z,B as E,c as G,d as J,b as U}from"./App-C44oIMRG.js";import{G as W}from"./GlassCard-BmVvf2dg.js";import{T as $,a as q,b as K,c as A,d as t,e as V}from"./TableRow-I4btRuGj.js";import{F as T,I as F,S as D}from"./Select-BZntpbv9.js";import{E as X,D as Y}from"./Edit-Cdu2GT2o.js";import{C as I}from"./CircularProgress-Co6pm4Eg.js";import{C as Q}from"./CardHeader-BpLmUih9.js";const Z=B(e.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add"),ee=({allUsers:b,departments:u,designations:c})=>{const[j,y]=k.useState(b),a=L();console.log(a);const[re,N]=k.useState({});async function w(r,l,s){const d=new Promise(async(n,i)=>{try{const o=s.target.value,p=await fetch(route("profile.update"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.head.querySelector('meta[name="csrf-token"]').content},body:JSON.stringify({id:l,[r]:o})}),x=await p.json();p.ok?(y(R=>R.map(h=>{if(h.id===l){const C={...h};return r==="department"&&h.department!==o&&(C.designation=null),C[r]=o,C}return h})),n([...x.messages]),console.log(x.messages)):(i(x.messages),console.error(x.messages))}catch(o){console.log(o),i(["An unexpected error occurred."])}});v.promise(d,{pending:{render(){return e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx(I,{}),e.jsxs("span",{style:{marginLeft:"8px"},children:["Updating employee ",r,"..."]})]})},icon:!1,style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}},success:{render({data:n}){return e.jsx(e.Fragment,{children:n.map((i,o)=>e.jsx("div",{children:i},o))})},icon:"ðŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}},error:{render({data:n}){return e.jsx(e.Fragment,{children:n.map((i,o)=>e.jsx("div",{children:i},o))})},icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}}})}const P=async r=>{const l=new Promise(async(s,d)=>{try{const n=await fetch(route("profile.delete"),{method:"DELETE",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.head.querySelector('meta[name="csrf-token"]').content},body:JSON.stringify({user_id:r})}),i=await n.json();n.ok?(y(o=>o.filter(p=>p.id!==r)),s([i.message])):d([i.message])}catch(n){console.error("Error deleting user:",n),d(["An error occurred while deleting user. Please try again."])}});v.promise(l,{pending:{render(){return e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx(I,{}),e.jsx("span",{style:{marginLeft:"8px"},children:"Deleting user..."})]})},icon:!1,style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}},success:{render({data:s}){return e.jsx(e.Fragment,{children:s.map((d,n)=>e.jsx("div",{children:d},n))})},icon:"ðŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}},error:{render({data:s}){return e.jsx(e.Fragment,{children:s.map((d,n)=>e.jsx("div",{children:d},n))})},icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}}})},S=r=>{N(l=>({...l,[r]:null}))};return e.jsx($,{style:{maxHeight:"70vh",overflowY:"auto"},children:e.jsxs(q,{"aria-label":"employee table",children:[e.jsx(K,{children:e.jsxs(A,{children:[e.jsx(t,{sx:{whiteSpace:"nowrap"},children:"Employee ID"}),e.jsx(t,{sx:{whiteSpace:"nowrap"},children:"Name"}),e.jsx(t,{sx:{whiteSpace:"nowrap"},children:"Email"}),e.jsx(t,{sx:{whiteSpace:"nowrap"},children:"Mobile"}),e.jsx(t,{sx:{whiteSpace:"nowrap"},children:"Join Date"}),e.jsx(t,{sx:{whiteSpace:"nowrap"},children:"Department"}),e.jsx(t,{sx:{whiteSpace:"nowrap"},children:"Role"}),e.jsx(t,{sx:{whiteSpace:"nowrap"},align:"right",children:"Action"})]})}),e.jsx(V,{children:j.map(r=>{var l;return e.jsxs(A,{children:[e.jsx(t,{sx:{whiteSpace:"nowrap"},children:r.employee_id||"N/A"}),e.jsxs(t,{sx:{display:"flex",alignItems:"center",whiteSpace:"nowrap"},children:[e.jsx(M,{src:`assets/images/users/${r.user_name}.jpg`,alt:r.first_name}),e.jsxs(O,{sx:{marginLeft:"10px"},children:[e.jsx(m,{style:{textDecoration:"none",color:a.palette.text.primary,fontWeight:"bold"},href:route("profile",{user:r.id}),children:r.name||"N/A"}),e.jsx("br",{}),((l=c.find(s=>s.id===r.designation))==null?void 0:l.title)||"N/A"]})]}),e.jsx(t,{sx:{whiteSpace:"nowrap"},children:r.phone||"N/A"}),e.jsx(t,{sx:{whiteSpace:"nowrap"},children:r.email||"N/A"}),e.jsx(t,{sx:{whiteSpace:"nowrap"},children:r.date_of_joining||"N/A"}),e.jsx(t,{sx:{whiteSpace:"nowrap"},children:e.jsxs(T,{size:"small",fullWidth:!0,children:[e.jsx(F,{id:"department",children:"Department"}),e.jsxs(D,{labelId:"department",id:`department-select-${r.id}`,value:r.department||"na",onChange:s=>w("department",r.id,s),label:"Department",MenuProps:{PaperProps:{sx:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,borderRadius:2,boxShadow:"rgb(255, 255, 255) 0px 0px 0px 0px, rgba(0, 0, 0, 0.05) 0px 0px 0px 1px, rgba(0, 0, 0, 0.1) 0px 10px 15px -3px, rgba(0, 0, 0, 0.05) 0px 4px 6px -2px"}}},children:[e.jsx(g,{value:"na",disabled:!0,children:"Select Department"}),u.map(s=>e.jsx(g,{value:s.id,children:s.name},s.id))]})]})}),e.jsx(t,{sx:{whiteSpace:"nowrap"},children:e.jsxs(T,{size:"small",fullWidth:!0,children:[e.jsx(F,{id:"designation",children:"Designation"}),e.jsxs(D,{labelId:"designation",id:`designation-select-${r.id}`,value:r.designation||"na",onChange:s=>w("designation",r.id,s),disabled:!r.department,label:"Designation",MenuProps:{PaperProps:{sx:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,borderRadius:2,boxShadow:"rgb(255, 255, 255) 0px 0px 0px 0px, rgba(0, 0, 0, 0.05) 0px 0px 0px 1px, rgba(0, 0, 0, 0.1) 0px 10px 15px -3px, rgba(0, 0, 0, 0.05) 0px 4px 6px -2px"}}},children:[e.jsx(g,{value:"na",disabled:!0,children:"Select Designation"}),c.filter(s=>s.department_id===r.department).map(s=>e.jsx(g,{value:s.id,children:s.title},s.id))]})]})}),e.jsxs(t,{sx:{whiteSpace:"nowrap"},align:"right",children:[e.jsx(f,{component:m,href:route("profile",{user:r.id}),onClick:()=>{S(r.id)},children:e.jsx(H,{})}),e.jsx(f,{component:m,href:route("profile",{user:r.id}),onClick:()=>{S(r.id)},children:e.jsx(X,{})}),e.jsxs(f,{component:m,href:route("profile",{user:r.id}),onClick:()=>{P(r.id)},children:[e.jsx(Y,{})," "]})]})]},r.id)})})]})})},ce=({title:b,allUsers:u,departments:c,designations:j})=>e.jsxs(z,{children:[e.jsx(_,{title:b}),e.jsx(E,{sx:{display:"flex",justifyContent:"center",p:2},children:e.jsx(G,{in:!0,children:e.jsxs(W,{children:[e.jsx(Q,{title:"Employees",sx:{padding:"24px"},action:e.jsx(E,{display:"flex",gap:2,children:e.jsx(J,{title:"Add Employee",variant:"outlined",color:"success",startIcon:e.jsx(Z,{}),children:"Add Employee"})})}),e.jsx(U,{children:e.jsx(ee,{allUsers:u,departments:c,designations:j})})]})})})]});export{ce as default};
