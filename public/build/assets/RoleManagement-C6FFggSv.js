import{r as n,c as W,j as s,a as oe,b as t,Q as Je,F as Ce,p as Xe}from"./app-CveJs62H.js";import{x as pe,y as ge,n as be,_ as he,aD as Ye,o as L,M as Ze,s as Y,p as ie,q as fe,ae as Ke,ag as er,u as rr,a as Re,H as ce,aE as Ne,aF as sr,P as T,B as de,f as ae,d as R,G as or,c as ar,am as Se,i as tr,J as nr,k as te,I as Ae,aG as ir,aH as lr,A as cr}from"./App-CF1ZEPaY.js";import{P as dr}from"./PageHeader-JCSPA9cD.js";import{S as mr}from"./StatsCards-BrGPWgQK.js";import{F as ur}from"./FunnelIcon-X30X9UXZ.js";import{a as Pe,b as ke,c as Me}from"./DialogContent-BfNQGjV1.js";import{F as _e}from"./PlusIcon-CfLV5oS9.js";import{D as $e}from"./DialogTitle-Ck6E5ZBt.js";import{T as me}from"./TextField-B_VQlkv5.js";import{B as Fe}from"./Button-DyrBR4K-.js";import{L as je}from"./LoadingButton-BfrYJqV8.js";import{F as pr}from"./ExclamationTriangleIcon-BVKTsQB-.js";import{F as gr}from"./PencilSquareIcon-rdIlOMXW.js";import{F as br}from"./TrashIcon-BlBUBYhL.js";import{u as hr}from"./useSlot-DrcGNYaZ.js";import{C as fr}from"./Checkbox-CE6RTK8P.js";import{F as xr}from"./DocumentArrowDownIcon-CDjkeEan.js";import{F as yr}from"./PresentationChartLineIcon-BD5zjN6Q.js";import"./app-ih7M3oVU.js";import"./chunk-D5XJWRAV-DN9_1nqi.js";import"./Select-DSIHQZND.js";import"./Popover-Da8H0h9t.js";import"./List-mLLHOw7R.js";import"./CircularProgress-CWDtYXx-.js";const Be=n.createContext({});function vr(r){return ge("MuiAccordion",r)}const ne=pe("MuiAccordion",["root","rounded","expanded","disabled","gutters","region"]),wr=["children","className","defaultExpanded","disabled","disableGutters","expanded","onChange","square","slots","slotProps","TransitionComponent","TransitionProps"],Cr=r=>{const{classes:a,square:u,expanded:i,disabled:y,disableGutters:h}=r;return fe({root:["root",!u&&"rounded",i&&"expanded",y&&"disabled",!h&&"gutters"],region:["region"]},vr,a)},Rr=Y(Ke,{name:"MuiAccordion",slot:"Root",overridesResolver:(r,a)=>{const{ownerState:u}=r;return[{[`& .${ne.region}`]:a.region},a.root,!u.square&&a.rounded,!u.disableGutters&&a.gutters]}})(({theme:r})=>{const a={duration:r.transitions.duration.shortest};return{position:"relative",transition:r.transitions.create(["margin"],a),overflowAnchor:"none","&::before":{position:"absolute",left:0,top:-1,right:0,height:1,content:'""',opacity:1,backgroundColor:(r.vars||r).palette.divider,transition:r.transitions.create(["opacity","background-color"],a)},"&:first-of-type":{"&::before":{display:"none"}},[`&.${ne.expanded}`]:{"&::before":{opacity:0},"&:first-of-type":{marginTop:0},"&:last-of-type":{marginBottom:0},"& + &":{"&::before":{display:"none"}}},[`&.${ne.disabled}`]:{backgroundColor:(r.vars||r).palette.action.disabledBackground}}},({theme:r})=>({variants:[{props:a=>!a.square,style:{borderRadius:0,"&:first-of-type":{borderTopLeftRadius:(r.vars||r).shape.borderRadius,borderTopRightRadius:(r.vars||r).shape.borderRadius},"&:last-of-type":{borderBottomLeftRadius:(r.vars||r).shape.borderRadius,borderBottomRightRadius:(r.vars||r).shape.borderRadius,"@supports (-ms-ime-align: auto)":{borderBottomLeftRadius:0,borderBottomRightRadius:0}}}},{props:a=>!a.disableGutters,style:{[`&.${ne.expanded}`]:{margin:"16px 0"}}}]})),Nr=n.forwardRef(function(a,u){const i=be({props:a,name:"MuiAccordion"}),{children:y,className:h,defaultExpanded:M=!1,disabled:_=!1,disableGutters:G=!1,expanded:v,onChange:$,square:N=!1,slots:Q={},slotProps:w={},TransitionComponent:E,TransitionProps:b}=i,D=he(i,wr),[f,F]=Ye({controlled:v,default:M,name:"Accordion",state:"expanded"}),A=n.useCallback(x=>{F(!f),$&&$(x,!f)},[f,$,F]),[S,...Z]=n.Children.toArray(y),O=n.useMemo(()=>({expanded:f,disabled:_,disableGutters:G,toggle:A}),[f,_,G,A]),P=L({},i,{square:N,disabled:_,disableGutters:G,expanded:f}),U=Cr(P),K=L({transition:E},Q),V=L({transition:b},w),[B,ee]=hr("transition",{elementType:Ze,externalForwardedProps:{slots:K,slotProps:V},ownerState:P});return W.jsxs(Rr,L({className:ie(U.root,h),ref:u,ownerState:P,square:N},D,{children:[W.jsx(Be.Provider,{value:O,children:S}),W.jsx(B,L({in:f,timeout:"auto"},ee,{children:W.jsx("div",{"aria-labelledby":S.props.id,id:S.props["aria-controls"],role:"region",className:U.region,children:Z})}))]}))});function Sr(r){return ge("MuiAccordionDetails",r)}pe("MuiAccordionDetails",["root"]);const Ar=["className"],Pr=r=>{const{classes:a}=r;return fe({root:["root"]},Sr,a)},kr=Y("div",{name:"MuiAccordionDetails",slot:"Root",overridesResolver:(r,a)=>a.root})(({theme:r})=>({padding:r.spacing(1,2,2)})),Mr=n.forwardRef(function(a,u){const i=be({props:a,name:"MuiAccordionDetails"}),{className:y}=i,h=he(i,Ar),M=i,_=Pr(M);return W.jsx(kr,L({className:ie(_.root,y),ref:u,ownerState:M},h))});function _r(r){return ge("MuiAccordionSummary",r)}const q=pe("MuiAccordionSummary",["root","expanded","focusVisible","disabled","gutters","contentGutters","content","expandIconWrapper"]),$r=["children","className","expandIcon","focusVisibleClassName","onClick"],Fr=r=>{const{classes:a,expanded:u,disabled:i,disableGutters:y}=r;return fe({root:["root",u&&"expanded",i&&"disabled",!y&&"gutters"],focusVisible:["focusVisible"],content:["content",u&&"expanded",!y&&"contentGutters"],expandIconWrapper:["expandIconWrapper",u&&"expanded"]},_r,a)},jr=Y(er,{name:"MuiAccordionSummary",slot:"Root",overridesResolver:(r,a)=>a.root})(({theme:r})=>{const a={duration:r.transitions.duration.shortest};return{display:"flex",minHeight:48,padding:r.spacing(0,2),transition:r.transitions.create(["min-height","background-color"],a),[`&.${q.focusVisible}`]:{backgroundColor:(r.vars||r).palette.action.focus},[`&.${q.disabled}`]:{opacity:(r.vars||r).palette.action.disabledOpacity},[`&:hover:not(.${q.disabled})`]:{cursor:"pointer"},variants:[{props:u=>!u.disableGutters,style:{[`&.${q.expanded}`]:{minHeight:64}}}]}}),Dr=Y("div",{name:"MuiAccordionSummary",slot:"Content",overridesResolver:(r,a)=>a.content})(({theme:r})=>({display:"flex",flexGrow:1,margin:"12px 0",variants:[{props:a=>!a.disableGutters,style:{transition:r.transitions.create(["margin"],{duration:r.transitions.duration.shortest}),[`&.${q.expanded}`]:{margin:"20px 0"}}}]})),Br=Y("div",{name:"MuiAccordionSummary",slot:"ExpandIconWrapper",overridesResolver:(r,a)=>a.expandIconWrapper})(({theme:r})=>({display:"flex",color:(r.vars||r).palette.action.active,transform:"rotate(0deg)",transition:r.transitions.create("transform",{duration:r.transitions.duration.shortest}),[`&.${q.expanded}`]:{transform:"rotate(180deg)"}})),Tr=n.forwardRef(function(a,u){const i=be({props:a,name:"MuiAccordionSummary"}),{children:y,className:h,expandIcon:M,focusVisibleClassName:_,onClick:G}=i,v=he(i,$r),{disabled:$=!1,disableGutters:N,expanded:Q,toggle:w}=n.useContext(Be),E=f=>{w&&w(f),G&&G(f)},b=L({},i,{expanded:Q,disabled:$,disableGutters:N}),D=Fr(b);return W.jsxs(jr,L({focusRipple:!1,disableRipple:!0,disabled:$,component:"div","aria-expanded":Q,className:ie(D.root,h),focusVisibleClassName:ie(D.focusVisible,_),onClick:E,ref:u,ownerState:b},v,{children:[W.jsx(Dr,{className:D.content,ownerState:b,children:y}),M&&W.jsx(Br,{className:D.expandIconWrapper,ownerState:b,children:M})]}))}),ue=r=>Array.isArray(r)?[...r]:[],De=r=>r&&typeof r=="object"&&!Array.isArray(r)?{...r}:{},Gr=r=>{const a=ue(r.roles),u=ue(r.permissions),i=De(r.permissions_grouped),y=ue(r.role_has_permissions);De(r.enterprise_modules);const h=!!r.can_manage_super_admin,M=r.title;console.log("RoleManagement Props Has:",{roles:a,permissions:u,permissionsGrouped:i,rolePermissions:y,canManageSuperAdmin:h});const _=rr(),G=Re(_.breakpoints.down("sm"));Re(_.breakpoints.down("md"));const[v,$]=n.useState(a),[N,Q]=n.useState(u),[w,E]=n.useState(y),[b,D]=n.useState(a.length>0?a[0].id:null),[f,F]=n.useState(new Set),[A,S]=n.useState(!1),[Z,O]=n.useState(!1),[P,U]=n.useState(null),[K,V]=n.useState(!1),[B,ee]=n.useState(null),[x,xe]=n.useState(""),[j,ye]=n.useState("all"),[re,H]=n.useState({name:"",description:"",permissions:[],hierarchy_level:10}),d=n.useMemo(()=>v.find(e=>e.id===b)||null,[v,b]);n.useEffect(()=>{if(b){const e=le(b);F(new Set(e))}else F(new Set)},[b,w]);const z=n.useMemo(()=>({totalRoles:Array.isArray(v)?v.length:0,totalPermissions:Array.isArray(N)?N.length:0,activeRole:(d==null?void 0:d.name)||"None Selected",grantedPermissions:f.size}),[v,N,d,f]),Te=n.useMemo(()=>[{title:"Total Roles",value:z.totalRoles,icon:s(ce,{}),color:"text-blue-600",iconBg:"bg-blue-500/20",description:"System roles"},{title:"Permissions",value:z.totalPermissions,icon:s(Ne,{}),color:"text-green-600",iconBg:"bg-green-500/20",description:"Available permissions"},{title:"Active Role",value:z.activeRole==="None Selected"?"None":z.activeRole,icon:s(sr,{}),color:"text-purple-600",iconBg:"bg-purple-500/20",description:"Currently selected",customStyle:z.activeRole==="None Selected"?{fontSize:"1rem"}:{}},{title:"Granted",value:z.grantedPermissions,icon:s(ur,{}),color:"text-orange-600",iconBg:"bg-orange-500/20",description:"Active permissions"}],[z]);n.useMemo(()=>{if(!i||typeof i!="object")return[];let e=[];return Object.entries(i).forEach(([o,l])=>{if(j==="all"||j===o){const m=Array.isArray(l.permissions)?l.permissions.filter(c=>x===""||c.name&&c.name.toLowerCase().includes(x.toLowerCase())||c.display_name&&c.display_name.toLowerCase().includes(x.toLowerCase())):[];e=[...e,...m]}}),e},[i,x,j]);const Ge=n.useMemo(()=>{if(!i||typeof i!="object")return{};const e={};return Object.entries(i).forEach(([o,l])=>{if(j==="all"||j===o){const m=Array.isArray(l.permissions)?l.permissions.filter(c=>x===""||c.name&&c.name.toLowerCase().includes(x.toLowerCase())||c.display_name&&c.display_name.toLowerCase().includes(x.toLowerCase())):[];m.length>0&&(e[o]={...l,permissions:m})}}),e},[i,x,j]),Ee=n.useMemo(()=>!i||typeof i!="object"?[]:Object.keys(i).sort(),[i]),le=n.useCallback(e=>Array.isArray(w)?w.filter(o=>o&&o.role_id===e).map(o=>o.permission_id).filter(Boolean):[],[w]),I=(e,o)=>{if(!Array.isArray(w)||!Array.isArray(N))return!1;const l=w.filter(c=>c&&c.role_id===e),m=N.find(c=>c&&c.name===o);return m&&l.some(c=>c.permission_id===m.id)};n.useCallback(e=>!d||!i[e]?!1:i[e].permissions.every(l=>I(d.id,l.name)),[d,i,I]),n.useCallback(e=>!d||!i[e]?!1:i[e].permissions.some(l=>I(d.id,l.name)),[d,i,I]);const Ie=e=>e.name==="Super Administrator"?h:!0,Le=n.useCallback(e=>{D(e);const o=w.filter(l=>l.role_id===e).map(l=>l.permission_id);F(new Set(o))},[w]),We=n.useCallback(e=>{xe(e)},[]),ze=n.useCallback(e=>{ye(e)},[]),Oe=n.useCallback(()=>{O(!0)},[]),ve=n.useCallback(()=>{O(!1),U(null),H({name:"",description:"",permissions:[],hierarchy_level:10})},[]),we=n.useCallback(async e=>{var o,l;if(!(!d||A)){S(!0);try{const m=I(d.id,e),c=m?"revoke":"grant";if(console.log(`Toggling permission: ${e}, action: ${c}, role: ${d.name}`),(await oe.post("/admin/roles/update-permission",{role_id:d.id,permission:e,action:c})).status===200){const p=N.find(k=>k.name===e);p&&(m?(E(k=>k.filter(g=>!(g.role_id===d.id&&g.permission_id===p.id))),F(k=>{const g=new Set(k);return g.delete(p.id),g})):(E(k=>[...k,{role_id:d.id,permission_id:p.id}]),F(k=>new Set([...k,p.id])))),T.success(`Permission ${c}ed successfully`)}}catch(m){console.error("Error updating permission:",m),T.error(((l=(o=m.response)==null?void 0:o.data)==null?void 0:l.message)||"Failed to update permission")}finally{S(!1)}}},[d,A,I,N,E,F]),Ue=n.useCallback(async e=>{var o,l;if(!(!d||A)){S(!0);try{console.log(`Toggling module permissions for: ${e}, role: ${d.name}`);const m=await oe.post("/admin/roles/update-module",{roleId:d.id,module:e,action:"toggle"});if(m.status===200){E(m.data.role_has_permissions);const c=m.data.role_has_permissions.filter(C=>C.role_id===d.id).map(C=>C.permission_id);F(new Set(c)),T.success("Module permissions updated successfully")}}catch(m){console.error("Error updating module permissions:",m),T.error(((l=(o=m.response)==null?void 0:o.data)==null?void 0:l.message)||"Failed to update module permissions")}finally{S(!1)}}},[d,A]),Ve=async()=>{var e,o;S(!0);try{const l=P?`/admin/roles/${P.id}`:"/admin/roles",c=await oe[P?"put":"post"](l,re);c.status===200&&(P?($(C=>C.map(p=>p.id===P.id?c.data.role:p)),T.success("Role updated successfully")):($(C=>[...C,c.data.role]),T.success("Role created successfully")),O(!1),U(null),H({name:"",description:"",permissions:[],hierarchy_level:10}))}catch(l){console.error("Error saving role:",l),T.error(((o=(e=l.response)==null?void 0:e.data)==null?void 0:o.message)||"Failed to save role")}finally{S(!1)}},He=async()=>{var e,o;if(B){S(!0);try{(await oe.delete(`/admin/roles/${B.id}`)).status===200&&($(m=>m.filter(c=>c.id!==B.id)),b===B.id&&D(v.length>1?v[0].id:null),T.success("Role deleted successfully"))}catch(l){console.error("Error deleting role:",l),T.error(((o=(e=l.response)==null?void 0:e.data)==null?void 0:o.message)||"Failed to delete role")}finally{S(!1),V(!1),ee(null)}}},qe=e=>{U(e),H({name:e.name,description:e.description||"",permissions:le(e.id),hierarchy_level:e.hierarchy_level||10}),O(!0)},Qe=e=>{ee(e),V(!0)};return t(Ce,{children:[s(Je,{title:M}),Z&&t(Pe,{open:Z,onClose:ve,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{background:"rgba(255, 255, 255, 0.1)",backdropFilter:"blur(20px)",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"24px"}},children:[s($e,{children:t(de,{sx:{display:"flex",alignItems:"center",gap:2},children:[s(_e,{className:"w-6 h-6"}),P?"Edit Role":"Create New Role"]})}),s(ke,{children:t(ae,{container:!0,spacing:3,sx:{mt:1},children:[s(ae,{item:!0,xs:12,sm:6,children:s(me,{fullWidth:!0,label:"Role Name",value:re.name,onChange:e=>H(o=>({...o,name:e.target.value})),required:!0})}),t(ae,{item:!0,xs:12,sm:6,children:["                                ",s(me,{fullWidth:!0,label:"Hierarchy Level",type:"number",value:re.hierarchy_level,onChange:e=>H(o=>({...o,hierarchy_level:parseInt(e.target.value)})),helperText:"Role priority level (1-50, lower numbers = higher priority)",inputProps:{min:1,max:50},disabled:!h})]}),s(ae,{item:!0,xs:12,children:s(me,{fullWidth:!0,label:"Description",multiline:!0,rows:3,value:re.description,onChange:e=>H(o=>({...o,description:e.target.value}))})})]})}),t(Me,{sx:{p:3},children:[s(Fe,{onClick:ve,children:"Cancel"}),s(je,{variant:"contained",onClick:Ve,loading:A,sx:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)","&:hover":{background:"linear-gradient(135deg, #5a67d8 0%, #6b46c1 100%)"}},children:P?"Update Role":"Create Role"})]})]}),K&&t(Pe,{open:K,onClose:()=>V(!1),PaperProps:{sx:{background:"rgba(255, 255, 255, 0.1)",backdropFilter:"blur(20px)",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"24px"}},children:[s($e,{children:t(de,{sx:{display:"flex",alignItems:"center",gap:2},children:[s(pr,{className:"w-6 h-6 text-red-500"}),"Confirm Delete"]})}),s(ke,{children:t(R,{children:['Are you sure you want to delete the role "',B==null?void 0:B.name,'"? This action cannot be undone.']})}),t(Me,{sx:{p:3},children:[s(Fe,{onClick:()=>V(!1),children:"Cancel"}),s(je,{variant:"contained",color:"error",onClick:He,loading:A,children:"Delete Role"})]})]}),s(de,{sx:{display:"flex",justifyContent:"center",p:2},children:s(or,{in:!0,children:s(ar,{children:t(dr,{title:"Role Management",subtitle:"Manage roles, permissions, and access control",icon:s(yr,{className:"w-8 h-8"}),variant:"default",actionButtons:[{label:"Create Role",icon:s(_e,{className:"w-4 h-4"}),onPress:Oe,className:"bg-gradient-to-r from-[rgba(var(--theme-primary-rgb),0.2)] to-[rgba(var(--theme-secondary-rgb),0.2)] hover:from-[rgba(var(--theme-primary-rgb),0.3)] hover:to-[rgba(var(--theme-secondary-rgb),0.3)] border border-[rgba(var(--theme-primary-rgb),0.3)]"},{label:"Export",icon:s(xr,{className:"w-4 h-4"}),variant:"bordered",className:"border-[rgba(var(--theme-success-rgb),0.3)] bg-[rgba(var(--theme-success-rgb),0.05)] hover:bg-[rgba(var(--theme-success-rgb),0.1)]"}],children:["                                ",t("div",{className:"p-6",children:[s(mr,{stats:Te}),s(Se,{in:!0,timeout:1200,children:s("div",{className:"mb-6",children:t("div",{className:"flex flex-col gap-4",children:[t("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-end",children:[s("div",{className:"w-full sm:flex-1",children:s(tr,{label:"Search Permissions",variant:"bordered",placeholder:"Search permissions by name or module...",value:x,onValueChange:We,startContent:s(nr,{className:"w-4 h-4"}),classNames:{input:"bg-transparent",inputWrapper:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15"},size:G?"sm":"md"})}),s("div",{className:"flex gap-2 w-full sm:w-auto",children:s("div",{className:"flex-1 sm:min-w-[150px]",children:t("select",{className:"w-full px-3 py-2 bg-white/10 backdrop-blur-md border border-white/20 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",value:j,onChange:e=>ze(e.target.value),children:[s("option",{value:"all",children:"All Modules"}),Ee.map(e=>s("option",{value:e,children:e},e))]})})})]}),(x||j!=="all")&&t("div",{className:"flex flex-wrap gap-2",children:[x&&t(te,{variant:"flat",color:"primary",size:"sm",onClose:()=>xe(""),children:["Search: ",x]}),j!=="all"&&t(te,{variant:"flat",color:"secondary",size:"sm",onClose:()=>ye("all"),children:["Module: ",j]})]})]})})}),s(Se,{in:!0,timeout:1400,children:t("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[s("div",{className:"lg:col-span-1",children:t("div",{className:"bg-white/10 backdrop-blur-md border border-white/20 rounded-lg p-4",children:[s("div",{className:"flex items-center justify-between mb-4",children:t(R,{variant:"h6",className:"font-bold flex items-center gap-2",children:[s(ce,{className:"w-5 h-5"}),"Roles (",v.length,")"]})}),s("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:v.map(e=>s("div",{className:`p-3 rounded-lg border transition-all duration-200 cursor-pointer ${b===e.id?"bg-gradient-to-r from-blue-500/20 to-purple-500/20 border-blue-400/50":"bg-white/5 border-white/10 hover:bg-white/10"}`,onClick:()=>Le(e.id),children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center gap-3",children:[s("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-white font-bold text-sm ${b===e.id?"bg-gradient-to-r from-blue-500 to-purple-500":"bg-gray-500"}`,children:e.name.charAt(0).toUpperCase()}),t("div",{children:[s(R,{variant:"body2",className:"font-medium",children:e.name}),t(R,{variant:"caption",color:"textSecondary",children:[le(e.id).length," permissions"]}),e.name==="Super Administrator"&&s(te,{label:"System",size:"sm",className:"ml-1"})]})]}),Ie(e)&&t("div",{className:"flex gap-1",children:[s(Ae,{size:"small",onClick:o=>{o.stopPropagation(),qe(e)},className:"text-gray-400 hover:text-blue-400",children:s(gr,{className:"w-4 h-4"})}),s(Ae,{size:"small",onClick:o=>{o.stopPropagation(),Qe(e)},className:"text-gray-400 hover:text-red-400",children:s(br,{className:"w-4 h-4"})})]})]})},e.id))})]})}),s("div",{className:"lg:col-span-2",children:s("div",{className:"bg-white/10 backdrop-blur-md border border-white/20 rounded-lg p-4",children:d?t(Ce,{children:[t("div",{className:"flex items-center justify-between mb-4",children:[t(R,{variant:"h6",className:"font-bold flex items-center gap-2",children:[s(Ne,{className:"w-5 h-5"}),d.name," Permissions"]}),s(te,{label:`${f.size} granted`,color:"primary",variant:"flat"})]}),"                                                        ",s("div",{className:"max-h-96 overflow-y-auto space-y-3",children:Object.entries(Ge).map(([e,o])=>{const l=o.permissions,m=l.filter(g=>I(d.id,g.name)).length,c=l.length,C=m===c,p=m>0,k=c>0?Math.round(m/c*100):0;return t(Nr,{sx:{background:p?"linear-gradient(135deg, rgba(102, 126, 234, 0.15), rgba(168, 85, 247, 0.15))":"rgba(255, 255, 255, 0.05)",border:p?"1px solid rgba(102, 126, 234, 0.3)":"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"16px !important","&:before":{display:"none"},"&.Mui-expanded":{background:p?"linear-gradient(135deg, rgba(102, 126, 234, 0.25), rgba(168, 85, 247, 0.25))":"rgba(255, 255, 255, 0.08)",borderColor:p?"rgba(102, 126, 234, 0.5)":"rgba(255, 255, 255, 0.2)"},"&:hover":{background:p?"linear-gradient(135deg, rgba(102, 126, 234, 0.2), rgba(168, 85, 247, 0.2))":"rgba(255, 255, 255, 0.08)"}},children:[s(Tr,{expandIcon:s(Xe,{className:"w-5 h-5 text-gray-400"}),sx:{borderRadius:"16px","&.Mui-expanded":{borderRadius:"16px 16px 0 0"},minHeight:"64px","& .MuiAccordionSummary-content":{margin:"12px 0",alignItems:"center"}},children:t("div",{className:"flex items-center justify-between w-full mr-4",children:[t("div",{className:"flex items-center gap-3",children:[t("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center font-bold text-sm ${C?"bg-gradient-to-r from-green-500 to-emerald-500 text-white":p?"bg-gradient-to-r from-orange-500 to-amber-500 text-white":"bg-gray-500/20 text-gray-400"}`,children:[k,"%"]}),"                                                                        ",t("div",{children:[s(R,{variant:"subtitle1",className:"font-semibold text-white",children:o.name}),s(R,{variant:"caption",color:"textSecondary",className:"block",children:o.description}),s("div",{className:"flex items-center gap-2 mt-1",children:t(R,{variant:"caption",color:"textSecondary",children:[m," of ",c," permissions granted"]})})]})]}),t("div",{className:"flex items-center gap-2",children:[t("div",{className:"text-right mr-2",children:[s(R,{variant:"caption",color:"textSecondary",className:"block",children:"Module Toggle"}),s("div",{className:`px-2 py-1 rounded-full text-xs font-medium ${C?"bg-green-500/20 text-green-400 border border-green-500/30":p?"bg-orange-500/20 text-orange-400 border border-orange-500/30":"bg-gray-500/20 text-gray-400 border border-gray-500/30"}`,children:C?"Full Access":p?"Partial":"No Access"})]}),"                                                                                    ",s(ir,{checked:C,onChange:g=>{g.stopPropagation(),Ue(e)},disabled:A||(d==null?void 0:d.name)==="Super Administrator"&&!h,sx:{"& .MuiSwitch-switchBase.Mui-checked":{color:"#10b981","&:hover":{backgroundColor:"rgba(16, 185, 129, 0.08)"}},"& .MuiSwitch-switchBase.Mui-checked + .MuiSwitch-track":{backgroundColor:"#10b981"},"& .MuiSwitch-track":{backgroundColor:p?"#f59e0b":"#6b7280"}}})]})]})}),"                                                                        ",s(Mr,{sx:{pt:0,pb:3,px:3},children:s("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:l.map(g=>{const J=I(d.id,g.name),se=A||(d==null?void 0:d.name)==="Super Administrator"&&!h;return s("div",{className:`p-3 border rounded-xl transition-all duration-200 ${se?"cursor-not-allowed opacity-50":"cursor-pointer hover:bg-white/5"} ${J?"bg-gradient-to-r from-green-500/10 to-emerald-500/10 border-green-500/30":"bg-white/5 border-white/10 hover:border-white/20"}`,onClick:X=>{X.preventDefault(),X.stopPropagation(),se||we(g.name)},children:s(lr,{control:s(fr,{checked:J,onChange:X=>{X.preventDefault(),X.stopPropagation(),se||we(g.name)},disabled:se,sx:{color:J?"#10b981":"rgba(255, 255, 255, 0.5)","&.Mui-checked":{color:"#10b981"},"&:hover":{backgroundColor:"rgba(16, 185, 129, 0.08)"}}}),label:t("div",{children:[s(R,{variant:"body2",className:`font-medium ${J?"text-green-400":"text-white"}`,children:g.display_name||g.name}),s(R,{variant:"caption",className:`${J?"text-green-300/70":"text-gray-400"}`,children:g.name})]}),className:"m-0 w-full pointer-events-none"})},g.id)})})})]},e)})})]}):t("div",{className:"flex flex-col items-center justify-center h-48 text-center",children:[s(ce,{className:"w-16 h-16 text-gray-400 mb-4"}),s(R,{variant:"h6",color:"textSecondary",children:"Select a role to manage permissions"}),s(R,{variant:"body2",color:"textSecondary",children:"Choose a role from the left panel to view and edit its permissions                                                        "}),"                                                    "]})})})]})})]})]})})})})]})};Gr.layout=r=>s(cr,{children:r});export{Gr as default};
