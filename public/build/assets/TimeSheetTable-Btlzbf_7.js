import{J as Me,r as w,g as V,b as d,a as m,c as ze,F as oe,h as je,i as Ee,R as Dt,o as Ht}from"./app-7C8yzGUT.js";import{u as Wt,e as Be,T as C,B as y,W as Ye,f as ee,L as D,G as j,b as Tt,ae as ce,N as fe,af as ue,d as _t,ag as $e,a0 as Rt,ah as At}from"./App-BPljQ4ZR.js";import{d as E}from"./dayjs.min-DLo7znBL.js";import"./jspdf.es.min-DWCHb_zN.js";import{P as Lt}from"./PageHeader-B5qyshpe.js";import{F as Y}from"./ExclamationTriangleIcon-Dk0kyqho.js";import{F as ge}from"./UserIcon-DOBsR4P-.js";import{C as Mt}from"./CardHeader-CgY6h61i.js";import{F as Ie}from"./DocumentArrowDownIcon-DOPy0xDX.js";import{F as $}from"./CheckCircleIcon-CIq74OkB.js";import{C as Ue}from"./CardContent-DlsQ11AJ.js";import{B as zt}from"./Button-KGg5DnXK.js";import{F as jt}from"./XCircleIcon-DFqbgOJQ.js";import{s as Oe}from"./chunk-TLYTI3QM-DXd80jrt.js";import{t as Ke,a as Ge,b as Je,c as qe,d as Qe,e as T}from"./chunk-F3UDT23P-BtMFFGIi.js";import{p as Xe}from"./chunk-O5I3QTYU-DUv51jMX.js";import{u as Et}from"./chunk-R6AK6OQ4-pVdrT5Jg.js";import"./app-DyxkPZ-W.js";import"./useHasTabbableChild-DzS1swvo.js";import"./chunk-7F3ZLNJ6-66BTlKbX.js";import"./index-CokAva9Y.js";function it(t,e,a,r,n){r=r||{};var i=1.15,l=n.internal.scaleFactor,s=n.internal.getFontSize()/l,h=n.getLineHeightFactor?n.getLineHeightFactor():i,o=s*h,c=/\r\n|\r|\n/g,u="",g=1;if((r.valign==="middle"||r.valign==="bottom"||r.halign==="center"||r.halign==="right")&&(u=typeof t=="string"?t.split(c):t,g=u.length||1),a+=s*(2-i),r.valign==="middle"?a-=g/2*o:r.valign==="bottom"&&(a-=g*o),r.halign==="center"||r.halign==="right"){var p=s;if(r.halign==="center"&&(p*=.5),u&&g>=1){for(var v=0;v<u.length;v++)n.text(u[v],e-n.getStringUnitWidth(u[v])*p,a),a+=o;return n}e-=n.getStringUnitWidth(t)*p}return r.halign==="justify"?n.text(t,e,a,{maxWidth:r.maxWidth||100,align:"justify"}):n.text(t,e,a),n}var Ze={},I=function(){function t(e){this.jsPDFDocument=e,this.userStyles={textColor:e.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:e.internal.getFontSize(),fontStyle:e.internal.getFont().fontStyle,font:e.internal.getFont().fontName,lineWidth:e.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:e.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return t.setDefaults=function(e,a){a===void 0&&(a=null),a?a.__autoTableDocumentDefaults=e:Ze=e},t.unifyColor=function(e){return Array.isArray(e)?e:typeof e=="number"?[e,e,e]:typeof e=="string"?[e]:null},t.prototype.applyStyles=function(e,a){var r,n,i;a===void 0&&(a=!1),e.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(e.fontStyle);var l=this.jsPDFDocument.internal.getFont(),s=l.fontStyle,h=l.fontName;if(e.font&&(h=e.font),e.fontStyle){s=e.fontStyle;var o=this.getFontList()[h];o&&o.indexOf(s)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(o[0]),s=o[0])}if(this.jsPDFDocument.setFont(h,s),e.fontSize&&this.jsPDFDocument.setFontSize(e.fontSize),!a){var c=t.unifyColor(e.fillColor);c&&(r=this.jsPDFDocument).setFillColor.apply(r,c),c=t.unifyColor(e.textColor),c&&(n=this.jsPDFDocument).setTextColor.apply(n,c),c=t.unifyColor(e.lineColor),c&&(i=this.jsPDFDocument).setDrawColor.apply(i,c),typeof e.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(e.lineWidth)}},t.prototype.splitTextToSize=function(e,a,r){return this.jsPDFDocument.splitTextToSize(e,a,r)},t.prototype.rect=function(e,a,r,n,i){return this.jsPDFDocument.rect(e,a,r,n,i)},t.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},t.prototype.getTextWidth=function(e){return this.jsPDFDocument.getTextWidth(e)},t.prototype.getDocument=function(){return this.jsPDFDocument},t.prototype.setPage=function(e){this.jsPDFDocument.setPage(e)},t.prototype.addPage=function(){return this.jsPDFDocument.addPage()},t.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},t.prototype.getGlobalOptions=function(){return Ze||{}},t.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},t.prototype.pageSize=function(){var e=this.jsPDFDocument.internal.pageSize;return e.width==null&&(e={width:e.getWidth(),height:e.getHeight()}),e},t.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},t.prototype.getLineHeightFactor=function(){var e=this.jsPDFDocument;return e.getLineHeightFactor?e.getLineHeightFactor():1.15},t.prototype.getLineHeight=function(e){return e/this.scaleFactor()*this.getLineHeightFactor()},t.prototype.pageNumber=function(){var e=this.jsPDFDocument.internal.getCurrentPageInfo();return e?e.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},t}(),me=function(t,e){return me=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,r){a.__proto__=r}||function(a,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(a[n]=r[n])},me(t,e)};function ot(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");me(t,e);function a(){this.constructor=t}t.prototype=e===null?Object.create(e):(a.prototype=e.prototype,new a)}var st=function(t){ot(e,t);function e(a){var r=t.call(this)||this;return r._element=a,r}return e}(Array);function Bt(t){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/t,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function Yt(t){var e={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return e[t]}function te(t,e,a){a.applyStyles(e,!0);var r=Array.isArray(t)?t:[t],n=r.map(function(i){return a.getTextWidth(i)}).reduce(function(i,l){return Math.max(i,l)},0);return n}function lt(t,e,a,r){var n=e.settings.tableLineWidth,i=e.settings.tableLineColor;t.applyStyles({lineWidth:n,lineColor:i});var l=ht(n,!1);l&&t.rect(a.x,a.y,e.getWidth(t.pageSize().width),r.y-a.y,l)}function ht(t,e){var a=t>0,r=e||e===0;return a&&r?"DF":a?"S":r?"F":null}function ae(t,e){var a,r,n,i;if(t=t||e,Array.isArray(t)){if(t.length>=4)return{top:t[0],right:t[1],bottom:t[2],left:t[3]};if(t.length===3)return{top:t[0],right:t[1],bottom:t[2],left:t[1]};if(t.length===2)return{top:t[0],right:t[1],bottom:t[0],left:t[1]};t.length===1?t=t[0]:t=e}return typeof t=="object"?(typeof t.vertical=="number"&&(t.top=t.vertical,t.bottom=t.vertical),typeof t.horizontal=="number"&&(t.right=t.horizontal,t.left=t.horizontal),{left:(a=t.left)!==null&&a!==void 0?a:e,top:(r=t.top)!==null&&r!==void 0?r:e,right:(n=t.right)!==null&&n!==void 0?n:e,bottom:(i=t.bottom)!==null&&i!==void 0?i:e}):(typeof t!="number"&&(t=e),{top:t,right:t,bottom:t,left:t})}function dt(t,e){var a=ae(e.settings.margin,0);return t.pageSize().width-(a.left+a.right)}function $t(t,e,a,r,n){var i={},l=1.3333333333333333,s=se(e,function(k){return n.getComputedStyle(k).backgroundColor});s!=null&&(i.fillColor=s);var h=se(e,function(k){return n.getComputedStyle(k).color});h!=null&&(i.textColor=h);var o=Ut(r,a);o&&(i.cellPadding=o);var c="borderTopColor",u=l*a,g=r.borderTopWidth;if(r.borderBottomWidth===g&&r.borderRightWidth===g&&r.borderLeftWidth===g){var p=(parseFloat(g)||0)/u;p&&(i.lineWidth=p)}else i.lineWidth={top:(parseFloat(r.borderTopWidth)||0)/u,right:(parseFloat(r.borderRightWidth)||0)/u,bottom:(parseFloat(r.borderBottomWidth)||0)/u,left:(parseFloat(r.borderLeftWidth)||0)/u},i.lineWidth.top||(i.lineWidth.right?c="borderRightColor":i.lineWidth.bottom?c="borderBottomColor":i.lineWidth.left&&(c="borderLeftColor"));var v=se(e,function(k){return n.getComputedStyle(k)[c]});v!=null&&(i.lineColor=v);var P=["left","right","center","justify"];P.indexOf(r.textAlign)!==-1&&(i.halign=r.textAlign),P=["middle","bottom","top"],P.indexOf(r.verticalAlign)!==-1&&(i.valign=r.verticalAlign);var b=parseInt(r.fontSize||"");isNaN(b)||(i.fontSize=b/l);var S=It(r);S&&(i.fontStyle=S);var F=(r.fontFamily||"").toLowerCase();return t.indexOf(F)!==-1&&(i.font=F),i}function It(t){var e="";return(t.fontWeight==="bold"||t.fontWeight==="bolder"||parseInt(t.fontWeight)>=700)&&(e="bold"),(t.fontStyle==="italic"||t.fontStyle==="oblique")&&(e+="italic"),e}function se(t,e){var a=ct(t,e);if(!a)return null;var r=a.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!r||!Array.isArray(r))return null;var n=[parseInt(r[1]),parseInt(r[2]),parseInt(r[3])],i=parseInt(r[4]);return i===0||isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:n}function ct(t,e){var a=e(t);return a==="rgba(0, 0, 0, 0)"||a==="transparent"||a==="initial"||a==="inherit"?t.parentElement==null?null:ct(t.parentElement,e):a}function Ut(t,e){var a=[t.paddingTop,t.paddingRight,t.paddingBottom,t.paddingLeft],r=96/(72/e),n=(parseInt(t.lineHeight)-parseInt(t.fontSize))/e/2,i=a.map(function(s){return parseInt(s||"0")/r}),l=ae(i,0);return n>l.top&&(l.top=n),n>l.bottom&&(l.bottom=n),l}function ft(t,e,a,r,n){var i,l;r===void 0&&(r=!1),n===void 0&&(n=!1);var s;typeof e=="string"?s=a.document.querySelector(e):s=e;var h=Object.keys(t.getFontList()),o=t.scaleFactor(),c=[],u=[],g=[];if(!s)return console.error("Html table could not be found with input: ",e),{head:c,body:u,foot:g};for(var p=0;p<s.rows.length;p++){var v=s.rows[p],P=(l=(i=v==null?void 0:v.parentElement)===null||i===void 0?void 0:i.tagName)===null||l===void 0?void 0:l.toLowerCase(),b=Ot(h,o,a,v,r,n);b&&(P==="thead"?c.push(b):P==="tfoot"?g.push(b):u.push(b))}return{head:c,body:u,foot:g}}function Ot(t,e,a,r,n,i){for(var l=new st(r),s=0;s<r.cells.length;s++){var h=r.cells[s],o=a.getComputedStyle(h);if(n||o.display!=="none"){var c=void 0;i&&(c=$t(t,h,e,o,a)),l.push({rowSpan:h.rowSpan,colSpan:h.colSpan,styles:c,_element:h,content:Kt(h)})}}var u=a.getComputedStyle(r);if(l.length>0&&(n||u.display!=="none"))return l}function Kt(t){var e=t.cloneNode(!0);return e.innerHTML=e.innerHTML.replace(/\n/g,"").replace(/ +/g," "),e.innerHTML=e.innerHTML.split(/<br.*?>/).map(function(a){return a.trim()}).join(`
`),e.innerText||e.textContent||""}function Gt(t,e,a){for(var r=0,n=[t,e,a];r<n.length;r++){var i=n[r];i&&typeof i!="object"&&console.error("The options parameter should be of type object, is: "+typeof i),i.startY&&typeof i.startY!="number"&&(console.error("Invalid value for startY option",i.startY),delete i.startY)}}function A(t,e,a,r,n){if(t==null)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(t),l=1;l<arguments.length;l++){var s=arguments[l];if(s!=null)for(var h in s)Object.prototype.hasOwnProperty.call(s,h)&&(i[h]=s[h])}return i}function Jt(t,e){var a=new I(t),r=a.getDocumentOptions(),n=a.getGlobalOptions();Gt(n,r,e);var i=A({},n,r,e),l;typeof window<"u"&&(l=window);var s=qt(n,r,e),h=Qt(n,r,e),o=Xt(a,i),c=Vt(a,i,l);return{id:e.tableId,content:c,hooks:h,styles:s,settings:o}}function qt(t,e,a){for(var r={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},n=function(h){if(h==="columnStyles"){var o=t[h],c=e[h],u=a[h];r.columnStyles=A({},o,c,u)}else{var g=[t,e,a],p=g.map(function(v){return v[h]||{}});r[h]=A({},p[0],p[1],p[2])}},i=0,l=Object.keys(r);i<l.length;i++){var s=l[i];n(s)}return r}function Qt(t,e,a){for(var r=[t,e,a],n={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},i=0,l=r;i<l.length;i++){var s=l[i];s.didParseCell&&n.didParseCell.push(s.didParseCell),s.willDrawCell&&n.willDrawCell.push(s.willDrawCell),s.didDrawCell&&n.didDrawCell.push(s.didDrawCell),s.willDrawPage&&n.willDrawPage.push(s.willDrawPage),s.didDrawPage&&n.didDrawPage.push(s.didDrawPage)}return n}function Xt(t,e){var a,r,n,i,l,s,h,o,c,u,g,p,v=ae(e.margin,40/t.scaleFactor()),P=(a=Zt(t,e.startY))!==null&&a!==void 0?a:v.top,b;e.showFoot===!0?b="everyPage":e.showFoot===!1?b="never":b=(r=e.showFoot)!==null&&r!==void 0?r:"everyPage";var S;e.showHead===!0?S="everyPage":e.showHead===!1?S="never":S=(n=e.showHead)!==null&&n!==void 0?n:"everyPage";var F=(i=e.useCss)!==null&&i!==void 0?i:!1,k=e.theme||(F?"plain":"striped"),H=!!e.horizontalPageBreak,M=(l=e.horizontalPageBreakRepeat)!==null&&l!==void 0?l:null;return{includeHiddenHtml:(s=e.includeHiddenHtml)!==null&&s!==void 0?s:!1,useCss:F,theme:k,startY:P,margin:v,pageBreak:(h=e.pageBreak)!==null&&h!==void 0?h:"auto",rowPageBreak:(o=e.rowPageBreak)!==null&&o!==void 0?o:"auto",tableWidth:(c=e.tableWidth)!==null&&c!==void 0?c:"auto",showHead:S,showFoot:b,tableLineWidth:(u=e.tableLineWidth)!==null&&u!==void 0?u:0,tableLineColor:(g=e.tableLineColor)!==null&&g!==void 0?g:200,horizontalPageBreak:H,horizontalPageBreakRepeat:M,horizontalPageBreakBehaviour:(p=e.horizontalPageBreakBehaviour)!==null&&p!==void 0?p:"afterAllRows"}}function Zt(t,e){var a=t.getLastAutoTable(),r=t.scaleFactor(),n=t.pageNumber(),i=!1;if(a&&a.startPageNumber){var l=a.startPageNumber+a.pageNumber-1;i=l===n}return typeof e=="number"?e:(e==null||e===!1)&&i&&(a==null?void 0:a.finalY)!=null?a.finalY+20/r:null}function Vt(t,e,a){var r=e.head||[],n=e.body||[],i=e.foot||[];if(e.html){var l=e.includeHiddenHtml;if(a){var s=ft(t,e.html,a,l,e.useCss)||{};r=s.head||r,n=s.body||r,i=s.foot||r}else console.error("Cannot parse html in non browser environment")}var h=e.columns||er(r,n,i);return{columns:h,head:r,body:n,foot:i}}function er(t,e,a){var r=t[0]||e[0]||a[0]||[],n=[];return Object.keys(r).filter(function(i){return i!=="_element"}).forEach(function(i){var l=1,s;Array.isArray(r)?s=r[parseInt(i)]:s=r[i],typeof s=="object"&&!Array.isArray(s)&&(l=(s==null?void 0:s.colSpan)||1);for(var h=0;h<l;h++){var o=void 0;Array.isArray(r)?o=n.length:o=i+(h>0?"_".concat(h):"");var c={dataKey:o};n.push(c)}}),n}var pe=function(){function t(e,a,r){this.table=a,this.pageNumber=a.pageNumber,this.settings=a.settings,this.cursor=r,this.doc=e.getDocument()}return t}(),tr=function(t){ot(e,t);function e(a,r,n,i,l,s){var h=t.call(this,a,r,s)||this;return h.cell=n,h.row=i,h.column=l,h.section=i.section,h}return e}(pe),rr=function(){function t(e,a){this.pageNumber=1,this.id=e.id,this.settings=e.settings,this.styles=e.styles,this.hooks=e.hooks,this.columns=a.columns,this.head=a.head,this.body=a.body,this.foot=a.foot}return t.prototype.getHeadHeight=function(e){return this.head.reduce(function(a,r){return a+r.getMaxCellHeight(e)},0)},t.prototype.getFootHeight=function(e){return this.foot.reduce(function(a,r){return a+r.getMaxCellHeight(e)},0)},t.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},t.prototype.callCellHooks=function(e,a,r,n,i,l){for(var s=0,h=a;s<h.length;s++){var o=h[s],c=new tr(e,this,r,n,i,l),u=o(c)===!1;if(r.text=Array.isArray(r.text)?r.text:[r.text],u)return!1}return!0},t.prototype.callEndPageHooks=function(e,a){e.applyStyles(e.userStyles);for(var r=0,n=this.hooks.didDrawPage;r<n.length;r++){var i=n[r];i(new pe(e,this,a))}},t.prototype.callWillDrawPageHooks=function(e,a){for(var r=0,n=this.hooks.willDrawPage;r<n.length;r++){var i=n[r];i(new pe(e,this,a))}},t.prototype.getWidth=function(e){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var a=this.columns.reduce(function(n,i){return n+i.wrappedWidth},0);return a}else{var r=this.settings.margin;return e-r.left-r.right}},t}(),ut=function(){function t(e,a,r,n,i){i===void 0&&(i=!1),this.height=0,this.raw=e,e instanceof st&&(this.raw=e._element,this.element=e._element),this.index=a,this.section=r,this.cells=n,this.spansMultiplePages=i}return t.prototype.getMaxCellHeight=function(e){var a=this;return e.reduce(function(r,n){var i;return Math.max(r,((i=a.cells[n.index])===null||i===void 0?void 0:i.height)||0)},0)},t.prototype.hasRowSpan=function(e){var a=this;return e.filter(function(r){var n=a.cells[r.index];return n?n.rowSpan>1:!1}).length>0},t.prototype.canEntireRowFit=function(e,a){return this.getMaxCellHeight(a)<=e},t.prototype.getMinimumRowHeight=function(e,a){var r=this;return e.reduce(function(n,i){var l=r.cells[i.index];if(!l)return 0;var s=a.getLineHeight(l.styles.fontSize),h=l.padding("vertical"),o=h+s;return o>n?o:n},0)},t}(),gt=function(){function t(e,a,r){var n;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=a,this.section=r,this.raw=e;var i=e;e!=null&&typeof e=="object"&&!Array.isArray(e)?(this.rowSpan=e.rowSpan||1,this.colSpan=e.colSpan||1,i=(n=e.content)!==null&&n!==void 0?n:e,e._element&&(this.raw=e._element)):(this.rowSpan=1,this.colSpan=1);var l=i!=null?""+i:"",s=/\r\n|\r|\n/g;this.text=l.split(s)}return t.prototype.getTextPos=function(){var e;if(this.styles.valign==="top")e=this.y+this.padding("top");else if(this.styles.valign==="bottom")e=this.y+this.height-this.padding("bottom");else{var a=this.height-this.padding("vertical");e=this.y+a/2+this.padding("top")}var r;if(this.styles.halign==="right")r=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var n=this.width-this.padding("horizontal");r=this.x+n/2+this.padding("left")}else r=this.x+this.padding("left");return{x:r,y:e}},t.prototype.getContentHeight=function(e,a){a===void 0&&(a=1.15);var r=Array.isArray(this.text)?this.text.length:1,n=this.styles.fontSize/e*a,i=r*n+this.padding("vertical");return Math.max(i,this.styles.minCellHeight)},t.prototype.padding=function(e){var a=ae(this.styles.cellPadding,0);return e==="vertical"?a.top+a.bottom:e==="horizontal"?a.left+a.right:a[e]},t}(),ar=function(){function t(e,a,r){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=e,this.raw=a,this.index=r}return t.prototype.getMaxCustomCellWidth=function(e){for(var a=0,r=0,n=e.allRows();r<n.length;r++){var i=n[r],l=i.cells[this.index];l&&typeof l.styles.cellWidth=="number"&&(a=Math.max(a,l.styles.cellWidth))}return a},t}();function nr(t,e){ir(t,e);var a=[],r=0;e.columns.forEach(function(i){var l=i.getMaxCustomCellWidth(e);l?i.width=l:(i.width=i.wrappedWidth,a.push(i)),r+=i.width});var n=e.getWidth(t.pageSize().width)-r;n&&(n=ve(a,n,function(i){return Math.max(i.minReadableWidth,i.minWidth)})),n&&(n=ve(a,n,function(i){return i.minWidth})),n=Math.abs(n),!e.settings.horizontalPageBreak&&n>.1/t.scaleFactor()&&(n=n<1?n:Math.round(n),console.warn("Of the table content, ".concat(n," units width could not fit page"))),sr(e),lr(e,t),or(e)}function ir(t,e){var a=t.scaleFactor(),r=e.settings.horizontalPageBreak,n=dt(t,e);e.allRows().forEach(function(i){for(var l=0,s=e.columns;l<s.length;l++){var h=s[l],o=i.cells[h.index];if(o){var c=e.hooks.didParseCell;e.callCellHooks(t,c,o,i,h,null);var u=o.padding("horizontal");o.contentWidth=te(o.text,o.styles,t)+u;var g=te(o.text.join(" ").split(/[^\S\u00A0]+/),o.styles,t);if(o.minReadableWidth=g+o.padding("horizontal"),typeof o.styles.cellWidth=="number")o.minWidth=o.styles.cellWidth,o.wrappedWidth=o.styles.cellWidth;else if(o.styles.cellWidth==="wrap"||r===!0)o.contentWidth>n?(o.minWidth=n,o.wrappedWidth=n):(o.minWidth=o.contentWidth,o.wrappedWidth=o.contentWidth);else{var p=10/a;o.minWidth=o.styles.minCellWidth||p,o.wrappedWidth=o.contentWidth,o.minWidth>o.wrappedWidth&&(o.wrappedWidth=o.minWidth)}}}}),e.allRows().forEach(function(i){for(var l=0,s=e.columns;l<s.length;l++){var h=s[l],o=i.cells[h.index];if(o&&o.colSpan===1)h.wrappedWidth=Math.max(h.wrappedWidth,o.wrappedWidth),h.minWidth=Math.max(h.minWidth,o.minWidth),h.minReadableWidth=Math.max(h.minReadableWidth,o.minReadableWidth);else{var c=e.styles.columnStyles[h.dataKey]||e.styles.columnStyles[h.index]||{},u=c.cellWidth||c.minCellWidth;u&&typeof u=="number"&&(h.minWidth=u,h.wrappedWidth=u)}o&&(o.colSpan>1&&!h.minWidth&&(h.minWidth=o.minWidth),o.colSpan>1&&!h.wrappedWidth&&(h.wrappedWidth=o.minWidth))}})}function ve(t,e,a){for(var r=e,n=t.reduce(function(p,v){return p+v.wrappedWidth},0),i=0;i<t.length;i++){var l=t[i],s=l.wrappedWidth/n,h=r*s,o=l.width+h,c=a(l),u=o<c?c:o;e-=u-l.width,l.width=u}if(e=Math.round(e*1e10)/1e10,e){var g=t.filter(function(p){return e<0?p.width>a(p):!0});g.length&&(e=ve(g,e,a))}return e}function or(t){for(var e={},a=1,r=t.allRows(),n=0;n<r.length;n++)for(var i=r[n],l=0,s=t.columns;l<s.length;l++){var h=s[l],o=e[h.index];if(a>1)a--,delete i.cells[h.index];else if(o)o.cell.height+=i.height,a=o.cell.colSpan,delete i.cells[h.index],o.left--,o.left<=1&&delete e[h.index];else{var c=i.cells[h.index];if(!c)continue;if(c.height=i.height,c.rowSpan>1){var u=r.length-n,g=c.rowSpan>u?u:c.rowSpan;e[h.index]={cell:c,left:g,row:i}}}}}function sr(t){for(var e=t.allRows(),a=0;a<e.length;a++)for(var r=e[a],n=null,i=0,l=0,s=0;s<t.columns.length;s++){var h=t.columns[s];if(l-=1,l>1&&t.columns[s+1])i+=h.width,delete r.cells[h.index];else if(n){var o=n;delete r.cells[h.index],n=null,o.width=h.width+i}else{var o=r.cells[h.index];if(!o)continue;if(l=o.colSpan,i=0,o.colSpan>1){n=o,i+=h.width;continue}o.width=h.width+i}}}function lr(t,e){for(var a={count:0,height:0},r=0,n=t.allRows();r<n.length;r++){for(var i=n[r],l=0,s=t.columns;l<s.length;l++){var h=s[l],o=i.cells[h.index];if(o){e.applyStyles(o.styles,!0);var c=o.width-o.padding("horizontal");if(o.styles.overflow==="linebreak")o.text=e.splitTextToSize(o.text,c+1/e.scaleFactor(),{fontSize:o.styles.fontSize});else if(o.styles.overflow==="ellipsize")o.text=Ve(o.text,c,o.styles,e,"...");else if(o.styles.overflow==="hidden")o.text=Ve(o.text,c,o.styles,e,"");else if(typeof o.styles.overflow=="function"){var u=o.styles.overflow(o.text,c);typeof u=="string"?o.text=[u]:o.text=u}o.contentHeight=o.getContentHeight(e.scaleFactor(),e.getLineHeightFactor());var g=o.contentHeight/o.rowSpan;o.rowSpan>1&&a.count*a.height<g*o.rowSpan?a={height:g,count:o.rowSpan}:a&&a.count>0&&a.height>g&&(g=a.height),g>i.height&&(i.height=g)}}a.count--}}function Ve(t,e,a,r,n){return t.map(function(i){return hr(i,e,a,r,n)})}function hr(t,e,a,r,n){var i=1e4*r.scaleFactor();if(e=Math.ceil(e*i)/i,e>=te(t,a,r))return t;for(;e<te(t+n,a,r)&&!(t.length<=1);)t=t.substring(0,t.length-1);return t.trim()+n}function dr(t,e){var a=new I(t),r=cr(e,a.scaleFactor()),n=new rr(e,r);return nr(a,n),a.applyStyles(a.userStyles),n}function cr(t,e){var a=t.content,r=ur(a.columns);if(a.head.length===0){var n=et(r,"head");n&&a.head.push(n)}if(a.foot.length===0){var n=et(r,"foot");n&&a.foot.push(n)}var i=t.settings.theme,l=t.styles;return{columns:r,head:le("head",a.head,r,l,i,e),body:le("body",a.body,r,l,i,e),foot:le("foot",a.foot,r,l,i,e)}}function le(t,e,a,r,n,i){var l={},s=e.map(function(h,o){for(var c=0,u={},g=0,p=0,v=0,P=a;v<P.length;v++){var b=P[v];if(l[b.index]==null||l[b.index].left===0)if(p===0){var S=void 0;Array.isArray(h)?S=h[b.index-g-c]:S=h[b.dataKey];var F={};typeof S=="object"&&!Array.isArray(S)&&(F=(S==null?void 0:S.styles)||{});var k=gr(t,b,o,n,r,i,F),H=new gt(S,k,t);u[b.dataKey]=H,u[b.index]=H,p=H.colSpan-1,l[b.index]={left:H.rowSpan-1,times:p}}else p--,g++;else l[b.index].left--,p=l[b.index].times,c++}return new ut(h,o,t,u)});return s}function et(t,e){var a={};return t.forEach(function(r){if(r.raw!=null){var n=fr(e,r.raw);n!=null&&(a[r.dataKey]=n)}}),Object.keys(a).length>0?a:null}function fr(t,e){if(t==="head"){if(typeof e=="object")return e.header||null;if(typeof e=="string"||typeof e=="number")return e}else if(t==="foot"&&typeof e=="object")return e.footer;return null}function ur(t){return t.map(function(e,a){var r,n;return typeof e=="object"?n=(r=e.dataKey)!==null&&r!==void 0?r:a:n=a,new ar(n,e,a)})}function gr(t,e,a,r,n,i,l){var s=Yt(r),h;t==="head"?h=n.headStyles:t==="body"?h=n.bodyStyles:t==="foot"&&(h=n.footStyles);var o=A({},s.table,s[t],n.styles,h),c=n.columnStyles[e.dataKey]||n.columnStyles[e.index]||{},u=t==="body"?c:{},g=t==="body"&&a%2===0?A({},s.alternateRow,n.alternateRowStyles):{},p=Bt(i),v=A({},p,o,g,u);return A(v,l)}function mr(t,e,a){var r;a===void 0&&(a={});var n=dt(t,e),i=new Map,l=[],s=[],h=[];Array.isArray(e.settings.horizontalPageBreakRepeat)?h=e.settings.horizontalPageBreakRepeat:(typeof e.settings.horizontalPageBreakRepeat=="string"||typeof e.settings.horizontalPageBreakRepeat=="number")&&(h=[e.settings.horizontalPageBreakRepeat]),h.forEach(function(g){var p=e.columns.find(function(v){return v.dataKey===g||v.index===g});p&&!i.has(p.index)&&(i.set(p.index,!0),l.push(p.index),s.push(e.columns[p.index]),n-=p.wrappedWidth)});for(var o=!0,c=(r=a==null?void 0:a.start)!==null&&r!==void 0?r:0;c<e.columns.length;){if(i.has(c)){c++;continue}var u=e.columns[c].wrappedWidth;if(o||n>=u)o=!1,l.push(c),s.push(e.columns[c]),n-=u;else break;c++}return{colIndexes:l,columns:s,lastIndex:c-1}}function pr(t,e){for(var a=[],r=0;r<e.columns.length;r++){var n=mr(t,e,{start:r});n.columns.length&&(a.push(n),r=n.lastIndex)}return a}function vr(t,e){var a=e.settings,r=a.startY,n=a.margin,i={x:n.left,y:r},l=e.getHeadHeight(e.columns)+e.getFootHeight(e.columns),s=r+n.bottom+l;if(a.pageBreak==="avoid"){var h=e.body,o=h.reduce(function(g,p){return g+p.height},0);s+=o}var c=new I(t);(a.pageBreak==="always"||a.startY!=null&&s>c.pageSize().height)&&(pt(c),i.y=n.top),e.callWillDrawPageHooks(c,i);var u=A({},i);e.startPageNumber=c.pageNumber(),a.horizontalPageBreak?yr(c,e,u,i):(c.applyStyles(c.userStyles),(a.showHead==="firstPage"||a.showHead==="everyPage")&&e.head.forEach(function(g){return L(c,e,g,i,e.columns)}),c.applyStyles(c.userStyles),e.body.forEach(function(g,p){var v=p===e.body.length-1;re(c,e,g,v,u,i,e.columns)}),c.applyStyles(c.userStyles),(a.showFoot==="lastPage"||a.showFoot==="everyPage")&&e.foot.forEach(function(g){return L(c,e,g,i,e.columns)})),lt(c,e,u,i),e.callEndPageHooks(c,i),e.finalY=i.y,t.lastAutoTable=e,c.applyStyles(c.userStyles)}function yr(t,e,a,r){var n=pr(t,e),i=e.settings;if(i.horizontalPageBreakBehaviour==="afterAllRows")n.forEach(function(o,c){t.applyStyles(t.userStyles),c>0?q(t,e,a,r,o.columns,!0):tt(t,e,r,o.columns),xr(t,e,a,r,o.columns),he(t,e,r,o.columns)});else for(var l=-1,s=n[0],h=function(){var o=l;if(s){t.applyStyles(t.userStyles);var c=s.columns;l>=0?q(t,e,a,r,c,!0):tt(t,e,r,c),o=rt(t,e,l+1,r,c),he(t,e,r,c)}var u=o-l;n.slice(1).forEach(function(g){t.applyStyles(t.userStyles),q(t,e,a,r,g.columns,!0),rt(t,e,l+1,r,g.columns,u),he(t,e,r,g.columns)}),l=o};l<e.body.length-1;)h()}function tt(t,e,a,r){var n=e.settings;t.applyStyles(t.userStyles),(n.showHead==="firstPage"||n.showHead==="everyPage")&&e.head.forEach(function(i){return L(t,e,i,a,r)})}function xr(t,e,a,r,n){t.applyStyles(t.userStyles),e.body.forEach(function(i,l){var s=l===e.body.length-1;re(t,e,i,s,a,r,n)})}function rt(t,e,a,r,n,i){t.applyStyles(t.userStyles),i=i??e.body.length;var l=Math.min(a+i,e.body.length),s=-1;return e.body.slice(a,l).forEach(function(h,o){var c=a+o===e.body.length-1,u=mt(t,e,c,r);h.canEntireRowFit(u,n)&&(L(t,e,h,r,n),s=a+o)}),s}function he(t,e,a,r){var n=e.settings;t.applyStyles(t.userStyles),(n.showFoot==="lastPage"||n.showFoot==="everyPage")&&e.foot.forEach(function(i){return L(t,e,i,a,r)})}function wr(t,e,a){var r=a.getLineHeight(t.styles.fontSize),n=t.padding("vertical"),i=Math.floor((e-n)/r);return Math.max(0,i)}function br(t,e,a,r){var n={};t.spansMultiplePages=!0,t.height=0;for(var i=0,l=0,s=a.columns;l<s.length;l++){var h=s[l],o=t.cells[h.index];if(o){Array.isArray(o.text)||(o.text=[o.text]);var c=new gt(o.raw,o.styles,o.section);c=A(c,o),c.text=[];var u=wr(o,e,r);o.text.length>u&&(c.text=o.text.splice(u,o.text.length));var g=r.scaleFactor(),p=r.getLineHeightFactor();o.contentHeight=o.getContentHeight(g,p),o.contentHeight>=e&&(o.contentHeight=e,c.styles.minCellHeight-=e),o.contentHeight>t.height&&(t.height=o.contentHeight),c.contentHeight=c.getContentHeight(g,p),c.contentHeight>i&&(i=c.contentHeight),n[h.index]=c}}var v=new ut(t.raw,-1,t.section,n,!0);v.height=i;for(var P=0,b=a.columns;P<b.length;P++){var h=b[P],c=v.cells[h.index];c&&(c.height=v.height);var o=t.cells[h.index];o&&(o.height=t.height)}return v}function Sr(t,e,a,r){var n=t.pageSize().height,i=r.settings.margin,l=i.top+i.bottom,s=n-l;e.section==="body"&&(s-=r.getHeadHeight(r.columns)+r.getFootHeight(r.columns));var h=e.getMinimumRowHeight(r.columns,t),o=h<a;if(h>s)return console.error("Will not be able to print row ".concat(e.index," correctly since it's minimum height is larger than page height")),!0;if(!o)return!1;var c=e.hasRowSpan(r.columns),u=e.getMaxCellHeight(r.columns)>s;return u?(c&&console.error("The content of row ".concat(e.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(c||r.settings.rowPageBreak==="avoid")}function re(t,e,a,r,n,i,l){var s=mt(t,e,r,i);if(a.canEntireRowFit(s,l))L(t,e,a,i,l);else if(Sr(t,a,s,e)){var h=br(a,s,e,t);L(t,e,a,i,l),q(t,e,n,i,l),re(t,e,h,r,n,i,l)}else q(t,e,n,i,l),re(t,e,a,r,n,i,l)}function L(t,e,a,r,n){r.x=e.settings.margin.left;for(var i=0,l=n;i<l.length;i++){var s=l[i],h=a.cells[s.index];if(!h){r.x+=s.width;continue}t.applyStyles(h.styles),h.x=r.x,h.y=r.y;var o=e.callCellHooks(t,e.hooks.willDrawCell,h,a,s,r);if(o===!1){r.x+=s.width;continue}Nr(t,h,r);var c=h.getTextPos();it(h.text,c.x,c.y,{halign:h.styles.halign,valign:h.styles.valign,maxWidth:Math.ceil(h.width-h.padding("left")-h.padding("right"))},t.getDocument()),e.callCellHooks(t,e.hooks.didDrawCell,h,a,s,r),r.x+=s.width}r.y+=a.height}function Nr(t,e,a){var r=e.styles;if(t.getDocument().setFillColor(t.getDocument().getFillColor()),typeof r.lineWidth=="number"){var n=ht(r.lineWidth,r.fillColor);n&&t.rect(e.x,a.y,e.width,e.height,n)}else typeof r.lineWidth=="object"&&(r.fillColor&&t.rect(e.x,a.y,e.width,e.height,"F"),Cr(t,e,a,r.lineWidth))}function Cr(t,e,a,r){var n,i,l,s;r.top&&(n=a.x,i=a.y,l=a.x+e.width,s=a.y,r.right&&(l+=.5*r.right),r.left&&(n-=.5*r.left),h(r.top,n,i,l,s)),r.bottom&&(n=a.x,i=a.y+e.height,l=a.x+e.width,s=a.y+e.height,r.right&&(l+=.5*r.right),r.left&&(n-=.5*r.left),h(r.bottom,n,i,l,s)),r.left&&(n=a.x,i=a.y,l=a.x,s=a.y+e.height,r.top&&(i-=.5*r.top),r.bottom&&(s+=.5*r.bottom),h(r.left,n,i,l,s)),r.right&&(n=a.x+e.width,i=a.y,l=a.x+e.width,s=a.y+e.height,r.top&&(i-=.5*r.top),r.bottom&&(s+=.5*r.bottom),h(r.right,n,i,l,s));function h(o,c,u,g,p){t.getDocument().setLineWidth(o),t.getDocument().line(c,u,g,p,"S")}}function mt(t,e,a,r){var n=e.settings.margin.bottom,i=e.settings.showFoot;return(i==="everyPage"||i==="lastPage"&&a)&&(n+=e.getFootHeight(e.columns)),t.pageSize().height-r.y-n}function q(t,e,a,r,n,i){n===void 0&&(n=[]),i===void 0&&(i=!1),t.applyStyles(t.userStyles),e.settings.showFoot==="everyPage"&&!i&&e.foot.forEach(function(s){return L(t,e,s,r,n)}),e.callEndPageHooks(t,r);var l=e.settings.margin;lt(t,e,a,r),pt(t),e.pageNumber++,r.x=l.left,r.y=l.top,a.y=l.top,e.callWillDrawPageHooks(t,r),e.settings.showHead==="everyPage"&&(e.head.forEach(function(s){return L(t,e,s,r,n)}),t.applyStyles(t.userStyles))}function pt(t){var e=t.pageNumber();t.setPage(e+1);var a=t.pageNumber();return a===e?(t.addPage(),!0):!1}function Pr(t){t.API.autoTable=function(){for(var e=[],a=0;a<arguments.length;a++)e[a]=arguments[a];var r=e[0],n=Jt(this,r),i=dr(this,n);return vr(this,i),this},t.API.lastAutoTable=!1,t.API.autoTableText=function(e,a,r,n){it(e,a,r,n,this)},t.API.autoTableSetDefaults=function(e){return I.setDefaults(e,this),this},t.autoTableSetDefaults=function(e,a){I.setDefaults(e,a)},t.API.autoTableHtmlToJson=function(e,a){var r;if(a===void 0&&(a=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var n=new I(this),i=ft(n,e,window,a,!1),l=i.head,s=i.body,h=((r=l[0])===null||r===void 0?void 0:r.map(function(o){return o.content}))||[];return{columns:h,rows:s,data:s}}}var de;try{if(typeof window<"u"&&window){var at=window,nt=at.jsPDF||((de=at.jspdf)===null||de===void 0?void 0:de.jsPDF);nt&&Pr(nt)}}catch(t){console.error("Could not apply autoTable plugin",t)}const Xr=({handleDateChange:t,selectedDate:e,updateTimeSheet:a,externalFilterData:r,externalEmployee:n})=>{var _e,Re,Ae;const{auth:i}=Me().props,{url:l}=Me();Wt();const s=Be("(min-width: 1025px)"),h=Be("(min-width: 641px) and (max-width: 1024px)"),[o,c]=w.useState([]),[u,g]=w.useState([]),[p,v]=w.useState([]),[P,b]=w.useState(""),[S,F]=w.useState(0),[k,H]=w.useState(0),[M,Fr]=w.useState(10),[B,ye]=w.useState(1),[U,xe]=w.useState(n||""),[Q,O]=w.useState(!1),[vt,yt]=w.useState(0),[Dr,we]=w.useState(null),[be,Hr]=w.useState(!0),[ne,Se]=w.useState(new Date),Ne=w.useRef(null),Ce=w.useRef(r||{currentMonth:E().format("YYYY-MM")}),[_,Pe]=w.useState(r||{currentMonth:E().format("YYYY-MM")}),K=w.useCallback(async()=>{try{return O(!1),await Fe(e,B,M,U,_,!0),Se(new Date),!0}catch(f){return console.error("Error refreshing timesheet:",f),!1}finally{O(!0)}},[e,B,M,U,_]),ie=w.useCallback(async()=>{if(console.log("Checking for timesheet updates..."),!!e)try{const f=route("check-timesheet-updates",{date:E(e).format("YYYY-MM-DD"),month:_.currentMonth}),N=await fetch(f);if(!N.ok)throw new Error(`HTTP ${N.status}: Failed to check for updates`);const x=await N.json();x.success&&x.last_updated!==Ne.current&&x.last_updated&&(Ne.current=x.last_updated,K(),we(new Date)),Se(new Date)}catch(f){console.error("Error checking for timesheet updates:",f)}},[e,_.currentMonth]);w.useEffect(()=>{if(!be)return;ie();const f=setInterval(ie,5e3);return()=>clearInterval(f)},[be,ie]);const ke=w.useMemo(()=>ne?ne.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0}):null,[ne]);w.useEffect(()=>{JSON.stringify(_)!==JSON.stringify(Ce.current)&&(Ce.current={..._},K())},[_,K]),w.useCallback(()=>{yt(f=>f+1),K()},[K]);const Fe=async(f,N,x,z,W,X=!1)=>{var Z,J;const Le=l!=="/attendance-employee"?route("admin.getPresentUsersForDate"):route("getCurrentUserAttendanceForDate");try{O(!1);const R=await V.get(Le,{params:{page:N,perPage:x,employee:z,date:f,currentYear:W!=null&&W.currentMonth?E(W.currentMonth).year():"",currentMonth:W!=null&&W.currentMonth?E(W.currentMonth).format("MM"):"",_t:X?Date.now():void 0}});R.status===200&&(c(R.data.attendances||[]),F(R.data.total||0),H(R.data.last_page||1),ye(R.data.current_page||1),we(new Date),b(""),O(!0))}catch(R){b(((J=(Z=R.response)==null?void 0:Z.data)==null?void 0:J.message)||"An error occurred while retrieving present users data."),O(!0)}},xt=async(f,N)=>{if(l==="/attendance-employee"){v([]),g([]);return}try{const x=await V.get(route("admin.getAbsentUsersForDate"),{params:{date:f}});x.status===200&&(v(x.data.absent_users||[]),g(x.data.leaves||[]))}catch(x){console.error("Error fetching absent users:",x),v([]),g([])}},wt=f=>{xe(f.target.value.toLowerCase())},De=f=>{ye(f)};w.useCallback((f,N)=>{Pe(x=>({...x,[f]:N}))},[]);const bt=f=>u.find(N=>String(N.user_id)===String(f)),He=(f,N)=>{if(!f)return null;try{let x;if(typeof f=="string")if(f.match(/^\d{2}:\d{2}:\d{2}$/)){const z=`${N}T${f}`;x=new Date(z)}else if(f.includes("T")||f.includes(" "))x=new Date(f);else if(f.match(/^\d{2}:\d{2}$/)){const z=`${N}T${f}:00`;x=new Date(z)}else x=new Date(`${N}T${f}`);else x=new Date(f);return isNaN(x.getTime())?(console.warn("Invalid time data:",f),"Invalid time"):x.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}catch(x){return console.warn("Error formatting time:",{timeString:f,date:N,error:x}),"Invalid time"}},G=((_e=i.permissions)==null?void 0:_e.includes("attendance.view"))||!1,St=((Re=i.permissions)==null?void 0:Re.includes("attendance.manage"))||!1,Nt=((Ae=i.permissions)==null?void 0:Ae.includes("attendance.export"))||St||!1;w.useMemo(()=>p,[p]);const We=[{name:"Date",uid:"date",icon:ee},...G&&l!=="/attendance-employee"?[{name:"Employee",uid:"employee",icon:ge}]:[],{name:"Clock In",uid:"clockin_time",icon:D},{name:"Clock Out",uid:"clockout_time",icon:D},{name:"Work Hours",uid:"production_time",icon:D},{name:"Punches",uid:"punch_details",icon:D}],Te=(f,N)=>{var z,W,X;const x=new Date(f.date).toDateString()===new Date().toDateString();switch(N){case"date":return d(T,{className:"text-xs sm:text-sm md:text-base",children:m(y,{className:"flex items-center gap-2",children:[d(ee,{className:"w-4 h-4 text-primary"}),d(y,{className:"flex flex-col",children:d("span",{children:new Date(f.date).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric"})})})]})});case"employee":return d(T,{className:"whitespace-nowrap text-xs sm:text-sm md:text-base",children:d(Et,{avatarProps:{radius:"lg",size:s||h?"md":"sm",src:(z=f.user)==null?void 0:z.profile_image,fallback:d(ge,{className:"w-6 h-6"})},description:(W=f.user)==null?void 0:W.phone,name:(X=f.user)==null?void 0:X.name})});case"clockin_time":return d(T,{className:"text-xs sm:text-sm md:text-base",children:m(y,{className:"flex items-center gap-2",children:[d(D,{className:"w-4 h-4 text-success"}),m(y,{className:"flex flex-col",children:[d("span",{children:f.punchin_time?He(f.punchin_time,f.date)||"Invalid time":"Not clocked in"}),f.punchin_time&&d("span",{className:"text-xs text-default-500",children:"First punch"})]})]})});case"clockout_time":return d(T,{className:"text-xs sm:text-sm md:text-base",children:m(y,{className:"flex items-center gap-2",children:[d(D,{className:"w-4 h-4 text-danger"}),m(y,{className:"flex flex-col",children:[d("span",{children:f.punchout_time?He(f.punchout_time,f.date)||"Invalid time":f.punchin_time?x?"Still working":"Not Punched Out":"Not started"}),f.punchout_time&&d("span",{className:"text-xs text-default-500",children:"Last punch"})]})]})});case"production_time":const Z=f.total_work_minutes>0,J=f.has_incomplete_punch,R=f.punchin_time&&!f.punchout_time&&x;if(Z){const kt=Math.floor(f.total_work_minutes/60),Ft=Math.floor(f.total_work_minutes%60);return d(T,{className:"text-xs sm:text-sm md:text-base",children:m(y,{className:"flex items-center gap-2",children:[d(D,{className:`w-4 h-4 ${J?"text-warning":"text-primary"}`}),m(y,{className:"flex flex-col",children:[d("span",{className:"font-medium",children:`${kt}h ${Ft}m`}),d("span",{className:"text-xs text-default-500",children:J?"Partial + In Progress":"Total worked"})]})]})})}else{if(R)return d(T,{className:"text-xs sm:text-sm md:text-base",children:m(y,{className:"flex items-center gap-2",children:[d(D,{className:"w-4 h-4 text-warning"}),m(y,{className:"flex flex-col",children:[d("span",{className:"text-warning",children:"In Progress"}),d("span",{className:"text-xs text-default-500",children:"Currently working"})]})]})});if(f.punchin_time&&!f.punchout_time&&!x)return d(T,{className:"text-xs sm:text-sm md:text-base",children:m(y,{className:"flex items-center gap-2",children:[d(Y,{className:"w-4 h-4 text-danger"}),m(y,{className:"flex flex-col",children:[d("span",{className:"text-danger",children:"Incomplete punch"}),d("span",{className:"text-xs text-default-500",children:"Missing punch out"})]})]})})}return d(T,{className:"text-xs sm:text-sm md:text-base",children:m(y,{className:"flex items-center gap-2",children:[d(Y,{className:"w-4 h-4 text-warning"}),m(y,{className:"flex flex-col",children:[d("span",{className:"text-warning",children:"No work time"}),d("span",{className:"text-xs text-default-500",children:"No attendance"})]})]})});case"punch_details":return d(T,{className:"text-xs sm:text-sm md:text-base",children:m(y,{className:"flex items-center gap-2",children:[d(D,{className:"w-4 h-4 text-default-400"}),m(y,{className:"flex flex-col",children:[m("span",{className:"text-xs font-medium",children:[f.punch_count||0," punch",(f.punch_count||0)!==1?"es":""]}),f.complete_punches!==f.punch_count&&m("span",{className:"text-xs text-warning",children:[f.complete_punches," complete"]}),f.complete_punches===f.punch_count&&f.punch_count>0&&d("span",{className:"text-xs text-success",children:"All complete"})]})]})});default:return d(T,{className:"text-xs sm:text-sm md:text-base",children:"N/A"})}},Ct=w.useCallback(async()=>{try{const f=await V.get(route("attendance.exportExcel"),{params:{date:e},responseType:"blob"}),N=window.URL.createObjectURL(new Blob([f.data])),x=document.createElement("a");x.href=N,x.setAttribute("download",`Daily_Timesheet_${E(e).format("YYYY_MM_DD")}.xlsx`),document.body.appendChild(x),x.click(),x.remove()}catch(f){console.error("Error downloading Excel:",f),alert("Failed to download attendance excel.")}},[e]),Pt=w.useCallback(async()=>{try{const f=await V.get(route("attendance.exportPdf"),{params:{date:e},responseType:"blob"}),N=window.URL.createObjectURL(new Blob([f.data])),x=document.createElement("a");x.href=N,x.setAttribute("download",`Daily_Timesheet_${E(e).format("YYYY_MM_DD")}.pdf`),document.body.appendChild(x),x.click(),x.remove()}catch(f){console.error("Error downloading PDF:",f),alert("Failed to download attendance pdf.")}},[e]);return w.useEffect(()=>{Fe(e,B,M,U,_),xt(e)},[e,B,M,U,_,a,vt]),w.useEffect(()=>{r&&Pe(r)},[r]),w.useEffect(()=>{n!==void 0&&xe(n)},[n]),l==="/attendance-employee"?d(y,{role:"region","aria-label":"Attendance data table",className:"w-full",children:P?d(ze,{className:"p-4 bg-danger-50 border-danger-200",children:m(y,{className:"flex items-center gap-3",children:[d(Y,{className:"w-5 h-5 text-danger"}),d(C,{color:"error",variant:"body1",children:P})]})}):m(oe,{children:[d(Ye,{orientation:"horizontal",className:"overflow-y-hidden",children:d(Oe,{className:"rounded-lg",isLoaded:Q,children:m(Ke,{selectionMode:"multiple",selectionBehavior:"toggle",isCompact:!0,removeWrapper:!0,"aria-label":"Employee attendance timesheet table",isHeaderSticky:!0,classNames:{base:"max-h-[520px] overflow-scroll",table:"min-h-[200px]"},children:[d(Ge,{columns:We,children:f=>d(Je,{align:"start",children:m(y,{className:"flex items-center gap-2",children:[f.icon&&d(f.icon,{className:"w-4 h-4"}),d("span",{className:"text-sm font-medium",children:f.name})]})},f.uid)}),d(qe,{items:o,emptyContent:m(y,{className:"flex flex-col items-center justify-center py-8",children:[d(D,{className:"w-12 h-12 text-default-300 mb-4"}),d(C,{variant:"body1",color:"textSecondary",children:"No attendance records found"})]}),children:f=>d(Qe,{children:N=>Te(f,N)},f.id||f.user_id)})]})})}),S>M&&d(y,{className:"py-4 flex justify-center",children:d(Xe,{initialPage:1,isCompact:!0,showControls:!0,showShadow:!0,color:"primary",variant:"bordered",page:B,total:k,onChange:De,"aria-label":"Timesheet pagination"})})]})}):d(y,{sx:{display:"flex",justifyContent:"center",p:2},component:"main",role:"main","aria-label":"Timesheet Management",children:d(j,{container:!0,spacing:2,children:d(j,{item:!0,xs:12,children:d(Tt,{in:!0,timeout:500,children:m(_t,{children:[d(Mt,{className:"bg-gradient-to-br from-slate-50/50 to-white/30 backdrop-blur-sm border-b border-white/20",title:d("div",{className:`${s?"p-6":h?"p-4":"p-3"}`,children:m("div",{className:"flex flex-col space-y-4",children:[m("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[m("div",{className:"flex items-center gap-3 lg:gap-4",children:[d("div",{className:`
                                                        ${s?"p-3":h?"p-2.5":"p-2"} 
                                                        rounded-xl bg-gradient-to-br from-[rgba(var(--theme-primary-rgb),0.2)] to-[rgba(var(--theme-secondary-rgb),0.2)] border border-[rgba(var(--theme-primary-rgb),0.3)] backdrop-blur-sm
                                                    `,children:d(D,{className:`
                                                                ${s?"w-8 h-8":h?"w-6 h-6":"w-5 h-5"}
                                                            `,style:{color:"var(--theme-primary)"}})}),m("div",{className:"min-w-0 flex-1",children:[d(C,{variant:s?"h4":h?"h5":"h6",className:`
                                                                font-bold bg-gradient-to-r from-[var(--theme-primary)] to-[var(--theme-secondary)] bg-clip-text text-transparent
                                                                ${s?"":"truncate"}
                                                            `,style:{fontFamily:"var(--font-current)",transition:"all var(--transition)"},children:"Daily Timesheet"}),d(C,{variant:s?"body2":"caption",color:"textSecondary",className:s?"":"truncate",style:{fontFamily:"var(--font-current)",transition:"all var(--transition)"},children:new Date(e).toLocaleString("en-US",{month:s?"long":"short",day:"numeric",year:s?"numeric":void 0})})]})]}),"                                                ",m("div",{className:"flex items-center gap-4",children:[ke&&m(C,{variant:"caption",color:"textSecondary",sx:{fontSize:"0.75rem",display:{xs:"block",sm:"block"}},children:["Updated: ",ke]}),d("div",{className:"flex items-center gap-2",children:Nt&&m(oe,{children:[d(je,{color:"success",variant:"flat",size:s?"md":"sm",startContent:d(Ie,{className:`
                                                                            ${s?"w-4 h-4":"w-3.5 h-3.5"}
                                                                        `}),className:"bg-gradient-to-r from-[rgba(var(--theme-success-rgb),0.1)] to-[rgba(var(--theme-success-rgb),0.2)] hover:from-[rgba(var(--theme-success-rgb),0.2)] hover:to-[rgba(var(--theme-success-rgb),0.3)] border border-[rgba(var(--theme-success-rgb),0.2)] backdrop-blur-sm",onPress:Ct,isDisabled:!Q||o.length===0,style:{fontFamily:"var(--font-current)",transition:"all var(--transition)"},children:s?"Excel":"XLS"}),d(je,{color:"danger",variant:"flat",size:s?"md":"sm",startContent:d(Ie,{className:`
                                                                            ${s?"w-4 h-4":"w-3.5 h-3.5"}
                                                                        `}),className:"bg-gradient-to-r from-[rgba(var(--theme-danger-rgb),0.1)] to-[rgba(var(--theme-danger-rgb),0.2)] hover:from-[rgba(var(--theme-danger-rgb),0.2)] hover:to-[rgba(var(--theme-danger-rgb),0.3)] border border-[rgba(var(--theme-danger-rgb),0.2)] backdrop-blur-sm",onPress:Pt,isDisabled:!Q||o.length===0,style:{fontFamily:"var(--font-current)",transition:"all var(--transition)"},children:"PDF"})]})})]})]}),s&&m("div",{className:"flex items-center gap-6 pt-2 border-t border-white/10",children:[m("div",{className:"flex items-center gap-2",children:[d($,{className:"w-4 h-4 text-success"}),m(C,{variant:"caption",color:"textSecondary",children:["Present: ",S]})]}),G&&m("div",{className:"flex items-center gap-2",children:[d(Y,{className:"w-4 h-4 text-warning"}),m(C,{variant:"caption",color:"textSecondary",children:["Absent: ",p.length]})]}),m("div",{className:"flex items-center gap-2",children:[d(ce,{className:"w-4 h-4 text-primary"}),m(C,{variant:"caption",color:"textSecondary",children:["Total: ",S+p.length]})]})]})]})}),sx:{padding:0,"& .MuiCardHeader-content":{width:"100%",overflow:"hidden"}}}),d(Ee,{}),d(Ue,{children:d(y,{component:"section",role:"search","aria-label":"Timesheet filters",children:d(j,{container:!0,spacing:3,children:G&&m(oe,{children:[d(j,{item:!0,xs:12,sm:6,md:4,children:d(fe,{type:"text",label:"Search Employee",placeholder:"Enter employee name",value:U,onChange:wt,startContent:d(ue,{className:"w-4 h-4 text-default-400"}),variant:"bordered","aria-label":"Search employees",classNames:{inputWrapper:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15"}})}),d(j,{item:!0,xs:12,sm:6,md:4,children:d(fe,{label:"Select Date",type:"date",variant:"bordered",onChange:t,value:new Date(e).toISOString().slice(0,10)||"",startContent:d(ee,{className:"w-4 h-4 text-default-400"}),"aria-label":"Select date for timesheet",classNames:{inputWrapper:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15"}})})]})})})}),d(Ee,{}),d(Ue,{children:m(j,{container:!0,spacing:3,children:[d(j,{item:!0,xs:12,md:G?9:12,children:P?d(ze,{className:"p-4 bg-danger-50 border-danger-200",children:m(y,{className:"flex items-center gap-3",children:[d(Y,{className:"w-5 h-5 text-danger"}),d(C,{color:"error",variant:"body1",children:P})]})}):m(y,{role:"region","aria-label":"Present employees attendance table",className:"border-r border-gray-200 pr-4",sx:{borderRightColor:"rgba(0, 0, 0, 0.1)"},children:[d(y,{className:"mb-4",children:m(C,{variant:"h6",className:"font-semibold text-blue-600 flex items-center gap-2",children:[d($,{className:"w-5 h-5"}),"Present Employees (",S,")"]})}),d(Ye,{orientation:"horizontal",className:"overflow-y-hidden",children:d(Oe,{className:"rounded-lg",isLoaded:Q,children:m(Ke,{selectionMode:"multiple",selectionBehavior:"toggle",isCompact:!0,removeWrapper:!0,"aria-label":"Employee attendance timesheet table",isHeaderSticky:!0,classNames:{base:"max-h-[520px] overflow-scroll",table:"min-h-[200px]"},children:[d(Ge,{columns:We,children:f=>d(Je,{align:"start",children:m(y,{className:"flex items-center gap-2",children:[f.icon&&d(f.icon,{className:"w-4 h-4"}),d("span",{className:"text-sm font-medium",children:f.name})]})},f.uid)}),d(qe,{items:o,emptyContent:m(y,{className:"flex flex-col items-center justify-center py-8",children:[d(D,{className:"w-12 h-12 text-default-300 mb-4"}),d(C,{variant:"body1",color:"textSecondary",children:"No attendance records found"})]}),children:f=>d(Qe,{children:N=>Te(f,N)},f.id||f.user_id)})]})})}),S>M&&d(y,{className:"py-4 flex justify-center",children:d(Xe,{initialPage:1,isCompact:!0,showControls:!0,showShadow:!0,color:"primary",variant:"bordered",page:B,total:k,onChange:De,"aria-label":"Timesheet pagination"})})]})}),G&&d(j,{item:!0,xs:12,md:3,children:d(kr,{absentUsers:p,selectedDate:e,getUserLeave:bt})})]})})]})})})})})},kr=Dt.memo(({absentUsers:t,selectedDate:e,getUserLeave:a})=>{const[r,n]=w.useState(5),[i,l]=w.useState(""),s=w.useMemo(()=>{if(!i.trim())return t;const u=i.toLowerCase();return t.filter(g=>{var S,F,k,H;const p=((S=g.name)==null?void 0:S.toLowerCase())||"",v=((F=g.employee_id)==null?void 0:F.toString().toLowerCase())||"",P=((k=g.email)==null?void 0:k.toLowerCase())||"",b=((H=g.phone)==null?void 0:H.toString().toLowerCase())||"";return p.includes(u)||v.includes(u)||P.includes(u)||b.includes(u)})},[t,i]),h=()=>{n(u=>u+5)},o=u=>{l(u.target.value),n(5)},c=u=>{switch(u==null?void 0:u.toLowerCase()){case"approved":return d($,{className:"w-4 h-4 text-success"});case"rejected":return d(jt,{className:"w-4 h-4 text-danger"});default:return d(D,{className:"w-4 h-4 text-warning"})}};return t.length===0?m(y,{className:"h-full",children:[d(Lt,{title:"Perfect Attendance!",subtitle:`No employees are absent on ${E(e).format("MMMM D, YYYY")}`,icon:d($,{className:"w-6 h-6"}),variant:"gradient",actionButtons:[{label:"0",variant:"flat",color:"success",icon:d($,{className:"w-4 h-4"}),className:"bg-green-500/10 text-green-500 border-green-500/20"}]}),m(y,{role:"region","aria-label":"No absent employees today",className:"text-center py-12 bg-white/10 backdrop-blur-md border border-white/20 rounded-lg h-96 flex flex-col items-center justify-center",children:[d($,{className:"w-12 h-12 text-success mx-auto mb-4"}),d(C,{variant:"body2",color:"success",className:"mb-2 text-sm font-medium",children:"Perfect Attendance!"}),d(C,{variant:"caption",color:"textSecondary",className:"text-xs",children:"No employees are absent today."}),d(C,{variant:"caption",color:"textSecondary",className:"mt-1 block text-xs",children:"All employees are either present or on approved leave."})]})]}):m(y,{className:"h-full",children:[m(y,{className:"mb-4 flex items-center justify-between",children:[m(C,{variant:"h6",className:"font-semibold text-orange-600 flex items-center gap-2 text-sm",children:[d(ce,{className:"w-4 h-4"}),"Absent Today"]}),d(Rt,{label:t.length,variant:"outlined",color:"warning",size:"small",className:"font-semibold",avatar:d($e,{sx:{width:18,height:18,bgcolor:"warning.main",color:"warning.contrastText",fontSize:"0.75rem",marginRight:"-4px"},children:d(ce,{style:{width:12,height:12}})})})]}),d(y,{className:"mb-3 m-2",children:d(fe,{type:"text",placeholder:"Search absent employees...",value:i,onChange:o,startContent:d(ue,{className:"w-4 h-4 text-default-400"}),variant:"bordered","aria-label":"Search absent employees",classNames:{inputWrapper:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15 h-10",input:"text-sm"}})}),i&&d(y,{className:"mb-2 ",children:m(C,{variant:"caption",color:"textSecondary",className:"text-xs",children:[s.length," of ",t.length," employees found"]})}),i&&s.length===0&&m(y,{className:"text-center py-8 bg-white/10 backdrop-blur-md border border-white/20 rounded-lg",children:[d(ue,{className:"w-8 h-8 text-default-300 mx-auto mb-2"}),m(C,{variant:"body2",color:"textSecondary",className:"text-sm",children:['No employees found matching "',i,'"']})]}),m(y,{role:"region","aria-label":"Absent employees list",className:"overflow-y-auto max-h-[520px]",children:[s.slice(0,r).map(u=>{var p,v;const g=a(u.id);return d(At,{in:!0,timeout:"auto",children:d("div",{className:"p-3 m-2 bg-white/10 backdrop-blur-md border border-white/20 hover:bg-white/15 transition-all duration-200 rounded-lg",children:m(y,{className:"flex items-start justify-between",children:[m(y,{className:"flex items-center gap-2 flex-1",children:[d($e,{src:u.profile_image,alt:u.name,size:"sm",fallback:d(ge,{className:"w-4 h-4"})}),m(y,{className:"flex-1 min-w-0",children:["                                            ",d(C,{variant:"body2",fontWeight:"medium",className:"truncate text-sm",children:u.name}),u.employee_id&&m(C,{variant:"caption",color:"textSecondary",className:"block text-xs",children:["ID: ",u.employee_id]}),g?m(y,{className:"flex flex-col gap-1 mt-1",children:[m(C,{variant:"caption",color:"textSecondary",className:"flex items-center gap-1 text-xs",children:[d(ee,{className:"w-3 h-3"}),g.from_date===g.to_date?g.from_date:`${g.from_date} - ${g.to_date}`]}),m(C,{variant:"caption",color:"primary",className:"flex items-center gap-1 text-xs",children:[c(g.status),g.leave_type," Leave"]})]}):m(C,{variant:"caption",color:"error",className:"flex items-center gap-1 mt-1 text-xs",children:[d(Y,{className:"w-3 h-3"}),"Absent without leave"]})]})]}),g&&d("div",{className:"bg-white/20 backdrop-blur-md border border-white/30 rounded-md px-1.5 py-0.5 ml-2",children:m("div",{className:"flex items-center gap-1",children:[c(g.status),d(C,{variant:"caption",className:`font-semibold text-xs ${((p=g.status)==null?void 0:p.toLowerCase())==="approved"?"text-green-600":((v=g.status)==null?void 0:v.toLowerCase())==="rejected"?"text-red-600":"text-orange-600"}`,children:g.status})]})})]})})},u.id)}),r<s.length&&d(y,{className:"text-center mt-4 pb-4",children:m(zt,{variant:"outlined",onClick:h,startIcon:d(Ht,{className:"w-4 h-4"}),size:"small",color:"warning",fullWidth:!0,children:["Show More (",s.length-r," remaining)"]})})]})]})});export{Xr as default};
