import{r as Q,q as T,j as l,a as t,Y as Z,F as J}from"./app-C8mCQDBQ.js";import{v as K,q as X,r as o,G as g,f as s,Y as _,Z as I,$ as N,B as v,C as ee,N as te,O as P,j as le,k as ne,l as q,m as c,n as ae,a0 as x,Q as S,U as D,V as k}from"./vendor-ZOhTUyTS.js";import{d as oe,A as se}from"./App-oNIhNum4.js";import{d as re}from"./Delete-G44_T7rR.js";import ie from"./CompanySettings-DFdv9QFs.js";import"./LoadingButton-CAL-kczt.js";var A={},de=K;Object.defineProperty(A,"__esModule",{value:!0});var $=A.default=void 0,ce=de(Q()),he=X;$=A.default=(0,ce.default)((0,he.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add");const ve=({title:h})=>{const[r,p]=o.useState(T().props.roles),[y,pe]=o.useState(T().props.permissions),[a,m]=o.useState({}),[w,E]=o.useState(!1),[B,b]=o.useState(!1),[L,j]=o.useState(!1),[O,M]=o.useState(""),[i,u]=o.useState([]);console.log(r,y);const F=()=>E(!0),R=()=>E(!1),W=e=>{m(e),u(e.permissions.map(n=>n.name)),b(!0)},C=()=>b(!1),G=e=>{m(e),j(!0)},f=()=>j(!1),H=()=>{axios.post("/api/roles",{name:O,permissions:i}).then(e=>{p([...r,e.data.role]),R()}).catch(e=>console.error(e))},U=()=>{axios.put(`/api/roles/${a.id}`,{name:a.name,permissions:i}).then(e=>{const n=r.map(d=>d.id===a.id?e.data.role:d);p(n),C()}).catch(e=>console.error(e))},V=()=>{axios.delete(`/api/roles/${a.id}`).then(()=>{p(r.filter(e=>e.id!==a.id)),f()}).catch(e=>console.error(e))},Y=e=>{i.includes(e)?u(i.filter(n=>n!==e)):u([...i,e])};return l(J,{children:[t(Z,{title:h}),l(g,{container:!0,spacing:2,children:[l(g,{item:!0,xs:12,sm:4,md:4,lg:3,children:[t(s,{variant:"contained",startIcon:t($,{}),onClick:F,fullWidth:!0,children:"Add Roles"}),t(v,{mt:2,children:t(_,{children:r.map((e,n)=>l(I,{selected:n===0,button:!0,children:[t(N,{primary:e}),l(v,{children:[t(oe,{onClick:()=>W(e),style:{cursor:"pointer",marginRight:"10px"}}),t(re,{onClick:()=>G(e),style:{cursor:"pointer"}})]})]},n))})})]}),t(g,{item:!0,xs:12,sm:8,md:8,lg:9,children:l(ee,{children:[l(v,{p:2,children:[t("h6",{children:"Module Access"}),t(_,{children:y.map(e=>l(I,{children:[t(N,{primary:e.name}),t(te,{control:t(P,{checked:i.includes(e.name),onChange:()=>Y(e.name)})})]},e.id))})]}),l(le,{children:[t(ne,{children:l(q,{children:[t(c,{children:"Module Permission"}),["Read","Write","Create","Delete","Import","Export"].map((e,n)=>t(c,{align:"center",children:e},n))]})}),t(ae,{children:r.map(e=>l(q,{children:[t(c,{children:e.name}),["Read","Write","Create","Delete","Import","Export"].map((n,d)=>t(c,{align:"center",children:t(P,{defaultChecked:e.permissions.some(z=>z.name===n)})},d))]},e.id))})]})]})}),l(x,{open:w,onClose:R,children:[t(S,{children:"Add Role"}),t(D,{children:t("input",{type:"text",placeholder:"Role Name",value:O,onChange:e=>M(e.target.value)})}),l(k,{children:[t(s,{onClick:R,children:"Cancel"}),t(s,{variant:"contained",onClick:H,children:"Save"})]})]}),l(x,{open:B,onClose:C,children:[l(S,{children:["Edit Role: ",a.name]}),t(D,{children:t("input",{type:"text",placeholder:"Role Name",value:a.name,onChange:e=>m({...a,name:e.target.value})})}),l(k,{children:[t(s,{onClick:C,children:"Cancel"}),t(s,{variant:"contained",onClick:U,children:"Save"})]})]}),l(x,{open:L,onClose:f,children:[l(S,{children:["Delete Role: ",a.name,"?"]}),t(D,{children:"Are you sure you want to delete this role?"}),l(k,{children:[t(s,{onClick:f,children:"Cancel"}),t(s,{variant:"contained",color:"error",onClick:V,children:"Delete"})]})]})]})]})};ie.layout=h=>t(se,{children:h});export{ve as default};
